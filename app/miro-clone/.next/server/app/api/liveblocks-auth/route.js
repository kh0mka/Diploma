"use strict";(()=>{var e={};e.id=386,e.ids=[386],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},72254:e=>{e.exports=require("node:buffer")},6005:e=>{e.exports=require("node:crypto")},87561:e=>{e.exports=require("node:fs")},88849:e=>{e.exports=require("node:http")},22286:e=>{e.exports=require("node:https")},87503:e=>{e.exports=require("node:net")},49411:e=>{e.exports=require("node:path")},97742:e=>{e.exports=require("node:process")},84492:e=>{e.exports=require("node:stream")},72477:e=>{e.exports=require("node:stream/web")},41041:e=>{e.exports=require("node:url")},47261:e=>{e.exports=require("node:util")},65628:e=>{e.exports=require("node:zlib")},71017:e=>{e.exports=require("path")},77282:e=>{e.exports=require("process")},85477:e=>{e.exports=require("punycode")},12781:e=>{e.exports=require("stream")},57310:e=>{e.exports=require("url")},71267:e=>{e.exports=require("worker_threads")},59796:e=>{e.exports=require("zlib")},43937:(e,t,r)=>{let i;r.r(t),r.d(t,{headerHooks:()=>sT,originalPathname:()=>sB,patchFetch:()=>sR,requestAsyncStorage:()=>sx,routeModule:()=>sE,serverHooks:()=>sP,staticGenerationAsyncStorage:()=>sC,staticGenerationBailout:()=>sO});var n,s,o,a,l,u,c,h,d,f={};r.r(f),r.d(f,{POST:()=>sk});var p=r(95419),m=r(69108),y=r(99678);r(40002);var g=r(86843);let b=(0,g.createProxy)(String.raw`/home/homenok/LastHap/miro-clone/node_modules/@clerk/nextjs/dist/esm/app-router/client/ClerkProvider.js`),{__esModule:_,$$typeof:v}=b;b.default,(0,g.createProxy)(String.raw`/home/homenok/LastHap/miro-clone/node_modules/@clerk/nextjs/dist/esm/app-router/client/ClerkProvider.js#ClientClerkProvider`);var w=()=>!1,S=()=>{try{return!0}catch(e){}return!1},A=new Set,k=(e,t,r)=>{let i=w()||S(),n=r??e;A.has(n)||i||(A.add(n),console.warn(`Clerk - DEPRECATION WARNING: "${e}" is deprecated and will be removed in the next major release.
${t}`))},E=(e,t,r,i=!1)=>{let n=i?e:e.prototype,s=n[t];Object.defineProperty(n,t,{get:()=>(k(t,r,`${e.name}:${t}`),s),set(e){s=e}})},x=(e,t,r,i)=>{let n=e[t];Object.defineProperty(e,t,{get:()=>(k(t,r,i),n),set(e){n=e}})},C=(Object.getOwnPropertyDescriptor,Object.getOwnPropertyNames,Object.prototype.hasOwnProperty,(e,t)=>!t&&function(e){return e.endsWith(".lclstage.dev")||e.endsWith(".stgstage.dev")||e.endsWith(".clerkstage.dev")||e.endsWith(".accountsstage.dev")}(e)?"canary":t&&t.split(".")[0]||"latest"),P=(e,{pkgVersion:t="4.68.2",clerkJSVersion:r})=>{let i=e.replace(/http(s)?:\/\//,""),n=C(e,t);return`https://${i}/npm/@clerk/clerk-js@${r||n}/dist/clerk.browser.js`};async function T(e,t=1,r=5){try{return await e()}catch(n){var i;if(t>=r)throw n;return await (i=2**t*100,new Promise(e=>setTimeout(e,i))),T(e,t+1,r)}}var O=e=>"undefined"!=typeof atob&&"function"==typeof atob?atob(e):"undefined"!=typeof global&&global.Buffer?new global.Buffer(e,"base64").toString():e,B="pk_live_";function R(e){if(!function(e){let t=(e=e||"").startsWith(B)||e.startsWith("pk_test_"),r=O(e.split("_")[2]||"").endsWith("$");return t&&r}(e=e||""))return null;let t=e.startsWith(B)?"production":"development",r=O(e.split("_")[2]);return r.endsWith("$")?{instanceType:t,frontendApi:r=r.slice(0,-1)}:null}function I(e){return e.startsWith("test_")||e.startsWith("sk_test_")}function N(e){return{code:e.code,message:e.message,longMessage:e.long_message,meta:{paramName:e?.meta?.param_name,sessionId:e?.meta?.session_id,emailAddresses:e?.meta?.email_addresses,identifiers:e?.meta?.identifiers,zxcvbn:e?.meta?.zxcvbn}}}var U=class e extends Error{constructor(t,{data:r,status:i,clerkTraceId:n}){super(t),this.toString=()=>{let e=`[${this.name}]
Message:${this.message}
Status:${this.status}
Serialized errors: ${this.errors.map(e=>JSON.stringify(e))}`;return this.clerkTraceId&&(e+=`
Clerk Trace ID: ${this.clerkTraceId}`),e},Object.setPrototypeOf(this,e.prototype),this.status=i,this.message=t,this.clerkTraceId=n,this.clerkError=!0,this.errors=function(e=[]){return e.length>0?e.map(N):[]}(r)}};new Proxy({Expired:"expired",Failed:"failed"},{get:(e,t,r)=>(k("MagicLinkErrorCode","Use `EmailLinkErrorCode` instead."),Reflect.get(e,t,r))});var L=Object.freeze({InvalidFrontendApiErrorMessage:"The frontendApi passed to Clerk is invalid. You can get your Frontend API key at https://dashboard.clerk.com/last-active?path=api-keys. (key={{key}})",InvalidProxyUrlErrorMessage:"The proxyUrl passed to Clerk is invalid. The expected value for proxyUrl is an absolute URL or a relative path with a leading '/'. (key={{url}})",InvalidPublishableKeyErrorMessage:"The publishableKey passed to Clerk is invalid. You can get your Publishable key at https://dashboard.clerk.com/last-active?path=api-keys. (key={{key}})",MissingPublishableKeyErrorMessage:"Missing publishableKey. You can get your key at https://dashboard.clerk.com/last-active?path=api-keys."}),j=r(52743),K=r.n(j),D=r(27988),M=r(14438),$=r.n(M),q=r(78591),H=r.n(q),z=r(83191),F=class{constructor(e){this.request=e}requireId(e){if(!e)throw Error("A valid resource ID is required.")}},V=RegExp("(?<!:)/{1,}","g");function W(...e){return e.filter(e=>e).join("/").replace(V,"/")}var J="/allowlist_identifiers",G=class extends F{async getAllowlistIdentifierList(){return this.request({method:"GET",path:J})}async createAllowlistIdentifier(e){return this.request({method:"POST",path:J,bodyParams:e})}async deleteAllowlistIdentifier(e){return this.requireId(e),this.request({method:"DELETE",path:W(J,e)})}},Y="/clients",X=class extends F{async getClientList(){return this.request({method:"GET",path:Y})}async getClient(e){return this.requireId(e),this.request({method:"GET",path:W(Y,e)})}verifyClient(e){return this.request({method:"POST",path:W(Y,"verify"),bodyParams:{token:e}})}},Q=class extends F{async deleteDomain(e){return this.request({method:"DELETE",path:W("/domains",e)})}},Z="/email_addresses",ee=class extends F{async getEmailAddress(e){return this.requireId(e),this.request({method:"GET",path:W(Z,e)})}async createEmailAddress(e){return this.request({method:"POST",path:Z,bodyParams:e})}async updateEmailAddress(e,t={}){return this.requireId(e),this.request({method:"PATCH",path:W(Z,e),bodyParams:t})}async deleteEmailAddress(e){return this.requireId(e),this.request({method:"DELETE",path:W(Z,e)})}},et=class extends F{async createEmail(e){return k("EmailAPI.createEmail","This endpoint is no longer available and the function will be removed in the next major version."),this.request({method:"POST",path:"/emails",bodyParams:e})}},er=function({packageName:e,customMessages:t}){let r=e,i={...L,...t};function n(e,t){if(!t)return`${r}: ${e}`;let i=e;for(let r of e.matchAll(/{{([a-zA-Z0-9-_]+)}}/g)){let e=(t[r[1]]||"").toString();i=i.replace(`{{${r[1]}}}`,e)}return`${r}: ${i}`}return{setPackageName({packageName:e}){return"string"==typeof e&&(r=e),this},setMessages({customMessages:e}){return Object.assign(i,e||{}),this},throwInvalidPublishableKeyError(e){throw Error(n(i.InvalidPublishableKeyErrorMessage,e))},throwInvalidFrontendApiError(e){throw Error(n(i.InvalidFrontendApiErrorMessage,e))},throwInvalidProxyUrl(e){throw Error(n(i.InvalidProxyUrlErrorMessage,e))},throwMissingPublishableKeyError(){throw Error(n(i.MissingPublishableKeyErrorMessage))}}}({packageName:"@clerk/backend"}),{isDevOrStagingUrl:ei}=function(){let e=[".lcl.dev",".stg.dev",".lclstage.dev",".stgstage.dev",".dev.lclclerk.com",".stg.lclclerk.com",".accounts.lclclerk.com","accountsstage.dev","accounts.dev"],t=new Map;return{isDevOrStagingUrl:r=>{if(!r)return!1;let i="string"==typeof r?r:r.hostname,n=t.get(i);return void 0===n&&(n=e.some(e=>i.endsWith(e)),t.set(i,n)),n}}}(),en=class extends F{async getInterstitial(){return k("getInterstitial()",'Switch to `Clerk(...).localInterstitial(...)` from `import { Clerk } from "@clerk/backend"`.'),this.request({path:"internal/interstitial",method:"GET",headerParams:{"Content-Type":"text/html"}})}},es="/invitations",eo=class extends F{async getInvitationList(e={}){return this.request({method:"GET",path:es,queryParams:e})}async createInvitation(e){return this.request({method:"POST",path:es,bodyParams:e})}async revokeInvitation(e){return this.requireId(e),this.request({method:"POST",path:W(es,e,"revoke")})}},{RuntimeFetch:ea,RuntimeAbortController:el,RuntimeBlob:eu,RuntimeFormData:ec,RuntimeHeaders:eh,RuntimeRequest:ed,RuntimeResponse:ef}=D,ep=ea.bind(globalThis),em={crypto:K(),fetch:ep,AbortController:el,Blob:eu,FormData:ec,Headers:eh,Request:ed,Response:ef},ey="/organizations",eg=class extends F{async getOrganizationList(e){return this.request({method:"GET",path:ey,queryParams:e})}async createOrganization(e){return this.request({method:"POST",path:ey,bodyParams:e})}async getOrganization(e){let t="organizationId"in e?e.organizationId:e.slug;return this.requireId(t),this.request({method:"GET",path:W(ey,t)})}async updateOrganization(e,t){return this.requireId(e),this.request({method:"PATCH",path:W(ey,e),bodyParams:t})}async updateOrganizationLogo(e,t){this.requireId(e);let r=new em.FormData;return r.append("file",t?.file),r.append("uploader_user_id",t?.uploaderUserId),this.request({method:"PUT",path:W(ey,e,"logo"),formData:r})}async deleteOrganizationLogo(e){return this.requireId(e),this.request({method:"DELETE",path:W(ey,e,"logo")})}async updateOrganizationMetadata(e,t){return this.requireId(e),this.request({method:"PATCH",path:W(ey,e,"metadata"),bodyParams:t})}async deleteOrganization(e){return this.request({method:"DELETE",path:W(ey,e)})}async getOrganizationMembershipList(e){let{organizationId:t,limit:r,offset:i}=e;return this.requireId(t),this.request({method:"GET",path:W(ey,t,"memberships"),queryParams:{limit:r,offset:i}})}async createOrganizationMembership(e){let{organizationId:t,userId:r,role:i}=e;return this.requireId(t),this.request({method:"POST",path:W(ey,t,"memberships"),bodyParams:{userId:r,role:i}})}async updateOrganizationMembership(e){let{organizationId:t,userId:r,role:i}=e;return this.requireId(t),this.request({method:"PATCH",path:W(ey,t,"memberships",r),bodyParams:{role:i}})}async updateOrganizationMembershipMetadata(e){let{organizationId:t,userId:r,publicMetadata:i,privateMetadata:n}=e;return this.request({method:"PATCH",path:W(ey,t,"memberships",r,"metadata"),bodyParams:{publicMetadata:i,privateMetadata:n}})}async deleteOrganizationMembership(e){let{organizationId:t,userId:r}=e;return this.requireId(t),this.request({method:"DELETE",path:W(ey,t,"memberships",r)})}async getOrganizationInvitationList(e){let{organizationId:t,status:r,limit:i,offset:n}=e;return this.requireId(t),this.request({method:"GET",path:W(ey,t,"invitations"),queryParams:{status:r,limit:i,offset:n}})}async getPendingOrganizationInvitationList(e){k("getPendingOrganizationInvitationList","Use `getOrganizationInvitationList` instead.");let{organizationId:t,limit:r,offset:i}=e;return this.requireId(t),this.request({method:"GET",path:W(ey,t,"invitations","pending"),queryParams:{limit:r,offset:i}})}async createOrganizationInvitation(e){let{organizationId:t,...r}=e;return this.requireId(t),this.request({method:"POST",path:W(ey,t,"invitations"),bodyParams:{...r}})}async getOrganizationInvitation(e){let{organizationId:t,invitationId:r}=e;return this.requireId(t),this.requireId(r),this.request({method:"GET",path:W(ey,t,"invitations",r)})}async revokeOrganizationInvitation(e){let{organizationId:t,invitationId:r,requestingUserId:i}=e;return this.requireId(t),this.request({method:"POST",path:W(ey,t,"invitations",r,"revoke"),bodyParams:{requestingUserId:i}})}},eb="/phone_numbers",e_=class extends F{async getPhoneNumber(e){return this.requireId(e),this.request({method:"GET",path:W(eb,e)})}async createPhoneNumber(e){return this.request({method:"POST",path:eb,bodyParams:e})}async updatePhoneNumber(e,t={}){return this.requireId(e),this.request({method:"PATCH",path:W(eb,e),bodyParams:t})}async deletePhoneNumber(e){return this.requireId(e),this.request({method:"DELETE",path:W(eb,e)})}},ev="/redirect_urls",ew=class extends F{async getRedirectUrlList(){return this.request({method:"GET",path:ev})}async getRedirectUrl(e){return this.requireId(e),this.request({method:"GET",path:W(ev,e)})}async createRedirectUrl(e){return this.request({method:"POST",path:ev,bodyParams:e})}async deleteRedirectUrl(e){return this.requireId(e),this.request({method:"DELETE",path:W(ev,e)})}},eS="/sessions",eA=class extends F{async getSessionList(e){return this.request({method:"GET",path:eS,queryParams:e})}async getSession(e){return this.requireId(e),this.request({method:"GET",path:W(eS,e)})}async revokeSession(e){return this.requireId(e),this.request({method:"POST",path:W(eS,e,"revoke")})}async verifySession(e,t){return this.requireId(e),this.request({method:"POST",path:W(eS,e,"verify"),bodyParams:{token:t}})}async getToken(e,t){return this.requireId(e),(await this.request({method:"POST",path:W(eS,e,"tokens",t||"")})).jwt}},ek="/sign_in_tokens",eE=class extends F{async createSignInToken(e){return this.request({method:"POST",path:ek,bodyParams:e})}async revokeSignInToken(e){return this.requireId(e),this.request({method:"POST",path:W(ek,e,"revoke")})}},ex=class extends F{async createSMSMessage(e){return k("SMSMessageAPI.createSMSMessage","This endpoint is no longer available and the function will be removed in the next major version."),this.request({method:"POST",path:"/sms_messages",bodyParams:e})}},eC="/users",eP=class extends F{async getUserList(e={}){return this.request({method:"GET",path:eC,queryParams:e})}async getUser(e){return this.requireId(e),this.request({method:"GET",path:W(eC,e)})}async createUser(e){return this.request({method:"POST",path:eC,bodyParams:e})}async updateUser(e,t={}){return this.requireId(e),this.request({method:"PATCH",path:W(eC,e),bodyParams:t})}async updateUserProfileImage(e,t){this.requireId(e);let r=new em.FormData;return r.append("file",t?.file),this.request({method:"POST",path:W(eC,e,"profile_image"),formData:r})}async updateUserMetadata(e,t){return this.requireId(e),this.request({method:"PATCH",path:W(eC,e,"metadata"),bodyParams:t})}async deleteUser(e){return this.requireId(e),this.request({method:"DELETE",path:W(eC,e)})}async getCount(e={}){return this.request({method:"GET",path:W(eC,"count"),queryParams:e})}async getUserOauthAccessToken(e,t){return this.requireId(e),this.request({method:"GET",path:W(eC,e,"oauth_access_tokens",t)})}async disableUserMFA(e){return this.requireId(e),this.request({method:"DELETE",path:W(eC,e,"mfa")})}async getOrganizationMembershipList(e){let{userId:t,limit:r,offset:i}=e;return this.requireId(t),this.request({method:"GET",path:W(eC,t,"organization_memberships"),queryParams:{limit:r,offset:i}})}async verifyPassword(e){let{userId:t,password:r}=e;return this.requireId(t),this.request({method:"POST",path:W(eC,t,"verify_password"),bodyParams:{password:r}})}async verifyTOTP(e){let{userId:t,code:r}=e;return this.requireId(t),this.request({method:"POST",path:W(eC,t,"verify_totp"),bodyParams:{code:r}})}},eT="https://api.clerk.dev",eO="@clerk/backend@0.38.1",eB={AuthToken:"x-clerk-auth-token",AuthStatus:"x-clerk-auth-status",AuthReason:"x-clerk-auth-reason",AuthMessage:"x-clerk-auth-message",EnableDebug:"x-clerk-debug",ClerkRedirectTo:"x-clerk-redirect-to",CloudFrontForwardedProto:"cloudfront-forwarded-proto",Authorization:"authorization",ForwardedPort:"x-forwarded-port",ForwardedProto:"x-forwarded-proto",ForwardedHost:"x-forwarded-host",Referrer:"referer",UserAgent:"user-agent",Origin:"origin",Host:"host",ContentType:"content-type"},eR=(eB.AuthStatus,eB.AuthToken,{Attributes:{AuthToken:"__clerkAuthToken",AuthStatus:"__clerkAuthStatus",AuthReason:"__clerkAuthReason",AuthMessage:"__clerkAuthMessage"},Cookies:{Session:"__session",ClientUat:"__client_uat"},Headers:eB,ContentTypes:{Json:"application/json"}});function eI(e){if(!e||"string"!=typeof e)throw Error("Missing Clerk Secret Key or API Key. Go to https://dashboard.clerk.com and get your key for your instance.")}var eN=class e{constructor(e,t,r,i,n){this.id=e,this.identifier=t,this.createdAt=r,this.updatedAt=i,this.invitationId=n}static fromJSON(t){return new e(t.id,t.identifier,t.created_at,t.updated_at,t.invitation_id)}},eU=class e{constructor(e,t,r,i,n,s,o,a,l){this.id=e,this.clientId=t,this.userId=r,this.status=i,this.lastActiveAt=n,this.expireAt=s,this.abandonAt=o,this.createdAt=a,this.updatedAt=l}static fromJSON(t){return new e(t.id,t.client_id,t.user_id,t.status,t.last_active_at,t.expire_at,t.abandon_at,t.created_at,t.updated_at)}},eL=class e{constructor(e,t,r,i,n,s,o,a){this.id=e,this.sessionIds=t,this.sessions=r,this.signInId=i,this.signUpId=n,this.lastActiveSessionId=s,this.createdAt=o,this.updatedAt=a}static fromJSON(t){return new e(t.id,t.session_ids,t.sessions.map(e=>eU.fromJSON(e)),t.sign_in_id,t.sign_up_id,t.last_active_session_id,t.created_at,t.updated_at)}},ej=class e{constructor(e,t,r,i){this.object=e,this.id=t,this.slug=r,this.deleted=i}static fromJSON(t){return new e(t.object,t.id||null,t.slug||null,t.deleted)}},eK=class e{constructor(e,t,r,i,n,s,o,a,l,u,c){this.id=e,this.fromEmailName=t,this.emailAddressId=r,this.toEmailAddress=i,this.subject=n,this.body=s,this.bodyPlain=o,this.status=a,this.slug=l,this.data=u,this.deliveredByClerk=c}static fromJSON(t){return new e(t.id,t.from_email_name,t.email_address_id,t.to_email_address,t.subject,t.body,t.body_plain,t.status,t.slug,t.data,t.delivered_by_clerk)}},eD=class e{constructor(e,t){this.id=e,this.type=t}static fromJSON(t){return new e(t.id,t.type)}},eM=class e{constructor(e,t,r=null,i=null,n=null,s=null){this.status=e,this.strategy=t,this.externalVerificationRedirectURL=r,this.attempts=i,this.expireAt=n,this.nonce=s}static fromJSON(t){return new e(t.status,t.strategy,t.external_verification_redirect_url?new URL(t.external_verification_redirect_url):null,t.attempts,t.expire_at,t.nonce)}},e$=class e{constructor(e,t,r,i){this.id=e,this.emailAddress=t,this.verification=r,this.linkedTo=i}static fromJSON(t){return new e(t.id,t.email_address,t.verification&&eM.fromJSON(t.verification),t.linked_to.map(e=>eD.fromJSON(e)))}},eq=class e{constructor(e,t,r,i,n,s,o,a,l,u,c,h={},d,f){this.id=e,this.provider=t,this.identificationId=r,this.externalId=i,this.approvedScopes=n,this.emailAddress=s,this.firstName=o,this.lastName=a,this.picture=l,this.imageUrl=u,this.username=c,this.publicMetadata=h,this.label=d,this.verification=f}static fromJSON(t){return new e(t.id,t.provider,t.identification_id,t.provider_user_id,t.approved_scopes,t.email_address,t.first_name,t.last_name,t.avatar_url,t.image_url,t.username,t.public_metadata,t.label,t.verification&&eM.fromJSON(t.verification))}};E(eq,"picture","Use `imageUrl` instead.");var eH=class e{constructor(e,t,r,i,n,s,o){this.id=e,this.emailAddress=t,this.publicMetadata=r,this.createdAt=i,this.updatedAt=n,this.status=s,this.revoked=o}static fromJSON(t){return new e(t.id,t.email_address,t.public_metadata,t.created_at,t.updated_at,t.status,t.revoked)}},ez=((n=ez||{}).AllowlistIdentifier="allowlist_identifier",n.Client="client",n.Email="email",n.EmailAddress="email_address",n.ExternalAccount="external_account",n.FacebookAccount="facebook_account",n.GoogleAccount="google_account",n.Invitation="invitation",n.OauthAccessToken="oauth_access_token",n.Organization="organization",n.OrganizationInvitation="organization_invitation",n.OrganizationMembership="organization_membership",n.PhoneNumber="phone_number",n.RedirectUrl="redirect_url",n.Session="session",n.SignInAttempt="sign_in_attempt",n.SignInToken="sign_in_token",n.SignUpAttempt="sign_up_attempt",n.SmsMessage="sms_message",n.User="user",n.Web3Wallet="web3_wallet",n.Token="token",n.TotalCount="total_count",n),eF=class e{constructor(e,t,r={},i,n,s){this.provider=e,this.token=t,this.publicMetadata=r,this.label=i,this.scopes=n,this.tokenSecret=s}static fromJSON(t){return new e(t.provider,t.token,t.public_metadata,t.label,t.scopes,t.token_secret)}},eV=class e{constructor(e,t,r,i,n,s,o,a,l,u={},c={},h,d,f){this.id=e,this.name=t,this.slug=r,this.logoUrl=i,this.imageUrl=n,this.hasImage=s,this.createdBy=o,this.createdAt=a,this.updatedAt=l,this.publicMetadata=u,this.privateMetadata=c,this.maxAllowedMemberships=h,this.adminDeleteEnabled=d,this.members_count=f}static fromJSON(t){return new e(t.id,t.name,t.slug,t.logo_url,t.image_url,t.has_image,t.created_by,t.created_at,t.updated_at,t.public_metadata,t.private_metadata,t.max_allowed_memberships,t.admin_delete_enabled,t.members_count)}};E(eV,"logoUrl","Use `imageUrl` instead.");var eW=class e{constructor(e,t,r,i,n,s,o,a={},l={}){this.id=e,this.emailAddress=t,this.role=r,this.organizationId=i,this.createdAt=n,this.updatedAt=s,this.status=o,this.publicMetadata=a,this.privateMetadata=l}static fromJSON(t){return new e(t.id,t.email_address,t.role,t.organization_id,t.created_at,t.updated_at,t.status,t.public_metadata,t.private_metadata)}},eJ=class e{constructor(e,t,r={},i={},n,s,o,a){this.id=e,this.role=t,this.publicMetadata=r,this.privateMetadata=i,this.createdAt=n,this.updatedAt=s,this.organization=o,this.publicUserData=a}static fromJSON(t){return new e(t.id,t.role,t.public_metadata,t.private_metadata,t.created_at,t.updated_at,eV.fromJSON(t.organization),eG.fromJSON(t.public_user_data))}},eG=class e{constructor(e,t,r,i,n,s,o){this.identifier=e,this.firstName=t,this.lastName=r,this.profileImageUrl=i,this.imageUrl=n,this.hasImage=s,this.userId=o}static fromJSON(t){return new e(t.identifier,t.first_name,t.last_name,t.profile_image_url,t.image_url,t.has_image,t.user_id)}};E(eG,"profileImageUrl","Use `imageUrl` instead.");var eY=class e{constructor(e,t,r,i,n,s){this.id=e,this.phoneNumber=t,this.reservedForSecondFactor=r,this.defaultSecondFactor=i,this.verification=n,this.linkedTo=s}static fromJSON(t){return new e(t.id,t.phone_number,t.reserved_for_second_factor,t.default_second_factor,t.verification&&eM.fromJSON(t.verification),t.linked_to.map(e=>eD.fromJSON(e)))}},eX=class e{constructor(e,t,r,i){this.id=e,this.url=t,this.createdAt=r,this.updatedAt=i}static fromJSON(t){return new e(t.id,t.url,t.created_at,t.updated_at)}},eQ=class e{constructor(e,t,r,i,n,s,o){this.id=e,this.userId=t,this.token=r,this.status=i,this.url=n,this.createdAt=s,this.updatedAt=o}static fromJSON(t){return new e(t.id,t.user_id,t.token,t.status,t.url,t.created_at,t.updated_at)}},eZ=class e{constructor(e,t,r,i,n,s,o){this.id=e,this.fromPhoneNumber=t,this.toPhoneNumber=r,this.message=i,this.status=n,this.phoneNumberId=s,this.data=o}static fromJSON(t){return new e(t.id,t.from_phone_number,t.to_phone_number,t.message,t.status,t.phone_number_id,t.data)}},e0=class e{constructor(e){this.jwt=e}static fromJSON(t){return new e(t.jwt)}},e1=class e{constructor(e,t,r){this.id=e,this.web3Wallet=t,this.verification=r}static fromJSON(t){return new e(t.id,t.web3_wallet,t.verification&&eM.fromJSON(t.verification))}},e2=class e{constructor(e,t,r,i,n,s,o,a,l,u,c,h,d,f,p,m,y,g,b,_,v,w={},S={},A={},k=[],E=[],x=[],C=[],P){this.id=e,this.passwordEnabled=t,this.totpEnabled=r,this.backupCodeEnabled=i,this.twoFactorEnabled=n,this.banned=s,this.createdAt=o,this.updatedAt=a,this.profileImageUrl=l,this.imageUrl=u,this.hasImage=c,this.gender=h,this.birthday=d,this.primaryEmailAddressId=f,this.primaryPhoneNumberId=p,this.primaryWeb3WalletId=m,this.lastSignInAt=y,this.externalId=g,this.username=b,this.firstName=_,this.lastName=v,this.publicMetadata=w,this.privateMetadata=S,this.unsafeMetadata=A,this.emailAddresses=k,this.phoneNumbers=E,this.web3Wallets=x,this.externalAccounts=C,this.createOrganizationEnabled=P}static fromJSON(t){return new e(t.id,t.password_enabled,t.totp_enabled,t.backup_code_enabled,t.two_factor_enabled,t.banned,t.created_at,t.updated_at,t.profile_image_url,t.image_url,t.has_image,t.gender,t.birthday,t.primary_email_address_id,t.primary_phone_number_id,t.primary_web3_wallet_id,t.last_sign_in_at,t.external_id,t.username,t.first_name,t.last_name,t.public_metadata,t.private_metadata,t.unsafe_metadata,(t.email_addresses||[]).map(e=>e$.fromJSON(e)),(t.phone_numbers||[]).map(e=>eY.fromJSON(e)),(t.web3_wallets||[]).map(e=>e1.fromJSON(e)),(t.external_accounts||[]).map(e=>eq.fromJSON(e)),t.create_organization_enabled)}};function e8(e){if("string"!=typeof e&&"object"in e&&"deleted"in e)return ej.fromJSON(e);switch(e.object){case"allowlist_identifier":return eN.fromJSON(e);case"client":return eL.fromJSON(e);case"email_address":return e$.fromJSON(e);case"email":return eK.fromJSON(e);case"invitation":return eH.fromJSON(e);case"oauth_access_token":return eF.fromJSON(e);case"organization":return eV.fromJSON(e);case"organization_invitation":return eW.fromJSON(e);case"organization_membership":return eJ.fromJSON(e);case"phone_number":return eY.fromJSON(e);case"redirect_url":return eX.fromJSON(e);case"sign_in_token":return eQ.fromJSON(e);case"session":return eU.fromJSON(e);case"sms_message":return eZ.fromJSON(e);case"token":return e0.fromJSON(e);case"total_count":return e.total_count;case"user":return e2.fromJSON(e);default:return e}}E(e2,"profileImageUrl","Use `imageUrl` instead.");var e3=e=>async(...t)=>{let r=await e(...t);if(null===r.errors)return r.data;{let{errors:e,clerkTraceId:t}=r,{status:i,statusText:n}=r,s=new U(n||"",{data:[],status:i||"",clerkTraceId:t});throw s.errors=e,s}};function e4(e,t){return e&&"object"==typeof e&&"clerk_trace_id"in e&&"string"==typeof e.clerk_trace_id?e.clerk_trace_id:t?.get("cf-ray")||""}function e5(e){return{code:e.code,message:e.message,longMessage:e.long_message,meta:{paramName:e?.meta?.param_name,sessionId:e?.meta?.session_id}}}function e6(e){let t=e3(async t=>{let r;let{apiKey:i,secretKey:n,httpOptions:s,apiUrl:o=eT,apiVersion:a="v1",userAgent:l=eO}=e;i&&k("apiKey","Use `secretKey` instead."),s&&k("httpOptions","This option has been deprecated and will be removed with the next major release.\nA RequestInit init object used by the `request` method.");let{path:u,method:c,queryParams:h,headerParams:d,bodyParams:f,formData:p}=t,m=n||i;eI(m);let y=W(o,a,u),g=new URL(y);if(h)for(let[e,t]of Object.entries(H()({...h})))t&&[t].flat().forEach(t=>g.searchParams.append(e,t));let b={Authorization:`Bearer ${m}`,"User-Agent":l,...d};try{if(p)r=await em.fetch(g.href,{...s,method:c,headers:b,body:p});else{b["Content-Type"]="application/json";let e="GET"!==c&&f&&Object.keys(f).length>0?{body:JSON.stringify(H()(f,{deep:!1}))}:null;r=await em.fetch(g.href,$()(s||{},{method:c,headers:b,...e}))}let e=r?.headers&&r.headers?.get(eR.Headers.ContentType)===eR.ContentTypes.Json,t=await (e?r.json():r.text());if(!r.ok)throw t;return{data:Array.isArray(t)?t.map(e=>e8(e)):Array.isArray(t.data)&&void 0!==t.data?t.data.map(e=>e8(e)):e8(t),errors:null}}catch(e){if(e instanceof Error)return{data:null,errors:[{code:"unexpected_error",message:e.message||"Unexpected error"}],clerkTraceId:e4(e,r?.headers)};return{data:null,errors:function(e){if(e&&"object"==typeof e&&"errors"in e){let t=e.errors;return t.length>0?t.map(e5):[]}return[]}(e),status:r?.status,statusText:r?.statusText,clerkTraceId:e4(e,r?.headers)}}});return{allowlistIdentifiers:new G(t),clients:new X(t),emailAddresses:new ee(t),emails:new et(t),interstitial:new en(t),invitations:new eo(t),organizations:new eg(t),phoneNumbers:new e_(t),redirectUrls:new ew(t),sessions:new eA(t),signInTokens:new eE(t),smsMessages:new ex(t),users:new eP(t),domains:new Q(t)}}var e7=e=>()=>{let t={...e};return t.apiKey=(t.apiKey||"").substring(0,7),t.secretKey=(t.secretKey||"").substring(0,7),t.jwtKey=(t.jwtKey||"").substring(0,7),{...t}};function e9(e,t,r){let{act:i,sid:n,org_id:s,org_role:o,org_slug:a,org_permissions:l,sub:u}=e,{apiKey:c,secretKey:h,apiUrl:d,apiVersion:f,token:p,session:m,user:y,organization:g}=t;c&&k("apiKey","Use `secretKey` instead.");let{sessions:b}=e6({apiKey:c,secretKey:h,apiUrl:d,apiVersion:f}),_=ti({sessionId:n,sessionToken:p,fetcher:(...e)=>b.getToken(...e)});return{actor:i,sessionClaims:e,sessionId:n,session:m,userId:u,user:y,orgId:s,orgRole:o,orgSlug:a,orgPermissions:l,organization:g,getToken:_,has:tn({orgId:s,orgRole:o,orgPermissions:l,userId:u}),debug:e7({...t,...r})}}function te(e){return e?.apiKey&&k("apiKey","Use `secretKey` instead."),{sessionClaims:null,sessionId:null,session:null,userId:null,user:null,actor:null,orgId:null,orgRole:null,orgSlug:null,orgPermissions:null,organization:null,getToken:()=>Promise.resolve(null),has:()=>!1,debug:e7(e)}}function tt(e){return e&&(delete e.privateMetadata,delete e.private_metadata),e}var tr=e=>{let{debug:t,getToken:r,has:i,...n}=e;return n},ti=e=>{let{fetcher:t,sessionToken:r,sessionId:i}=e||{};return async(e={})=>i?e.template?t(i,e.template):r:null},tn=({orgId:e,orgRole:t,userId:r,orgPermissions:i})=>n=>{if(!n?.permission&&!n?.role)throw Error('Missing parameters. `has` from `auth` or `getAuth` requires a permission or role key to be passed. Example usage: `has({permission: "org:posts:edit"`');return!!e&&!!r&&!!t&&!!i&&(n.permission?i.includes(n.permission):!!n.role&&t===n.role)},ts=class e extends Error{constructor({action:t,message:r,reason:i}){super(r),Object.setPrototypeOf(this,e.prototype),this.reason=i,this.message=r,this.action=t}getFullMessage(){return`${[this.message,this.action].filter(e=>e).join(" ")} (reason=${this.reason}, token-carrier=${this.tokenCarrier})`}};async function to(e){e.frontendApi&&k("frontendApi","Use `publishableKey` instead."),e.pkgVersion&&k("pkgVersion","Use `clerkJSVersion` instead."),e.frontendApi=R(e.publishableKey)?.frontendApi||e.frontendApi||"";let t=ta(e),r=await T(()=>em.fetch(ta(e),{method:"GET",headers:{"Clerk-Backend-SDK":e.userAgent||eO}}));if(!r.ok)throw new ts({action:"Contact support@clerk.com",message:`Error loading Clerk Interstitial from ${t} with code=${r.status}`,reason:"interstitial-remote-failed-to-load"});return r.text()}function ta(e){e.frontendApi&&k("frontendApi","Use `publishableKey` instead."),e.frontendApi=R(e.publishableKey)?.frontendApi||e.frontendApi||"";let{apiUrl:t,frontendApi:r,pkgVersion:i,clerkJSVersion:n,publishableKey:s,proxyUrl:o,isSatellite:a,domain:l,signInUrl:u}=e,c=new URL(t);return c.pathname=W(c.pathname,"v1","/public/interstitial"),c.searchParams.append("clerk_js_version",n||C(r,i)),s?c.searchParams.append("publishable_key",s):c.searchParams.append("frontend_api",r),o&&c.searchParams.append("proxy_url",o),a&&c.searchParams.append("is_satellite","true"),c.searchParams.append("sign_in_url",u||""),ei(e.frontendApi)||c.searchParams.append("use_domain_for_script","true"),l&&c.searchParams.append("domain",l),c.href}var tl=e=>e?.split(",")[0],tu=({protocol:e,forwardedProto:t,forwardedHost:r,host:i})=>{let n=tl(r)??i,s=tl(t)??e?.replace(/[:/]/,"");return n&&s?`${s}://${n}`:""},tc=e=>e?{cookies:td(e),headers:tf(e),searchParams:tp(e)}:{},th=e=>e?e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent):e,td=e=>{let t=e.headers&&e.headers?.get("cookie")?(0,z.Q)(e.headers.get("cookie")):{};return e=>{let r=t?.[e];if(void 0!==r)return th(r)}},tf=e=>t=>e?.headers?.get(t)||void 0,tp=e=>e?.url?new URL(e.url)?.searchParams:void 0,tm=e=>e?.replace("Bearer ",""),ty=((s=ty||{}).SignedIn="signed-in",s.SignedOut="signed-out",s.Interstitial="interstitial",s.Unknown="unknown",s);async function tg(e,t){let{apiKey:r,secretKey:i,apiUrl:n,apiVersion:s,cookieToken:o,frontendApi:a,proxyUrl:l,publishableKey:u,domain:c,isSatellite:h,headerToken:d,loadSession:f,loadUser:p,loadOrganization:m,signInUrl:y,signUpUrl:g,afterSignInUrl:b,afterSignUpUrl:_,token:v}=e,{sid:w,org_id:S,sub:A}=t,{sessions:k,users:E,organizations:x}=e6({apiKey:r,secretKey:i,apiUrl:n,apiVersion:s}),[C,P,T]=await Promise.all([f?k.getSession(w):Promise.resolve(void 0),p?E.getUser(A):Promise.resolve(void 0),m&&S?x.getOrganization({organizationId:S}):Promise.resolve(void 0)]),O=e9(t,{secretKey:i,apiKey:r,apiUrl:n,apiVersion:s,token:o||d||"",session:C,user:P,organization:T},{...e,status:"signed-in"});return{status:"signed-in",reason:null,message:null,frontendApi:a,proxyUrl:l,publishableKey:u,domain:c,isSatellite:h,signInUrl:y,signUpUrl:g,afterSignInUrl:b,afterSignUpUrl:_,isSignedIn:!0,isInterstitial:!1,isUnknown:!1,toAuth:()=>O,token:v}}function tb(e,t,r=""){let{frontendApi:i,publishableKey:n,proxyUrl:s,isSatellite:o,domain:a,signInUrl:l,signUpUrl:u,afterSignInUrl:c,afterSignUpUrl:h}=e;return{status:"signed-out",reason:t,message:r,frontendApi:i,proxyUrl:s,publishableKey:n,isSatellite:o,domain:a,signInUrl:l,signUpUrl:u,afterSignInUrl:c,afterSignUpUrl:h,isSignedIn:!1,isInterstitial:!1,isUnknown:!1,toAuth:()=>te({...e,status:"signed-out",reason:t,message:r}),token:null}}function t_(e,t,r=""){let{frontendApi:i,publishableKey:n,proxyUrl:s,isSatellite:o,domain:a,signInUrl:l,signUpUrl:u,afterSignInUrl:c,afterSignUpUrl:h}=e;return{status:"interstitial",reason:t,message:r,frontendApi:i,publishableKey:n,isSatellite:o,domain:a,proxyUrl:s,signInUrl:l,signUpUrl:u,afterSignInUrl:c,afterSignUpUrl:h,isSignedIn:!1,isInterstitial:!0,isUnknown:!1,toAuth:()=>null,token:null}}function tv({originURL:e,host:t,forwardedHost:r,forwardedProto:i}){let n=tu({forwardedProto:i,forwardedHost:r,protocol:e.protocol,host:t});return n&&new URL(n).origin!==e.origin}var tw=(e,t)=>e?e.find(e=>e.code===t):null,tS={parse:(e,t)=>(function(e,t,r={}){if(!t.codes){t.codes={};for(let e=0;e<t.chars.length;++e)t.codes[t.chars[e]]=e}if(!r.loose&&e.length*t.bits&7)throw SyntaxError("Invalid padding");let i=e.length;for(;"="===e[i-1];)if(--i,!r.loose&&!((e.length-i)*t.bits&7))throw SyntaxError("Invalid padding");let n=new(r.out??Uint8Array)(i*t.bits/8|0),s=0,o=0,a=0;for(let r=0;r<i;++r){let i=t.codes[e[r]];if(void 0===i)throw SyntaxError("Invalid character "+e[r]);o=o<<t.bits|i,(s+=t.bits)>=8&&(s-=8,n[a++]=255&o>>s)}if(s>=t.bits||255&o<<8-s)throw SyntaxError("Unexpected end of data");return n})(e,tA,t),stringify:(e,t)=>(function(e,t,r={}){let{pad:i=!0}=r,n=(1<<t.bits)-1,s="",o=0,a=0;for(let r=0;r<e.length;++r)for(a=a<<8|255&e[r],o+=8;o>t.bits;)o-=t.bits,s+=t.chars[n&a>>o];if(o&&(s+=t.chars[n&a<<t.bits-o]),i)for(;s.length*t.bits&7;)s+="=";return s})(e,tA,t)},tA={chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bits:6},tk={RS256:"SHA-256",RS384:"SHA-384",RS512:"SHA-512"},tE="RSASSA-PKCS1-v1_5",tx={RS256:tE,RS384:tE,RS512:tE},tC=Object.keys(tk),tP=e=>Array.isArray(e)&&e.length>0&&e.every(e=>"string"==typeof e),tT=(e,t)=>{let r=[t].flat().filter(e=>!!e),i=[e].flat().filter(e=>!!e);if(r.length>0&&i.length>0){if("string"==typeof e){if(!r.includes(e))throw new ts({action:"Make sure that this is a valid Clerk generate JWT.",reason:"token-verification-failed",message:`Invalid JWT audience claim (aud) ${JSON.stringify(e)}. Is not included in "${JSON.stringify(r)}".`})}else if(tP(e)&&!e.some(e=>r.includes(e)))throw new ts({action:"Make sure that this is a valid Clerk generate JWT.",reason:"token-verification-failed",message:`Invalid JWT audience claim array (aud) ${JSON.stringify(e)}. Is not included in "${JSON.stringify(r)}".`})}},tO=e=>{if(void 0!==e&&"JWT"!==e)throw new ts({action:"Make sure that this is a valid Clerk generate JWT.",reason:"token-invalid",message:`Invalid JWT type ${JSON.stringify(e)}. Expected "JWT".`})},tB=e=>{if(!tC.includes(e))throw new ts({action:"Make sure that this is a valid Clerk generate JWT.",reason:"token-invalid-algorithm",message:`Invalid JWT algorithm ${JSON.stringify(e)}. Supported: ${tC}.`})},tR=e=>{if("string"!=typeof e)throw new ts({action:"Make sure that this is a valid Clerk generate JWT.",reason:"token-verification-failed",message:`Subject claim (sub) is required and must be a string. Received ${JSON.stringify(e)}.`})},tI=(e,t)=>{if(e&&t&&0!==t.length&&!t.includes(e))throw new ts({reason:"token-invalid-authorized-parties",message:`Invalid JWT Authorized party claim (azp) ${JSON.stringify(e)}. Expected "${t}".`})},tN=(e,t)=>{if("function"!=typeof t||t(e)){if("string"==typeof t&&e&&e!==t)throw new ts({reason:"token-invalid-issuer",message:`Invalid JWT issuer claim (iss) ${JSON.stringify(e)}. Expected "${t}".`})}else throw new ts({reason:"token-invalid-issuer",message:"Failed JWT issuer resolver. Make sure that the resolver returns a truthy value."})},tU=(e,t)=>{if("number"!=typeof e)throw new ts({action:"Make sure that this is a valid Clerk generate JWT.",reason:"token-verification-failed",message:`Invalid JWT expiry date claim (exp) ${JSON.stringify(e)}. Expected number.`});let r=new Date(Date.now()),i=new Date(0);if(i.setUTCSeconds(e),i.getTime()<=r.getTime()-t)throw new ts({reason:"token-expired",message:`JWT is expired. Expiry date: ${i.toUTCString()}, Current date: ${r.toUTCString()}.`})},tL=(e,t)=>{if(void 0===e)return;if("number"!=typeof e)throw new ts({action:"Make sure that this is a valid Clerk generate JWT.",reason:"token-verification-failed",message:`Invalid JWT not before date claim (nbf) ${JSON.stringify(e)}. Expected number.`});let r=new Date(Date.now()),i=new Date(0);if(i.setUTCSeconds(e),i.getTime()>r.getTime()+t)throw new ts({reason:"token-not-active-yet",message:`JWT cannot be used prior to not before date claim (nbf). Not before date: ${i.toUTCString()}; Current date: ${r.toUTCString()};`})},tj=(e,t)=>{if(void 0===e)return;if("number"!=typeof e)throw new ts({action:"Make sure that this is a valid Clerk generate JWT.",reason:"token-verification-failed",message:`Invalid JWT issued at date claim (iat) ${JSON.stringify(e)}. Expected number.`});let r=new Date(Date.now()),i=new Date(0);if(i.setUTCSeconds(e),i.getTime()>r.getTime()+t)throw new ts({reason:"token-not-active-yet",message:`JWT issued at date claim (iat) is in the future. Issued at date: ${i.toUTCString()}; Current date: ${r.toUTCString()};`})};async function tK(e,t){let{header:r,signature:i,raw:n}=e,s=new TextEncoder().encode([n.header,n.payload].join(".")),o=function(e){let t=tk[e],r=tx[e];if(!t||!r)throw Error(`Unsupported algorithm ${e}, expected one of ${tC.join(",")}.`);return{hash:{name:tk[e]},name:tx[e]}}(r.alg),a=await function(e,t,r){if("object"==typeof e)return em.crypto.subtle.importKey("jwk",e,t,!1,[r]);let i=function(e){let t=O(e.replace(/-----BEGIN.*?-----/g,"").replace(/-----END.*?-----/g,"").replace(/\s/g,"")),r=new ArrayBuffer(t.length),i=new Uint8Array(r);for(let e=0,r=t.length;e<r;e++)i[e]=t.charCodeAt(e);return i}(e),n="sign"===r?"pkcs8":"spki";return em.crypto.subtle.importKey(n,i,t,!1,[r])}(t,o,"verify");return em.crypto.subtle.verify(o.name,a,i,s)}function tD(e){let t=(e||"").toString().split(".");if(3!==t.length)throw new ts({reason:"token-invalid",message:"Invalid JWT form. A JWT consists of three parts separated by dots."});let[r,i,n]=t,s=new TextDecoder,o=JSON.parse(s.decode(tS.parse(r,{loose:!0}))),a=JSON.parse(s.decode(tS.parse(i,{loose:!0}))),l=tS.parse(n,{loose:!0});return x(a,"orgs",'Add orgs to your session token using the "user.organizations" shortcode in JWT Templates instead.',"decodeJwt:orgs"),{header:o,payload:a,signature:l,raw:{header:r,payload:i,signature:n,text:e}}}async function tM(e,{audience:t,authorizedParties:r,clockSkewInSeconds:i,clockSkewInMs:n,issuer:s,key:o}){let a;i&&k("clockSkewInSeconds","Use `clockSkewInMs` instead.");let l=n||i||5e3,u=tD(e),{header:c,payload:h}=u,{typ:d,alg:f}=c;tO(d),tB(f);let{azp:p,sub:m,aud:y,iss:g,iat:b,exp:_,nbf:v}=h;tR(m),tT([y],[t]),tI(p,r),tN(g,s),tU(_,l),tL(v,l),tj(b,l);try{a=await tK(u,o)}catch(e){throw new ts({action:"Make sure that this is a valid Clerk generate JWT.",reason:"token-verification-failed",message:`Error verifying JWT signature. ${e}`})}if(!a)throw new ts({reason:"token-invalid-signature",message:"JWT signature is invalid."});return h}var t$={},tq=0;function tH(e,t=36e5){t$[e.kid]=e,tq=Date.now(),t>=0&&setTimeout(()=>{e?delete t$[e.kid]:t$={}},t)}var tz="local";async function tF({apiKey:e,secretKey:t,apiUrl:r=eT,apiVersion:i="v1",issuer:n,kid:s,jwksCacheTtlInMs:o=36e5,skipJwksCache:a}){let l=!t$[s]&&Date.now()-tq>=3e5;if(a||l){let s;let a=t||e;if(a)s=()=>tW(r,a,i);else if(n)s=()=>tV(n);else throw new ts({action:"Contact support@clerk.com",message:"Failed to load JWKS from Clerk Backend or Frontend API.",reason:"jwk-remote-failed-to-load"});let{keys:l}=await T(s);if(!l||!l.length)throw new ts({action:"Contact support@clerk.com",message:"The JWKS endpoint did not contain any signing keys. Contact support@clerk.com.",reason:"jwk-remote-failed-to-load"});l.forEach(e=>tH(e,o))}let u=t$[s];if(!u){let e=Object.values(t$).map(e=>e.kid).join(", ");throw new ts({action:"Contact support@clerk.com",message:`Unable to find a signing key in JWKS that matches the kid='${s}' of the provided session token. Please make sure that the __session cookie or the HTTP authorization header contain a Clerk-generated session JWT.${e?` The following kid are available: ${e}`:""}`,reason:"jwk-remote-missing"})}return u}async function tV(e){let t=new URL(e);t.pathname=W(t.pathname,".well-known/jwks.json");let r=await em.fetch(t.href);if(!r.ok)throw new ts({action:"Contact support@clerk.com",message:`Error loading Clerk JWKS from ${t.href} with code=${r.status}`,reason:"jwk-remote-failed-to-load"});return r.json()}async function tW(e,t,r){if(!t)throw new ts({action:"Set the CLERK_SECRET_KEY or CLERK_API_KEY environment variable.",message:"Missing Clerk Secret Key or API Key. Go to https://dashboard.clerk.com and get your key for your instance.",reason:"jwk-remote-failed-to-load"});let i=new URL(e);i.pathname=W(i.pathname,r,"/jwks");let n=await em.fetch(i.href,{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(!n.ok){let e=await n.json(),t=tw(e?.errors,"clerk_key_invalid");if(t)throw new ts({action:"Contact support@clerk.com",message:t.message,reason:"secret-key-invalid"});throw new ts({action:"Contact support@clerk.com",message:`Error loading Clerk JWKS from ${i.href} with code=${n.status}`,reason:"jwk-remote-failed-to-load"})}return n.json()}async function tJ(e,t){let r;let{apiKey:i,secretKey:n,apiUrl:s,apiVersion:o,audience:a,authorizedParties:l,clockSkewInSeconds:u,clockSkewInMs:c,issuer:h,jwksCacheTtlInMs:d,jwtKey:f,skipJwksCache:p}=t;t.apiKey&&k("apiKey","Use `secretKey` instead.");let{header:m}=tD(e),{kid:y}=m;if(f)r=function(e){if(!t$[tz]){if(!e)throw new ts({action:"Set the CLERK_JWT_KEY environment variable.",message:"Missing local JWK.",reason:"jwk-local-missing"});tH({kid:"local",kty:"RSA",alg:"RS256",n:e.replace(/(\r\n|\n|\r)/gm,"").replace("-----BEGIN PUBLIC KEY-----","").replace("-----END PUBLIC KEY-----","").replace("MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA","").replace("IDAQAB","").replace(/\+/g,"-").replace(/\//g,"_"),e:"AQAB"},-1)}return t$[tz]}(f);else if("string"==typeof h)r=await tF({issuer:h,kid:y,jwksCacheTtlInMs:d,skipJwksCache:p});else if(i||n)r=await tF({apiKey:i,secretKey:n,apiUrl:s,apiVersion:o,kid:y,jwksCacheTtlInMs:d,skipJwksCache:p});else throw new ts({action:"Set the CLERK_JWT_KEY environment variable.",message:"Failed to resolve JWK during verification.",reason:"jwk-failed-to-resolve"});return await tM(e,{audience:a,authorizedParties:l,clockSkewInSeconds:u,clockSkewInMs:c,key:r,issuer:h})}var tG=e=>!!e?.get("__clerk_satellite_url"),tY=e=>e?.get("__clerk_synced")==="true",tX=/^Mozilla\/|(Amazon CloudFront)/,tQ=e=>tX.test(e||""),tZ=e=>{let{apiKey:t,secretKey:r,userAgent:i}=e;if(I(r||t||"")&&!tQ(i))return tb(e,"header-missing-non-browser")},t0=e=>{let{origin:t,host:r,forwardedHost:i,forwardedProto:n}=e;if(t&&tv({originURL:new URL(t),host:r,forwardedHost:i,forwardedProto:n}))return tb(e,"header-missing-cors")},t1=e=>{let{apiKey:t,secretKey:r,isSatellite:i,searchParams:n}=e;if(I(r||t||"")&&!i&&tG(n))return t_(e,"primary-responds-to-syncing")},t2=e=>{let{apiKey:t,secretKey:r,clientUat:i}=e;if(I(r||t||"")&&!i)return t_(e,"uat-missing")},t8=e=>{let{apiKey:t,secretKey:r,referrer:i,host:n,forwardedHost:s,forwardedProto:o}=e,a=i&&tv({originURL:new URL(i),host:n,forwardedHost:s,forwardedProto:o});if(I(r||t||"")&&a)return t_(e,"cross-origin-referrer")},t3=e=>{let{apiKey:t,secretKey:r,clientUat:i,cookieToken:n}=e;if(function(e){return e.startsWith("live_")||e.startsWith("sk_live_")}(r||t||"")&&!i&&!n)return tb(e,"cookie-and-uat-missing")},t4=e=>{let{clientUat:t}=e;if("0"===t)return tb(e,"standard-signed-out")},t5=e=>{let{clientUat:t,cookieToken:r}=e;if(t&&Number.parseInt(t)>0&&!r)return t_(e,"cookie-missing")},t6=async e=>{let{headerToken:t}=e,r=await re(e,t);return await tg({...e,token:t},r)},t7=async e=>{let{cookieToken:t,clientUat:r}=e,i=await re(e,t),n=await tg({...e,token:t},i),s=n.toAuth().sessionClaims.iat<Number.parseInt(r);return!r||s?t_(e,"cookie-outdated"):n};async function t9(e,t){for(let r of t){let t=await r(e);if(t)return t}return tb(e,"unexpected-error")}async function re(e,t){let{isSatellite:r,proxyUrl:i}=e;return tJ(t,{...e,issuer:r?null:i||(e=>e.startsWith("https://clerk.")||e.includes(".clerk.accounts"))})}var rt=e=>{let{clientUat:t,isSatellite:r,searchParams:i,userAgent:n}=e,s=!t||"0"===t;return r&&s&&!tQ(n)?tb(e,"satellite-needs-syncing"):r&&s&&!tY(i)?t_(e,"satellite-needs-syncing"):void 0};async function rr(e){let{cookies:t,headers:r,searchParams:i}=tc(e?.request);async function n(){try{return await t9(e,[t6])}catch(e){return o(e,"header")}}async function s(){try{return await t9(e,[t0,tZ,rt,t1,t3,t2,t8,t5,t4,t7])}catch(e){return o(e,"cookie")}}function o(t,r){return t instanceof ts?(t.tokenCarrier=r,["token-expired","token-not-active-yet"].includes(t.reason))?"header"===r?function(e,t,r=""){let{frontendApi:i,publishableKey:n,isSatellite:s,domain:o,signInUrl:a,signUpUrl:l,afterSignInUrl:u,afterSignUpUrl:c}=e;return{status:"unknown",reason:t,message:r,frontendApi:i,publishableKey:n,isSatellite:s,domain:o,signInUrl:a,signUpUrl:l,afterSignInUrl:u,afterSignUpUrl:c,isSignedIn:!1,isInterstitial:!1,isUnknown:!0,toAuth:()=>null,token:null}}(e,t.reason,t.getFullMessage()):t_(e,t.reason,t.getFullMessage()):tb(e,t.reason,t.getFullMessage()):tb(e,"unexpected-error",t.message)}return(e.frontendApi&&k("frontendApi","Use `publishableKey` instead."),e.apiKey&&k("apiKey","Use `secretKey` instead."),eI((e={...e,...rn(e,r),frontendApi:R(e.publishableKey)?.frontendApi||e.frontendApi,apiUrl:e.apiUrl||eT,apiVersion:e.apiVersion||"v1",cookieToken:e.cookieToken||t?.(eR.Cookies.Session),clientUat:e.clientUat||t?.(eR.Cookies.ClientUat),searchParams:e.searchParams||i||void 0}).secretKey||e.apiKey),e.isSatellite&&(function(e,t){if(!e&&I(t))throw Error("Missing signInUrl. Pass a signInUrl for dev instances if an app is satellite")}(e.signInUrl,e.secretKey||e.apiKey),e.signInUrl&&e.origin&&function(e,t){let r;try{r=new URL(e)}catch{throw Error("The signInUrl needs to have a absolute url format.")}if(r.origin===t)throw Error("The signInUrl needs to be on a different origin than your satellite application.")}(e.signInUrl,e.origin),function(e){if(!e)throw Error("Missing domain and proxyUrl. A satellite application needs to specify a domain or a proxyUrl")}(e.proxyUrl||e.domain)),e.headerToken)?n():s()}var ri=e=>{let{frontendApi:t,isSignedIn:r,proxyUrl:i,isInterstitial:n,reason:s,message:o,publishableKey:a,isSatellite:l,domain:u}=e;return{frontendApi:t,isSignedIn:r,proxyUrl:i,isInterstitial:n,reason:s,message:o,publishableKey:a,isSatellite:l,domain:u}},rn=(e,t)=>t?{headerToken:tm(e.headerToken||t(eR.Headers.Authorization)),origin:e.origin||t(eR.Headers.Origin),host:e.host||t(eR.Headers.Host),forwardedHost:e.forwardedHost||t(eR.Headers.ForwardedHost),forwardedPort:e.forwardedPort||t(eR.Headers.ForwardedPort),forwardedProto:e.forwardedProto||t(eR.Headers.CloudFrontForwardedProto)||t(eR.Headers.ForwardedProto),referrer:e.referrer||t(eR.Headers.Referrer),userAgent:e.userAgent||t(eR.Headers.UserAgent)}:{},rs=(e,t)=>{let r;if(e.startsWith("http"))r=new URL(e);else{if(!t||!t.startsWith("http"))throw Error("destination url or return back url should be an absolute path url!");let i=new URL(t);r=new URL(e,i.origin)}return t&&r.searchParams.set("redirect_url",t),r.toString()};process.env.CLERK_JS_VERSION&&k("CLERK_JS_VERSION","Use `NEXT_PUBLIC_CLERK_JS_VERSION` environment variable instead."),process.env.NEXT_PUBLIC_CLERK_JS_VERSION,process.env.NEXT_PUBLIC_CLERK_JS;let ro=process.env.CLERK_API_URL||"https://api.clerk.dev",ra=process.env.CLERK_API_VERSION||"v1",rl=process.env.CLERK_API_KEY||"";rl&&k("CLERK_API_KEY","Use `CLERK_SECRET_KEY` environment variable instead.");let ru=process.env.CLERK_SECRET_KEY||"",rc=process.env.NEXT_PUBLIC_CLERK_FRONTEND_API||"";rc&&k("NEXT_PUBLIC_CLERK_FRONTEND_API","Use `NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY` environment variable instead.");let rh=process.env.NEXT_PUBLIC_CLERK_DOMAIN||"",rd=process.env.NEXT_PUBLIC_CLERK_PROXY_URL||"",rf="true"===process.env.NEXT_PUBLIC_CLERK_IS_SATELLITE,rp=process.env.NEXT_PUBLIC_CLERK_SIGN_IN_URL||"",rm=process.env.NEXT_PUBLIC_CLERK_SIGN_UP_URL||"";var ry=r(78070);let rg=(e="auth")=>`Clerk: ${e}() was called but Clerk can't detect usage of authMiddleware(). Please ensure the following:
- authMiddleware() is used in your Next.js Middleware.
- Your Middleware matcher is configured to match this route or page.
- If you are using the src directory, make sure the Middleware file is inside of it.

For more details, see https://clerk.com/docs/quickstarts/nextjs
`;function rb(e,t){var r;return((r=eR.Attributes[t])in e?e[r]:void 0)||r_(e,eR.Headers[t])||("AuthStatus"===t||"AuthToken"===t)&&function(e,t){let r;if(rv(e))return e.nextUrl.searchParams.get(t);if("query"in e&&(r=e.query[t]),!r){let i=(e.url||"").split("?")[1];r=new URLSearchParams(i).get(t)}return r}(e,t)||void 0}function r_(e,t){return rv(e)?e.headers.get(t):e.headers[t]||e.headers[t.toLowerCase()]||e.socket?._httpMessage?.getHeader(t)}function rv(e){try{let{headers:t,nextUrl:r,cookies:i}=e||{};return"function"==typeof t?.get&&"function"==typeof r?.searchParams.get&&"function"==typeof i?.get}catch(e){return!1}}let rw=(e,t)=>{let r={...t};return{...e,__clerk_ssr_state:r}},rS=e=>{if(!e||"string"!=typeof e)return e;try{return(e||"").replace(/^(sk_(live|test)_)(.+?)(.{3})$/,"$1*********$4")}catch(e){return""}},rA=e=>(Array.isArray(e)?e:[e]).map(e=>"string"==typeof e?rS(e):JSON.stringify(Object.fromEntries(Object.entries(e).map(([e,t])=>[e,rS(t)])),null,2)).join(", "),rk=(e,t)=>()=>{let r=[],i=!1;return{enable:()=>{i=!0},debug:(...e)=>{i&&r.push(e.map(e=>"function"==typeof e?e():e))},commit:()=>{if(i){for(let i of(console.log(`[clerk debug start: ${e}]`),r)){let e=t(i);e=e.split("\n").map(e=>`  ${e}`).join("\n"),process.env.VERCEL&&(e=function(e,t){let r=new TextEncoder,i=new TextDecoder("utf-8"),n=r.encode(e).slice(0,4096);return i.decode(n).replace(/\uFFFD/g,"")}(e,0)),console.log(e)}console.log(`[clerk debug end: ${e}] (@clerk/nextjs=4.29.7,next=14.1.0)`)}}}},rE=(e,t)=>(...r)=>{let i=("string"==typeof e?rk(e,rA):e)(),n=t(i);try{let e=n(...r);if("object"==typeof e&&"then"in e&&"function"==typeof e.then)return e.then(e=>(i.commit(),e)).catch(e=>{throw i.commit(),e});return i.commit(),e}catch(e){throw i.commit(),e}},rx=({debugLoggerName:e,noAuthStatusMessage:t})=>rE(e,e=>(r,i)=>{"true"===r_(r,eR.Headers.EnableDebug)&&e.enable();let n=rb(r,"AuthToken"),s=rb(r,"AuthStatus"),o=rb(r,"AuthMessage"),a=rb(r,"AuthReason");if(e.debug("Debug",{authReason:a,authMessage:o,authStatus:s,authToken:n}),!s)throw Error(t);let l={apiKey:i?.apiKey||rl,authStatus:s,authMessage:o,secretKey:i?.secretKey||ru,authReason:a,authToken:n,apiUrl:ro,apiVersion:ra};if(e.debug("Options debug",l),s!==ty.SignedIn)return te(l);let u=tD(n);e.debug("JWT debug",u.raw.text);let c=e9(u.payload,{...l,token:u.raw.text});return c&&(c.user&&x(c,"user","Use `clerkClient.users.getUser` instead."),c.organization&&x(c,"organization","Use `clerkClient.organizations.getOrganization` instead."),c.session&&x(c,"session","Use `clerkClient.sessions.getSession` instead.")),c});rx({debugLoggerName:"getAuth()",noAuthStatusMessage:rg("getAuth")});var rC=r(80424);let rP=()=>{try{let{headers:e}=r(7439);return new rC.Z("https://placeholder.com",{headers:e()})}catch(e){if(e&&"message"in e&&"string"==typeof e.message&&e.message.toLowerCase().includes("dynamic server usage"))throw e;throw Error(`Clerk: auth() and currentUser() are only supported in App Router (/app directory).
If you're using /pages, try getAuth() instead.
Original error: ${e}`)}},rT=()=>{let e=rx({debugLoggerName:"auth()",noAuthStatusMessage:rg()})(rP()),{notFound:t,redirect:i}=r(867);return e.protect=(r,n)=>{let s=r?.redirectUrl?void 0:r,o=r?.redirectUrl||n?.redirectUrl,a=()=>{o&&i(o),t()};return e.userId?s?"function"==typeof s?s(e.has)?{...e}:a():e.has(s)?{...e}:a():{...e}:a()},e},rO=function(e){let t={...e},r=e6(t),i=function(e){let{apiClient:t}=e,{apiKey:r="",secretKey:i="",jwtKey:n="",apiUrl:s=eT,apiVersion:o="v1",frontendApi:a="",proxyUrl:l="",publishableKey:u="",isSatellite:c=!1,domain:h="",audience:d="",userAgent:f}=e.options;return{authenticateRequest:({apiKey:e,secretKey:t,audience:f,frontendApi:p,proxyUrl:m,publishableKey:y,jwtKey:g,isSatellite:b,domain:_,searchParams:v,...w})=>rr({...w,apiKey:e||r,secretKey:t||i,audience:f||d,apiUrl:s,apiVersion:o,frontendApi:p||a,proxyUrl:m||l,publishableKey:y||u,isSatellite:b||c,domain:_||h,jwtKey:g||n,searchParams:v}),localInterstitial:({frontendApi:e,publishableKey:t,proxyUrl:r,isSatellite:i,domain:n,...s})=>(function(e){e.frontendApi&&k("frontendApi","Use `publishableKey` instead."),e.pkgVersion&&k("pkgVersion","Use `clerkJSVersion` instead."),e.frontendApi=R(e.publishableKey)?.frontendApi||e.frontendApi||"";let t=ei(e.frontendApi)?"":function(e){let t;if(!e)return"";if(e.match(/^(clerk\.)+\w*$/))t=/(clerk\.)*(?=clerk\.)/;else{if(e.match(/\.clerk.accounts/))return e;t=/^(clerk\.)*/gi}let r=e.replace(t,"");return`clerk.${r}`}(e.domain),{debugData:r,frontendApi:i,pkgVersion:n,clerkJSUrl:s,clerkJSVersion:o,publishableKey:a,proxyUrl:l,isSatellite:u=!1,domain:c,signInUrl:h}=e;return`
    <head>
        <meta charset="UTF-8" />
        <style>
          @media (prefers-color-scheme: dark) {
            body {
              background-color: black;
            }
          }
        </style>
    </head>
    <body>
        <script>
            window.__clerk_frontend_api = '${i}';
            window.__clerk_debug = ${JSON.stringify(r||{})};
            ${l?`window.__clerk_proxy_url = '${l}'`:""}
            ${c?`window.__clerk_domain = '${c}'`:""}
            window.startClerk = async () => {
                function formRedirect(){
                    const form = '<form method="get" action="" name="redirect"></form>';
                    document.body.innerHTML = document.body.innerHTML + form;

                    const searchParams = new URLSearchParams(window.location.search);
                    for (let paramTuple of searchParams) {
                        const input = document.createElement("input");
                        input.type = "hidden";
                        input.name = paramTuple[0];
                        input.value = paramTuple[1];
                        document.forms.redirect.appendChild(input);
                    }
                    const url = new URL(window.location.origin + window.location.pathname + window.location.hash);
                    window.history.pushState({}, '', url);

                    document.forms.redirect.action = window.location.pathname + window.location.hash;
                    document.forms.redirect.submit();
                }

                const Clerk = window.Clerk;
                try {
                    await Clerk.load({
                        isSatellite: ${u},
                        isInterstitial: true,
                        signInUrl: ${h?`'${h}'`:void 0}
                    });
                    if(Clerk.loaded){
                      if(window.location.href.indexOf("#") === -1){
                        window.location.href = window.location.href;
                      } else if (window.navigator.userAgent.toLowerCase().includes("firefox/")){
                          formRedirect();
                      } else {
                          window.location.reload();
                      }
                    }
                } catch (err) {
                    console.error('Clerk: ', err);
                }
            };
            (() => {
                const script = document.createElement('script');
                ${a?`script.setAttribute('data-clerk-publishable-key', '${a}');`:`script.setAttribute('data-clerk-frontend-api', '${i}');`}

                ${c?`script.setAttribute('data-clerk-domain', '${c}');`:""}
                ${l?`script.setAttribute('data-clerk-proxy-url', '${l}')`:""};
                script.async = true;
                script.src = '${s||P(l||t||i,{pkgVersion:n,clerkJSVersion:o})}';
                script.crossOrigin = 'anonymous';
                script.addEventListener('load', startClerk);
                document.body.appendChild(script);
            })();
        </script>
    </body>
`})({...s,frontendApi:e||a,proxyUrl:r||l,publishableKey:t||u,isSatellite:i||c,domain:n||h}),remotePublicInterstitial:({frontendApi:e,publishableKey:t,proxyUrl:r,isSatellite:i,domain:n,userAgent:o,...d})=>to({...d,apiUrl:s,frontendApi:e||a,publishableKey:t||u,proxyUrl:r||l,isSatellite:i||c,domain:n||h,userAgent:o||f}),remotePrivateInterstitial:()=>t.interstitial.getInterstitial(),remotePublicInterstitialUrl:ta,debugRequestState:ri}}({options:t,apiClient:r}),n={...r,...i,__unstable_options:t};return x(n,"__unstable_options","Use `createClerkClient({...})` to create a new clerk instance instead."),n}({apiKey:rl,secretKey:ru,apiUrl:ro,apiVersion:ra,userAgent:"@clerk/nextjs@4.29.7",proxyUrl:rd,domain:rh,isSatellite:rf});async function rB(){let{userId:e}=rT();return e?rO.users.getUser(e):null}let rR=(e,t,r)=>(e.headers.set(t,r),e),{redirectToSignIn:rI,redirectToSignUp:rN}=function({redirectAdapter:e,signUpUrl:t,signInUrl:r,frontendApi:i,publishableKey:n}){i?k("frontendApi","Use `publishableKey` instead."):i=R(n)?.frontendApi;let s=function(e){if(!e)return"";let t=e.replace(/(clerk\.accountsstage\.)/,"accountsstage.").replace(/(clerk\.accounts\.|clerk\.)/,"accounts.");return`https://${t}`}(i);return{redirectToSignUp:({returnBackUrl:r}={})=>{t||s||er.throwMissingPublishableKeyError();let i=`${s}/sign-up`;return e(rs(t||i,r))},redirectToSignIn:({returnBackUrl:t}={})=>{r||s||er.throwMissingPublishableKeyError();let i=`${s}/sign-in`;return e(rs(r||i,t))}}}({redirectAdapter:e=>rR(ry.Z.redirect(e),eR.Headers.ClerkRedirectTo,"true"),signInUrl:rp,signUpUrl:rm,publishableKey:"pk_test_bWFpbi1wbGF0eXB1cy01NC5jbGVyay5hY2NvdW50cy5kZXYk",frontendApi:rc});var rU=Object.defineProperty,rL="@liveblocks/core",rj="1.10.1",rK="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:{};function rD(e){console.error(e)}function rM(e,t,r){let i=Symbol.for(e),n=r?`${t||"dev"} (${r})`:t||"dev";rK[i]?rK[i]===n||rD(`Multiple copies of Liveblocks are being loaded in your project. This will cause issues! See https://liveblocks.io/docs/errors/dupes 

Conflicts:
- ${e} ${rK[i]} (already loaded)
- ${e} ${n} (trying to load this now)`):rK[i]=n,t&&rj&&t!==rj&&rD(`Cross-linked versions of Liveblocks found, which will cause issues! See https://liveblocks.io/docs/errors/cross-linked 

Conflicts:
- ${rL} is at ${rj}
- ${e} is at ${t}

Always upgrade all Liveblocks packages to the same version number.`)}function r$(e,t){throw Error(t)}function rq(e,t="Expected value to be non-nullable"){return e}function rH(){let e=new Set,t=new Set,r=null;function i(e){return t.add(e),()=>t.delete(e)}function n(t){return e.add(t),()=>e.delete(t)}async function s(e){let t;return new Promise(r=>{t=i(t=>{(void 0===e||e(t))&&r(t)})}).finally(()=>t?.())}function o(r){e.forEach(e=>e(r)),e.clear(),t.forEach(e=>e(r))}return{notify:function(e){null!==r?r.push(e):o(e)},subscribe:i,subscribeOnce:n,clear:function(){e.clear(),t.clear()},count:function(){return e.size+t.size},waitUntil:s,pause:function(){r=[]},unpause:function(){if(null!==r){for(let e of r)o(e);r=null}},observable:{subscribe:i,subscribeOnce:n,waitUntil:s}}}((e,t)=>{for(var r in t)rU(e,r,{get:t[r],enumerable:!0})})({},{error:()=>rF,errorWithTitle:()=>rW,warn:()=>rz,warnWithTitle:()=>rV});var rz=console.warn,rF=console.error,rV=console.warn,rW=console.error,rJ=class{constructor(e){this.curr=e}get current(){return this.curr}allowPatching(e){let t=this,r=!0;e({...this.curr,patch(e){if(r)for(let r of(t.curr=Object.assign({},t.curr,e),Object.entries(e))){let[e,t]=r;"patch"!==e&&(this[e]=t)}else throw Error("Can no longer patch stale context")}}),r=!1}},rG=1;function rY(e){return null!==e&&"object"==typeof e&&"[object Object]"===Object.prototype.toString.call(e)}function rX(e){return JSON.parse(JSON.stringify(e))}var rQ=((o=rQ||{})[o.UPDATE_PRESENCE=100]="UPDATE_PRESENCE",o[o.USER_JOINED=101]="USER_JOINED",o[o.USER_LEFT=102]="USER_LEFT",o[o.BROADCASTED_EVENT=103]="BROADCASTED_EVENT",o[o.ROOM_STATE=104]="ROOM_STATE",o[o.INITIAL_STORAGE_STATE=200]="INITIAL_STORAGE_STATE",o[o.UPDATE_STORAGE=201]="UPDATE_STORAGE",o[o.REJECT_STORAGE_OP=299]="REJECT_STORAGE_OP",o[o.UPDATE_YDOC=300]="UPDATE_YDOC",o[o.THREAD_CREATED=400]="THREAD_CREATED",o[o.THREAD_METADATA_UPDATED=401]="THREAD_METADATA_UPDATED",o[o.COMMENT_CREATED=402]="COMMENT_CREATED",o[o.COMMENT_EDITED=403]="COMMENT_EDITED",o[o.COMMENT_DELETED=404]="COMMENT_DELETED",o[o.COMMENT_REACTION_ADDED=405]="COMMENT_REACTION_ADDED",o[o.COMMENT_REACTION_REMOVED=406]="COMMENT_REACTION_REMOVED",o),rZ=((a=rZ||{})[a.CLOSE_NORMAL=1e3]="CLOSE_NORMAL",a[a.CLOSE_ABNORMAL=1006]="CLOSE_ABNORMAL",a[a.UNEXPECTED_CONDITION=1011]="UNEXPECTED_CONDITION",a[a.TRY_AGAIN_LATER=1013]="TRY_AGAIN_LATER",a[a.INVALID_MESSAGE_FORMAT=4e3]="INVALID_MESSAGE_FORMAT",a[a.NOT_ALLOWED=4001]="NOT_ALLOWED",a[a.MAX_NUMBER_OF_MESSAGES_PER_SECONDS=4002]="MAX_NUMBER_OF_MESSAGES_PER_SECONDS",a[a.MAX_NUMBER_OF_CONCURRENT_CONNECTIONS=4003]="MAX_NUMBER_OF_CONCURRENT_CONNECTIONS",a[a.MAX_NUMBER_OF_MESSAGES_PER_DAY_PER_APP=4004]="MAX_NUMBER_OF_MESSAGES_PER_DAY_PER_APP",a[a.MAX_NUMBER_OF_CONCURRENT_CONNECTIONS_PER_ROOM=4005]="MAX_NUMBER_OF_CONCURRENT_CONNECTIONS_PER_ROOM",a[a.KICKED=4100]="KICKED",a[a.TOKEN_EXPIRED=4109]="TOKEN_EXPIRED",a[a.CLOSE_WITHOUT_RETRY=4999]="CLOSE_WITHOUT_RETRY",a),r0=[250,500,1e3,2e3,4e3,8e3,1e4];function r1(e,t){return t.find(t=>t>e)??t[t.length-1]}r0[0];(function(e,t){let r=2===e?rF:1===e?rz:()=>{};()=>{r(t)}})(1,"Connection to WebSocket closed permanently. Won't retry.");function r2(e,...t){return"object"!=typeof e||null===e||Array.isArray(e)?JSON.stringify(e,...t):JSON.stringify(Object.keys(e).sort().reduce((t,r)=>(t[r]=e[r],t),{}),...t)}Symbol(),rH().observable,Date.now();var r8=()=>{},r3=class{constructor(e){this.resolve=r8,this.reject=r8,this.promise=new Promise(r8),this.args=e}};function r4(e){let t=e.editedAt?new Date(e.editedAt):void 0,r=new Date(e.createdAt),i=e.reactions.map(e=>({...e,createdAt:new Date(e.createdAt)}));if(e.body)return{...e,reactions:i,createdAt:r,editedAt:t};{let n=new Date(e.deletedAt);return{...e,reactions:i,createdAt:r,editedAt:t,deletedAt:n}}}function r5(e){let t=e.updatedAt?new Date(e.updatedAt):void 0,r=new Date(e.createdAt),i=e.comments.map(e=>r4(e));return{...e,createdAt:r,updatedAt:t,comments:i}}var r6=ie(0),r7=ie(1),r9=r6+ie(-1);function ie(e){let t=32+(e<0?95+e:e);if(t<32||t>126)throw Error(`Invalid n value: ${e}`);return String.fromCharCode(t)}function it(e,t){return void 0!==e&&void 0!==t?function(e,t){if(e<t)return ir(e,t);if(e>t)return ir(t,e);throw Error("Cannot compute value between two equal positions")}(e,t):void 0!==e?function(e){for(let t=0;t<=e.length-1;t++){let r=e.charCodeAt(t);if(!(r>=126))return e.substring(0,t)+String.fromCharCode(r+1)}return e+r7}(e):void 0!==t?function(e){let t=e.length-1;for(let r=0;r<=t;r++){let i=e.charCodeAt(r);if(!(i<=32)){if(r!==t)return e.substring(0,r+1);if(33===i)return e.substring(0,r)+r9;return e.substring(0,r)+String.fromCharCode(i-1)}}return r7}(t):r7}function ir(e,t){let r=0,i=e.length,n=t.length;for(;;){let o=r<i?e.charCodeAt(r):32,a=r<n?t.charCodeAt(r):126;if(o===a){r++;continue}if(a-o!=1){var s;return((s=r)<e.length?e.substring(0,s):e+r6.repeat(s-e.length))+String.fromCharCode(a+o>>1)}{let t=r+1,i=e.substring(0,t);return i.length<t&&(i+=r6.repeat(t-i.length)),i+ir(e.substring(t),"")}}}function ii(e){return!function(e){if(""===e)return!1;let t=e.length-1,r=e.charCodeAt(t);if(r<33||r>126)return!1;for(let r=0;r<t;r++){let t=e.charCodeAt(r);if(t<32||t>126)return!1}return!0}(e)?function(e){let t=[];for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);t.push(i<32?32:i>126?126:i)}for(;t.length>0&&32===t[t.length-1];)t.length--;return t.length>0?String.fromCharCode(...t):r7}(e):e}var is=((l=is||{})[l.INIT=0]="INIT",l[l.SET_PARENT_KEY=1]="SET_PARENT_KEY",l[l.CREATE_LIST=2]="CREATE_LIST",l[l.UPDATE_OBJECT=3]="UPDATE_OBJECT",l[l.CREATE_OBJECT=4]="CREATE_OBJECT",l[l.DELETE_CRDT=5]="DELETE_CRDT",l[l.DELETE_OBJECT_KEY=6]="DELETE_OBJECT_KEY",l[l.CREATE_MAP=7]="CREATE_MAP",l[l.CREATE_REGISTER=8]="CREATE_REGISTER",l);function io(e,t,r=ii(t)){return Object.freeze({type:"HasParent",node:e,key:t,pos:r})}var ia=Object.freeze({type:"NoParent"}),il=class{constructor(){this._parent=ia}_getParentKeyOrThrow(){switch(this.parent.type){case"HasParent":return this.parent.key;case"NoParent":throw Error("Parent key is missing");case"Orphaned":return this.parent.oldKey;default:return r$(this.parent,"Unknown state")}}get _parentPos(){switch(this.parent.type){case"HasParent":return this.parent.pos;case"NoParent":throw Error("Parent key is missing");case"Orphaned":return this.parent.oldPos;default:return r$(this.parent,"Unknown state")}}get _pool(){return this.__pool}get roomId(){return this.__pool?this.__pool.roomId:null}get _id(){return this.__id}get parent(){return this._parent}get _parentKey(){switch(this.parent.type){case"HasParent":return this.parent.key;case"NoParent":return null;case"Orphaned":return this.parent.oldKey;default:return r$(this.parent,"Unknown state")}}_apply(e,t){return 5===e.type&&"HasParent"===this.parent.type?this.parent.node._detachChild(this):{modified:!1}}_setParentLink(e,t){switch(this.parent.type){case"HasParent":if(this.parent.node!==e)throw Error("Cannot set parent: node already has a parent");this._parent=io(e,t);return;case"Orphaned":case"NoParent":this._parent=io(e,t);return;default:return r$(this.parent,"Unknown state")}}_attach(e,t){if(this.__id||this.__pool)throw Error("Cannot attach node: already attached");t.addNode(e,this),this.__id=e,this.__pool=t}_detach(){switch(this.__pool&&this.__id&&this.__pool.deleteNode(this.__id),this.parent.type){case"HasParent":this._parent=function(e,t=ii(e)){return Object.freeze({type:"Orphaned",oldKey:e,oldPos:t})}(this.parent.key,this.parent.pos);break;case"NoParent":this._parent=ia;break;case"Orphaned":break;default:r$(this.parent,"Unknown state")}this.__pool=void 0}invalidate(){(void 0!==this._cachedImmutable||void 0!==this._cachedTreeNode)&&(this._cachedImmutable=void 0,this._cachedTreeNode=void 0,"HasParent"===this.parent.type&&this.parent.node.invalidate())}toTreeNode(e){return(void 0===this._cachedTreeNode||this._cachedTreeNodeKey!==e)&&(this._cachedTreeNodeKey=e,this._cachedTreeNode=this._toTreeNode(e)),this._cachedTreeNode}toImmutable(){return void 0===this._cachedImmutable&&(this._cachedImmutable=this._toImmutable()),this._cachedImmutable}},iu=((u=iu||{})[u.OBJECT=0]="OBJECT",u[u.LIST=1]="LIST",u[u.MAP=2]="MAP",u[u.REGISTER=3]="REGISTER",u);function ic(e=7){let t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789,./;[]~!@#$%&*()_+=-",r=t.length;return Array.from({length:e},()=>t.charAt(Math.floor(Math.random()*r))).join("")}var ih=class e extends il{constructor(e){super(),this._data=e}get data(){return this._data}static _deserialize([t,r],i,n){let s=new e(r.data);return s._attach(t,n),s}_toOps(e,t,r){if(void 0===this._id)throw Error("Cannot serialize register if parentId or parentKey is undefined");return[{type:8,opId:r?.generateOpId(),id:this._id,parentId:e,parentKey:t,data:this.data}]}_serialize(){if("HasParent"!==this.parent.type)throw Error("Cannot serialize LiveRegister if parent is missing");return{type:3,parentId:rq(this.parent.node._id,"Parent node expected to have ID"),parentKey:this.parent.key,data:this.data}}_attachChild(e){throw Error("Method not implemented.")}_detachChild(e){throw Error("Method not implemented.")}_apply(e,t){return super._apply(e,t)}_toTreeNode(e){return{type:"Json",id:this._id??ic(),key:e,payload:this._data}}_toImmutable(){return this._data}clone(){return rX(this.data)}};function id(e,t){let r=e._parentPos,i=t._parentPos;return r===i?0:r<i?-1:1}var ip=class e extends il{constructor(e=[]){let t;for(let r of(super(),this._items=[],this._implicitlyDeletedItems=new WeakSet,this._unacknowledgedSets=new Map,e)){let e=it(t),i=iB(r);i._setParentLink(this,e),this._items.push(i),t=e}}static _deserialize([t],r,i){let n=new e;n._attach(t,i);let s=r.get(t);if(void 0===s)return n;for(let[e,t]of s){let s=iC([e,t],r,i);s._setParentLink(n,t.parentKey),n._insertAndSort(s)}return n}_toOps(e,t,r){if(void 0===this._id)throw Error("Cannot serialize item is not attached");let i=[],n={id:this._id,opId:r?.generateOpId(),type:2,parentId:e,parentKey:t};for(let e of(i.push(n),this._items)){let t=e._getParentKeyOrThrow(),n=iw(e._toOps(this._id,t,r),void 0),s=n[0].opId;void 0!==s&&this._unacknowledgedSets.set(t,s),i.push(...n)}return i}_insertAndSort(e){this._items.push(e),this._sortItems()}_sortItems(){this._items.sort(id),this.invalidate()}_indexOfPosition(e){return this._items.findIndex(t=>t._getParentKeyOrThrow()===e)}_attach(e,t){for(let r of(super._attach(e,t),this._items))r._attach(t.generateId(),t)}_detach(){for(let e of(super._detach(),this._items))e._detach()}_applySetRemote(e){if(void 0===this._pool)throw Error("Can't attach child if managed pool is not present");let{id:t,parentKey:r}=e,i=iE(e);i._attach(t,this._pool),i._setParentLink(this,r);let n=e.deletedId,s=this._indexOfPosition(r);if(-1!==s){let t=this._items[s];if(t._id===n)return t._detach(),this._items[s]=i,{modified:iy(this,[ig(s,i)]),reverse:[]};{this._implicitlyDeletedItems.add(t),this._items[s]=i;let r=[ig(s,i)],n=this._detachItemAssociatedToSetOperation(e.deletedId);return n&&r.push(n),{modified:iy(this,r),reverse:[]}}}{let t=[],n=this._detachItemAssociatedToSetOperation(e.deletedId);return n&&t.push(n),this._insertAndSort(i),t.push(i_(this._indexOfPosition(r),i)),{reverse:[],modified:iy(this,t)}}}_applySetAck(e){if(void 0===this._pool)throw Error("Can't attach child if managed pool is not present");let t=[],r=this._detachItemAssociatedToSetOperation(e.deletedId);r&&t.push(r);let i=this._unacknowledgedSets.get(e.parentKey);if(void 0!==i){if(i!==e.opId)return 0===t.length?{modified:!1}:{modified:iy(this,t),reverse:[]};this._unacknowledgedSets.delete(e.parentKey)}let n=this._indexOfPosition(e.parentKey),s=this._items.find(t=>t._id===e.id);if(void 0!==s){if(s._parentKey===e.parentKey)return{modified:t.length>0&&iy(this,t),reverse:[]};-1!==n&&(this._implicitlyDeletedItems.add(this._items[n]),this._items.splice(n,1),t.push(ib(n)));let r=this._items.indexOf(s);s._setParentLink(this,e.parentKey),this._sortItems();let i=this._items.indexOf(s);return i!==r&&t.push(iv(r,i,s)),{modified:t.length>0&&iy(this,t),reverse:[]}}{let r=this._pool.getNode(e.id);if(r&&this._implicitlyDeletedItems.has(r)){r._setParentLink(this,e.parentKey),this._implicitlyDeletedItems.delete(r),this._insertAndSort(r);let i=this._items.indexOf(r);return{modified:iy(this,[-1===n?i_(i,r):ig(i,r),...t]),reverse:[]}}{-1!==n&&this._items.splice(n,1);let{newItem:r,newIndex:i}=this._createAttachItemAndSort(e,e.parentKey);return{modified:iy(this,[-1===n?i_(i,r):ig(i,r),...t]),reverse:[]}}}}_detachItemAssociatedToSetOperation(e){if(void 0===e||void 0===this._pool)return null;let t=this._pool.getNode(e);if(void 0===t)return null;let r=this._detachChild(t);return!1===r.modified?null:r.modified.updates[0]}_applyRemoteInsert(e){if(void 0===this._pool)throw Error("Can't attach child if managed pool is not present");let t=ii(e.parentKey),r=this._indexOfPosition(t);-1!==r&&this._shiftItemPosition(r,t);let{newItem:i,newIndex:n}=this._createAttachItemAndSort(e,t);return{modified:iy(this,[i_(n,i)]),reverse:[]}}_applyInsertAck(e){let t=this._items.find(t=>t._id===e.id),r=ii(e.parentKey),i=this._indexOfPosition(r);if(t){if(t._parentKey===r)return{modified:!1};{let e=this._items.indexOf(t);-1!==i&&this._shiftItemPosition(i,r),t._setParentLink(this,r),this._sortItems();let n=this._indexOfPosition(r);return n===e?{modified:!1}:{modified:iy(this,[iv(e,n,t)]),reverse:[]}}}{let t=rq(this._pool).getNode(e.id);if(t&&this._implicitlyDeletedItems.has(t))return t._setParentLink(this,r),this._implicitlyDeletedItems.delete(t),this._insertAndSort(t),{modified:iy(this,[i_(this._indexOfPosition(r),t)]),reverse:[]};{-1!==i&&this._shiftItemPosition(i,r);let{newItem:t,newIndex:n}=this._createAttachItemAndSort(e,r);return{modified:iy(this,[i_(n,t)]),reverse:[]}}}}_applyInsertUndoRedo(e){let{id:t,parentKey:r}=e,i=iE(e);if(this._pool?.getNode(t)!==void 0)return{modified:!1};i._attach(t,rq(this._pool)),i._setParentLink(this,r);let n=this._indexOfPosition(r),s=r;return -1!==n&&(s=it(this._items[n]?._parentPos,this._items[n+1]?._parentPos),i._setParentLink(this,s)),this._insertAndSort(i),{modified:iy(this,[i_(this._indexOfPosition(s),i)]),reverse:[{type:5,id:t}]}}_applySetUndoRedo(e){let{id:t,parentKey:r}=e,i=iE(e);if(this._pool?.getNode(t)!==void 0)return{modified:!1};this._unacknowledgedSets.set(r,rq(e.opId));let n=this._indexOfPosition(r);if(i._attach(t,rq(this._pool)),i._setParentLink(this,r),-1===n)return this._insertAndSort(i),this._detachItemAssociatedToSetOperation(e.deletedId),{reverse:[{type:5,id:t}],modified:iy(this,[i_(this._indexOfPosition(r),i)])};{let t=this._items[n];t._detach(),this._items[n]=i;let s=iw(t._toOps(rq(this._id),r,this._pool),e.id),o=[ig(n,i)],a=this._detachItemAssociatedToSetOperation(e.deletedId);return a&&o.push(a),{modified:iy(this,o),reverse:s}}}_attachChild(e,t){let r;if(void 0===this._pool)throw Error("Can't attach child if managed pool is not present");return!1!==(r="set"===e.intent?1===t?this._applySetRemote(e):2===t?this._applySetAck(e):this._applySetUndoRedo(e):1===t?this._applyRemoteInsert(e):2===t?this._applyInsertAck(e):this._applyInsertUndoRedo(e)).modified&&this.invalidate(),r}_detachChild(e){if(e){let t=rq(e._parentKey),r=e._toOps(rq(this._id),t,this._pool),i=this._items.indexOf(e);return -1===i?{modified:!1}:(this._items.splice(i,1),this.invalidate(),e._detach(),{modified:iy(this,[ib(i)]),reverse:r})}return{modified:!1}}_applySetChildKeyRemote(e,t){if(this._implicitlyDeletedItems.has(t))return this._implicitlyDeletedItems.delete(t),t._setParentLink(this,e),this._insertAndSort(t),{modified:iy(this,[i_(this._items.indexOf(t),t)]),reverse:[]};if(e===t._parentKey)return{modified:!1};let r=this._indexOfPosition(e);if(-1===r){let r=this._items.indexOf(t);t._setParentLink(this,e),this._sortItems();let i=this._items.indexOf(t);return i===r?{modified:!1}:{modified:iy(this,[iv(r,i,t)]),reverse:[]}}{this._items[r]._setParentLink(this,it(e,this._items[r+1]?._parentPos));let i=this._items.indexOf(t);t._setParentLink(this,e),this._sortItems();let n=this._items.indexOf(t);return n===i?{modified:!1}:{modified:iy(this,[iv(i,n,t)]),reverse:[]}}}_applySetChildKeyAck(e,t){let r=rq(t._parentKey);if(this._implicitlyDeletedItems.has(t)){let r=this._indexOfPosition(e);return this._implicitlyDeletedItems.delete(t),-1!==r&&this._items[r]._setParentLink(this,it(e,this._items[r+1]?._parentPos)),t._setParentLink(this,e),this._insertAndSort(t),{modified:!1}}{if(e===r)return{modified:!1};let i=this._items.indexOf(t),n=this._indexOfPosition(e);-1!==n&&this._items[n]._setParentLink(this,it(e,this._items[n+1]?._parentPos)),t._setParentLink(this,e),this._sortItems();let s=this._items.indexOf(t);return i===s?{modified:!1}:{modified:iy(this,[iv(i,s,t)]),reverse:[]}}}_applySetChildKeyUndoRedo(e,t){let r=rq(t._parentKey),i=this._items.indexOf(t),n=this._indexOfPosition(e);-1!==n&&this._items[n]._setParentLink(this,it(e,this._items[n+1]?._parentPos)),t._setParentLink(this,e),this._sortItems();let s=this._items.indexOf(t);return i===s?{modified:!1}:{modified:iy(this,[iv(i,s,t)]),reverse:[{type:1,id:rq(t._id),parentKey:r}]}}_setChildKey(e,t,r){return 1===r?this._applySetChildKeyRemote(e,t):2===r?this._applySetChildKeyAck(e,t):this._applySetChildKeyUndoRedo(e,t)}_apply(e,t){return super._apply(e,t)}_serialize(){if("HasParent"!==this.parent.type)throw Error("Cannot serialize LiveList if parent is missing");return{type:1,parentId:rq(this.parent.node._id,"Parent node expected to have ID"),parentKey:this.parent.key}}get length(){return this._items.length}push(e){return this._pool?.assertStorageIsWritable(),this.insert(e,this.length)}insert(e,t){if(this._pool?.assertStorageIsWritable(),t<0||t>this._items.length)throw Error(`Cannot insert list item at index "${t}". index should be between 0 and ${this._items.length}`);let r=it(this._items[t-1]?this._items[t-1]._parentPos:void 0,this._items[t]?this._items[t]._parentPos:void 0),i=iB(e);if(i._setParentLink(this,r),this._insertAndSort(i),this._pool&&this._id){let e=this._pool.generateId();i._attach(e,this._pool),this._pool.dispatch(i._toOps(this._id,r,this._pool),[{type:5,id:e}],new Map([[this._id,iy(this,[i_(t,i)])]]))}}move(e,t){if(this._pool?.assertStorageIsWritable(),t<0)throw Error("targetIndex cannot be less than 0");if(t>=this._items.length)throw Error("targetIndex cannot be greater or equal than the list length");if(e<0)throw Error("index cannot be less than 0");if(e>=this._items.length)throw Error("index cannot be greater or equal than the list length");let r=null,i=null;e<t?(i=t===this._items.length-1?void 0:this._items[t+1]._parentPos,r=this._items[t]._parentPos):(i=this._items[t]._parentPos,r=0===t?void 0:this._items[t-1]._parentPos);let n=it(r,i),s=this._items[e],o=s._getParentKeyOrThrow();if(s._setParentLink(this,n),this._sortItems(),this._pool&&this._id){let r=new Map([[this._id,iy(this,[iv(e,t,s)])]]);this._pool.dispatch([{type:1,id:rq(s._id),opId:this._pool.generateOpId(),parentKey:n}],[{type:1,id:rq(s._id),parentKey:o}],r)}}delete(e){if(this._pool?.assertStorageIsWritable(),e<0||e>=this._items.length)throw Error(`Cannot delete list item at index "${e}". index should be between 0 and ${this._items.length-1}`);let t=this._items[e];if(t._detach(),this._items.splice(e,1),this.invalidate(),this._pool){let r=t._id;if(r){let i=new Map;i.set(rq(this._id),iy(this,[ib(e)])),this._pool.dispatch([{id:r,opId:this._pool.generateOpId(),type:5}],t._toOps(rq(this._id),t._getParentKeyOrThrow()),i)}}}clear(){if(this._pool?.assertStorageIsWritable(),this._pool){let e=[],t=[],r=[];for(let i of this._items){i._detach();let n=i._id;n&&(e.push({type:5,id:n,opId:this._pool.generateOpId()}),t.push(...i._toOps(rq(this._id),i._getParentKeyOrThrow())),r.push(ib(0)))}this._items=[],this.invalidate();let i=new Map;i.set(rq(this._id),iy(this,r)),this._pool.dispatch(e,t,i)}else{for(let e of this._items)e._detach();this._items=[],this.invalidate()}}set(e,t){if(this._pool?.assertStorageIsWritable(),e<0||e>=this._items.length)throw Error(`Cannot set list item at index "${e}". index should be between 0 and ${this._items.length-1}`);let r=this._items[e],i=r._getParentKeyOrThrow(),n=r._id;r._detach();let s=iB(t);if(s._setParentLink(this,i),this._items[e]=s,this.invalidate(),this._pool&&this._id){let t=this._pool.generateId();s._attach(t,this._pool);let o=new Map;o.set(this._id,iy(this,[ig(e,s)]));let a=iw(s._toOps(this._id,i,this._pool),n);this._unacknowledgedSets.set(i,rq(a[0].opId));let l=iw(r._toOps(this._id,i,void 0),t);this._pool.dispatch(a,l,o)}}toArray(){return this._items.map(e=>iO(e))}every(e){return this.toArray().every(e)}filter(e){return this.toArray().filter(e)}find(e){return this.toArray().find(e)}findIndex(e){return this.toArray().findIndex(e)}forEach(e){return this.toArray().forEach(e)}get(e){if(!(e<0)&&!(e>=this._items.length))return iO(this._items[e])}indexOf(e,t){return this.toArray().indexOf(e,t)}lastIndexOf(e,t){return this.toArray().lastIndexOf(e,t)}map(e){return this._items.map((t,r)=>e(iO(t),r))}some(e){return this.toArray().some(e)}[Symbol.iterator](){return new im(this._items)}_createAttachItemAndSort(e,t){let r=iE(e);return r._attach(e.id,rq(this._pool)),r._setParentLink(this,t),this._insertAndSort(r),{newItem:r,newIndex:this._indexOfPosition(t)}}_shiftItemPosition(e,t){let r=it(t,this._items.length>e+1?this._items[e+1]?._parentPos:void 0);this._items[e]._setParentLink(this,r)}_toTreeNode(e){return{type:"LiveList",id:this._id??ic(),key:e,payload:this._items.map((e,t)=>e.toTreeNode(t.toString()))}}toImmutable(){return super.toImmutable()}_toImmutable(){return this._items.map(e=>e.toImmutable())}clone(){return new e(this._items.map(e=>e.clone()))}},im=class{constructor(e){this._innerIterator=e[Symbol.iterator]()}[Symbol.iterator](){return this}next(){let e=this._innerIterator.next();return e.done?{done:!0,value:void 0}:{value:iO(e.value)}}};function iy(e,t){return{node:e,type:"LiveList",updates:t}}function ig(e,t){return{index:e,type:"set",item:t instanceof ih?t.data:t}}function ib(e){return{index:e,type:"delete"}}function i_(e,t){return{index:e,type:"insert",item:t instanceof ih?t.data:t}}function iv(e,t,r){return{index:t,type:"move",previousIndex:e,item:r instanceof ih?r.data:r}}function iw(e,t){return e.map((e,r)=>0===r?{...e,intent:"set",deletedId:t}:e)}var iS=e=>e,iA=class e extends il{constructor(e){if(super(),this.unacknowledgedSet=new Map,e){let t=[];for(let[r,i]of e){let e=iB(i);e._setParentLink(this,r),t.push([r,e])}this._map=new Map(t)}else this._map=new Map}_toOps(e,t,r){if(void 0===this._id)throw Error("Cannot serialize item is not attached");let i=[],n={id:this._id,opId:r?.generateOpId(),type:7,parentId:e,parentKey:t};for(let[e,t]of(i.push(n),this._map))i.push(...t._toOps(this._id,e,r));return i}static _deserialize([t,r],i,n){let s=new e;s._attach(t,n);let o=i.get(t);if(void 0===o)return s;for(let[e,t]of o){let r=iC([e,t],i,n);r._setParentLink(s,t.parentKey),s._map.set(t.parentKey,r),s.invalidate()}return s}_attach(e,t){for(let[r,i]of(super._attach(e,t),this._map))iT(i)&&i._attach(t.generateId(),t)}_attachChild(e,t){let r;if(void 0===this._pool)throw Error("Can't attach child if managed pool is not present");let{id:i,parentKey:n,opId:s}=e,o=iE(e);if(void 0!==this._pool.getNode(i))return{modified:!1};if(2===t){let e=this.unacknowledgedSet.get(n);if(e===s)return this.unacknowledgedSet.delete(n),{modified:!1};if(void 0!==e)return{modified:!1}}else 1===t&&this.unacknowledgedSet.delete(n);let a=this._map.get(n);if(a){let e=rq(this._id);r=a._toOps(e,n),a._detach()}else r=[{type:5,id:i}];return o._setParentLink(this,n),o._attach(i,this._pool),this._map.set(n,o),this.invalidate(),{modified:{node:this,type:"LiveMap",updates:{[n]:{type:"update"}}},reverse:r}}_detach(){for(let e of(super._detach(),this._map.values()))e._detach()}_detachChild(e){let t=rq(this._id),r=rq(e._parentKey),i=e._toOps(t,r,this._pool);for(let[t,r]of this._map)r===e&&(this._map.delete(t),this.invalidate());return e._detach(),{modified:{node:this,type:"LiveMap",updates:{[r]:{type:"delete"}}},reverse:i}}_serialize(){if("HasParent"!==this.parent.type)throw Error("Cannot serialize LiveMap if parent is missing");return{type:2,parentId:rq(this.parent.node._id,"Parent node expected to have ID"),parentKey:this.parent.key}}get(e){let t=this._map.get(e);if(void 0!==t)return iO(t)}set(e,t){this._pool?.assertStorageIsWritable();let r=this._map.get(e);r&&r._detach();let i=iB(t);if(i._setParentLink(this,e),this._map.set(e,i),this.invalidate(),this._pool&&this._id){let t=this._pool.generateId();i._attach(t,this._pool);let n=new Map;n.set(this._id,{node:this,type:"LiveMap",updates:{[e]:{type:"update"}}});let s=i._toOps(this._id,e,this._pool);this.unacknowledgedSet.set(e,rq(s[0].opId)),this._pool.dispatch(i._toOps(this._id,e,this._pool),r?r._toOps(this._id,e):[{type:5,id:t}],n)}}get size(){return this._map.size}has(e){return this._map.has(e)}delete(e){this._pool?.assertStorageIsWritable();let t=this._map.get(e);if(void 0===t)return!1;if(t._detach(),this._map.delete(e),this.invalidate(),this._pool&&t._id){let r=rq(this._id),i=new Map;i.set(r,{node:this,type:"LiveMap",updates:{[e]:{type:"delete"}}}),this._pool.dispatch([{type:5,id:t._id,opId:this._pool.generateOpId()}],t._toOps(r,e),i)}return!0}entries(){let e=this._map.entries();return{[Symbol.iterator](){return this},next(){let t=e.next();return t.done?{done:!0,value:void 0}:{value:[t.value[0],iO(t.value[1])]}}}}[Symbol.iterator](){return this.entries()}keys(){return this._map.keys()}values(){let e=this._map.values();return{[Symbol.iterator](){return this},next(){let t=e.next();return t.done?{done:!0,value:void 0}:{value:iO(t.value)}}}}forEach(e){for(let t of this)e(t[1],t[0],this)}_toTreeNode(e){return{type:"LiveMap",id:this._id??ic(),key:e,payload:Array.from(this._map.entries()).map(([e,t])=>t.toTreeNode(e))}}toImmutable(){return super.toImmutable()}_toImmutable(){let e=new Map;for(let[t,r]of this._map)e.set(t,r.toImmutable());return iS(e)}clone(){return new e(Array.from(this._map).map(([e,t])=>[e,t.clone()]))}},ik=class e extends il{constructor(e={}){for(let t in super(),this._propToLastUpdate=new Map,e){let r=e[t];void 0!==r&&iT(r)&&r._setParentLink(this,t)}this._map=new Map(Object.entries(e))}static _buildRootAndParentToChildren(e){let t=new Map,r=null;for(let[i,n]of e)if(0!==n.type||void 0!==n.parentId&&void 0!==n.parentKey){let e=[i,n],r=t.get(n.parentId);void 0!==r?r.push(e):t.set(n.parentId,[e])}else r=[i,n];if(null===r)throw Error("Root can't be null");return[r,t]}static _fromItems(t,r){let[i,n]=e._buildRootAndParentToChildren(t);return e._deserialize(i,n,r)}_toOps(e,t,r){if(void 0===this._id)throw Error("Cannot serialize item is not attached");let i=r?.generateOpId(),n=[],s={type:4,id:this._id,opId:i,parentId:e,parentKey:t,data:{}};for(let[e,t]of(n.push(s),this._map))iT(t)?n.push(...t._toOps(this._id,e,r)):s.data[e]=t;return n}static _deserialize([t,r],i,n){let s=new e(r.data);return s._attach(t,n),this._deserializeChildren(s,i,n)}static _deserializeChildren(e,t,r){let i=t.get(rq(e._id));if(void 0===i)return e;for(let[n,s]of i){let i=function([e,t],r,i){switch(t.type){case 0:return ik._deserialize([e,t],r,i);case 1:return ip._deserialize([e,t],r,i);case 2:return iA._deserialize([e,t],r,i);case 3:return t.data;default:throw Error("Unexpected CRDT type")}}([n,s],t,r);iP(i)&&i._setParentLink(e,s.parentKey),e._map.set(s.parentKey,i),e.invalidate()}return e}_attach(e,t){for(let[r,i]of(super._attach(e,t),this._map))iT(i)&&i._attach(t.generateId(),t)}_attachChild(e,t){let r;if(void 0===this._pool)throw Error("Can't attach child if managed pool is not present");let{id:i,opId:n,parentKey:s}=e,o=ix(e);if(void 0!==this._pool.getNode(i))return this._propToLastUpdate.get(s)===n&&this._propToLastUpdate.delete(s),{modified:!1};if(0===t)this._propToLastUpdate.set(s,rq(n));else if(void 0===this._propToLastUpdate.get(s));else if(this._propToLastUpdate.get(s)===n)return this._propToLastUpdate.delete(s),{modified:!1};else return{modified:!1};let a=rq(this._id),l=this._map.get(s);return iT(l)?(r=l._toOps(a,s),l._detach()):r=void 0===l?[{type:6,id:a,key:s}]:[{type:3,id:a,data:{[s]:l}}],this._map.set(s,o),this.invalidate(),iP(o)&&(o._setParentLink(this,s),o._attach(i,this._pool)),{reverse:r,modified:{node:this,type:"LiveObject",updates:{[s]:{type:"update"}}}}}_detachChild(e){if(e){let t=rq(this._id),r=rq(e._parentKey),i=e._toOps(t,r,this._pool);for(let[t,r]of this._map)r===e&&(this._map.delete(t),this.invalidate());return e._detach(),{modified:{node:this,type:"LiveObject",updates:{[r]:{type:"delete"}}},reverse:i}}return{modified:!1}}_detach(){for(let e of(super._detach(),this._map.values()))iT(e)&&e._detach()}_apply(e,t){return 3===e.type?this._applyUpdate(e,t):6===e.type?this._applyDeleteObjectKey(e,t):super._apply(e,t)}_serialize(){let e={};for(let[t,r]of this._map)iT(r)||(e[t]=r);return"HasParent"===this.parent.type&&this.parent.node._id?{type:0,parentId:this.parent.node._id,parentKey:this.parent.key,data:e}:{type:0,data:e}}_applyUpdate(e,t){let r=!1,i=rq(this._id),n=[],s={type:3,id:i,data:{}};for(let t in e.data){let e=this._map.get(t);iT(e)?(n.push(...e._toOps(i,t)),e._detach()):void 0!==e?s.data[t]=e:void 0===e&&n.push({type:6,id:i,key:t})}let o={};for(let i in e.data){let n=e.data[i];if(void 0===n)continue;if(t)this._propToLastUpdate.set(i,rq(e.opId));else if(void 0===this._propToLastUpdate.get(i))r=!0;else{if(this._propToLastUpdate.get(i)!==e.opId)continue;this._propToLastUpdate.delete(i);continue}let s=this._map.get(i);iT(s)&&s._detach(),r=!0,o[i]={type:"update"},this._map.set(i,n),this.invalidate()}return 0!==Object.keys(s.data).length&&n.unshift(s),r?{modified:{node:this,type:"LiveObject",updates:o},reverse:n}:{modified:!1}}_applyDeleteObjectKey(e,t){let r=e.key;if(!1===this._map.has(r)||!t&&void 0!==this._propToLastUpdate.get(r))return{modified:!1};let i=this._map.get(r),n=rq(this._id),s=[];return iT(i)?(s=i._toOps(n,e.key),i._detach()):void 0!==i&&(s=[{type:3,id:n,data:{[r]:i}}]),this._map.delete(r),this.invalidate(),{modified:{node:this,type:"LiveObject",updates:{[e.key]:{type:"delete"}}},reverse:s}}toObject(){return Object.fromEntries(this._map)}set(e,t){this._pool?.assertStorageIsWritable(),this.update({[e]:t})}get(e){return this._map.get(e)}delete(e){let t;this._pool?.assertStorageIsWritable();let r=this._map.get(e);if(void 0===r)return;if(void 0===this._pool||void 0===this._id){iT(r)&&r._detach(),this._map.delete(e),this.invalidate();return}iT(r)?(r._detach(),t=r._toOps(this._id,e)):t=[{type:3,data:{[e]:r},id:this._id}],this._map.delete(e),this.invalidate();let i=new Map;i.set(this._id,{node:this,type:"LiveObject",updates:{[e]:{type:"delete"}}}),this._pool.dispatch([{type:6,key:e,id:this._id,opId:this._pool.generateOpId()}],t,i)}update(e){if(this._pool?.assertStorageIsWritable(),void 0===this._pool||void 0===this._id){for(let t in e){let r=e[t];if(void 0===r)continue;let i=this._map.get(t);iT(i)&&i._detach(),iT(r)&&r._setParentLink(this,t),this._map.set(t,r),this.invalidate()}return}let t=[],r=[],i=this._pool.generateOpId(),n={},s={id:this._id,type:3,data:{}},o={};for(let a in e){let l=e[a];if(void 0===l)continue;let u=this._map.get(a);if(iT(u)?(r.push(...u._toOps(this._id,a)),u._detach()):void 0===u?r.push({type:6,id:this._id,key:a}):s.data[a]=u,iT(l)){l._setParentLink(this,a),l._attach(this._pool.generateId(),this._pool);let e=l._toOps(this._id,a,this._pool),r=e.find(e=>e.parentId===this._id);r&&this._propToLastUpdate.set(a,rq(r.opId)),t.push(...e)}else n[a]=l,this._propToLastUpdate.set(a,i);this._map.set(a,l),this.invalidate(),o[a]={type:"update"}}0!==Object.keys(s.data).length&&r.unshift(s),0!==Object.keys(n).length&&t.unshift({opId:i,id:this._id,type:3,data:n});let a=new Map;a.set(this._id,{node:this,type:"LiveObject",updates:o}),this._pool.dispatch(t,r,a)}toImmutable(){return super.toImmutable()}toTreeNode(e){return super.toTreeNode(e)}_toTreeNode(e){let t=this._id??ic();return{type:"LiveObject",id:t,key:e,payload:Array.from(this._map.entries()).map(([e,r])=>iT(r)?r.toTreeNode(e):{type:"Json",id:`${t}:${e}`,key:e,payload:r})}}_toImmutable(){let e={};for(let[t,r]of this._map)e[t]=iP(r)?r.toImmutable():r;return e}clone(){return new e(Object.fromEntries(Array.from(this._map).map(([e,t])=>[e,iP(t)?t.clone():rX(t)])))}};function iE(e){return iB(ix(e))}function ix(e){switch(e.type){case 8:return e.data;case 4:return new ik(e.data);case 7:return new iA;case 2:return new ip;default:return r$(e,"Unknown creation Op")}}function iC([e,t],r,i){switch(t.type){case 0:return ik._deserialize([e,t],r,i);case 1:return ip._deserialize([e,t],r,i);case 2:return iA._deserialize([e,t],r,i);case 3:return ih._deserialize([e,t],r,i);default:throw Error("Unexpected CRDT type")}}function iP(e){return function(e){return e instanceof ip}(e)||e instanceof iA||function(e){return e instanceof ik}(e)}function iT(e){return iP(e)||e instanceof ih}function iO(e){return e instanceof ih?e.data:e instanceof ip||e instanceof iA||e instanceof ik?e:r$(e,"Unknown AbstractCrdt")}function iB(e){return e instanceof ik||e instanceof iA||e instanceof ip?e:new ih(e)}var iR=((c=iR||{})[c.UPDATE_PRESENCE=100]="UPDATE_PRESENCE",c[c.BROADCAST_EVENT=103]="BROADCAST_EVENT",c[c.FETCH_STORAGE=200]="FETCH_STORAGE",c[c.UPDATE_STORAGE=201]="UPDATE_STORAGE",c[c.FETCH_YDOC=300]="FETCH_YDOC",c[c.UPDATE_YDOC=301]="UPDATE_YDOC",c),iI={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},iN=RegExp(Object.keys(iI).map(e=>`\\${e}`).join("|"),"g"),iU=class{constructor(e,t){this._strings=e,this._values=t}toString(){return this._strings.reduce((e,t,r)=>{var i;return e+((i=rq(this._values[r-1]))instanceof iU?i.toString():Array.isArray(i)?(i.length<=0?new iU([""],[]):new iU(["",...Array(i.length-1).fill(""),""],i)).toString():String(i).replace(iN,e=>iI[e]))+t})}},iL={_:"\\_","*":"\\*","#":"\\#","`":"\\`","~":"\\~","!":"\\!","|":"\\|","(":"\\(",")":"\\)","{":"\\{","}":"\\}","[":"\\[","]":"\\]"},ij=RegExp(Object.keys(iL).map(e=>`\\${e}`).join("|"),"g"),iK=class{constructor(e,t){this._strings=e,this._values=t}toString(){return this._strings.reduce((e,t,r)=>{var i;return e+((i=rq(this._values[r-1]))instanceof iK?i.toString():Array.isArray(i)?(i.length<=0?new iK([""],[]):new iK(["",...Array(i.length-1).fill(""),""],i)).toString():String(i).replace(ij,e=>iL[e]))+t})}};function iD(e){let t={};for(let r in e){let i=e[r];void 0!==i&&(t[r]=function e(t){return t instanceof ik?iD(t.toObject()):t instanceof ip?t.toArray().map(e):t instanceof iA?function(t){let r={};for(let[i,n]of t.entries())r[i]=e(n);return r}(t):t instanceof ih?t.data:Array.isArray(t)?t.map(e):rY(t)?iD(t):t}(i))}return t}function iM(e){if(Array.isArray(e))return new ip(e.map(iM));if(!rY(e))return e;{let t={};for(let r in e){let i=e[r];void 0!==i&&(t[r]=iM(i))}return new ik(t)}}async function i$(){return void 0!==globalThis.fetch?globalThis.fetch:(await r.e(319).then(r.bind(r,319))).default}function iq(e){return"string"==typeof e&&e.length>0}function iH(e,t){if(!iq(e))throw Error(`Invalid value for field "${t}". Please provide a non-empty string. For more information: https://liveblocks.io/docs/api-reference/liveblocks-node#authorize`)}function iz(e){return e>=200&&e<300?200:e>=500?503:403}function iF(e,t,r){let i=new URL(t,e);return void 0!==r&&(i.search=(r instanceof URLSearchParams?r:function(e){let t=new URLSearchParams;for(let[r,i]of Object.entries(e))null!=i&&t.set(r,i.toString());return t}(r)).toString()),i.toString()}function iV(e,...t){return e.reduce((e,r,i)=>e+encodeURIComponent(t[i-1]??"")+r)}rM(rL,rj,"esm"),r(32979),r(40799);var iW=Object.freeze(["room:write","room:read","room:presence:write","comments:write","comments:read"]),iJ=Object.freeze(["room:read","room:presence:write","comments:read"]),iG=Object.freeze(["room:write","comments:write"]),iY=/^([*]|[^*]{1,128}[*]?)$/,iX=class{constructor(e,t,r){this.FULL_ACCESS=iG,this.READ_ACCESS=iJ,this._sealed=!1,this._permissions=new Map,iH(t,"userId"),this._postFn=e,this._userId=t,this._userInfo=r}getOrCreate(e){if(this._sealed)throw Error("You can no longer change these permissions.");let t=this._permissions.get(e);if(t)return t;if(this._permissions.size>=10)throw Error("You cannot add permissions for more than 10 rooms in a single token");return t=new Set,this._permissions.set(e,t),t}allow(e,t){if("string"!=typeof e)throw Error("Room name or pattern must be a string");if(!iY.test(e))throw Error("Invalid room name or pattern");if(0===t.length)throw Error("Permission list cannot be empty");let r=this.getOrCreate(e);for(let e of t){if(!iW.includes(e))throw Error(`Not a valid permission: ${e}`);r.add(e)}return this}hasPermissions(){return this._permissions.size>0}seal(){if(this._sealed)throw Error("You cannot reuse Session instances. Please create a new session every time.");this._sealed=!0}serializePermissions(){return Object.fromEntries(Array.from(this._permissions.entries()).map(([e,t])=>[e,Array.from(t)]))}async authorize(){this.seal(),this.hasPermissions()||console.warn("Access tokens without any permission will not be supported soon, you should use wildcards when the client requests a token for resources outside a room. See https://liveblocks.io/docs/errors/liveblocks-client/access-tokens-not-enough-permissions");try{let e=await this._postFn(iV`/v2/authorize-user`,{userId:this._userId,permissions:this.serializePermissions(),userInfo:this._userInfo});return{status:iz(e.status),body:await e.text()}}catch(e){return{status:503,body:'Call to /v2/authorize-user failed. See "error" for more information.',error:e}}}},iQ=class{constructor(e){let t=e.secret;(function(e,t){if(!iq(e)||!e.startsWith("sk_"))throw Error(`Invalid value for field "${t}". Secret keys must start with "sk_". Please provide the secret key from your Liveblocks dashboard at https://liveblocks.io/dashboard/apikeys.`)})(t,"secret"),this._secret=t,this._baseUrl=new URL(function(e){return(e||(e=process.env.LIVEBLOCKS_BASE_URL||process.env.NEXT_PUBLIC_LIVEBLOCKS_BASE_URL||process.env.VITE_LIVEBLOCKS_BASE_URL||void 0),"string"==typeof e&&e.startsWith("http"))?e:"https://api.liveblocks.io"}(e.baseUrl))}async post(e,t){let r=iF(this._baseUrl,e),i={Authorization:`Bearer ${this._secret}`,"Content-Type":"application/json"},n=await i$();return await n(r,{method:"POST",headers:i,body:JSON.stringify(t)})}async put(e,t){let r=iF(this._baseUrl,e),i={Authorization:`Bearer ${this._secret}`,"Content-Type":"application/json"},n=await i$();return await n(r,{method:"PUT",headers:i,body:JSON.stringify(t)})}async putBinary(e,t){let r=iF(this._baseUrl,e),i={Authorization:`Bearer ${this._secret}`,"Content-Type":"application/octet-stream"},n=await i$();return await n(r,{method:"PUT",headers:i,body:t})}async delete(e){let t=iF(this._baseUrl,e),r={Authorization:`Bearer ${this._secret}`},i=await i$();return await i(t,{method:"DELETE",headers:r})}async get(e,t){let r=iF(this._baseUrl,e,t),i={Authorization:`Bearer ${this._secret}`},n=await i$();return await n(r,{method:"GET",headers:i})}prepareSession(e,t){return new iX(this.post.bind(this),e,t?.userInfo)}async identifyUser(e,t){let r=iV`/v2/identify-user`,i="string"==typeof e?e:e.userId,n="string"==typeof e?void 0:e.groupIds;iH(i,"userId");try{let e=await this.post(r,{userId:i,groupIds:n,userInfo:t?.userInfo});return{status:iz(e.status),body:await e.text()}}catch(e){return{status:503,body:`Call to ${iF(this._baseUrl,r)} failed. See "error" for more information.`,error:e}}}async getRooms(e={}){let t=iV`/v2/rooms`,r={limit:e.limit,startingAfter:e.startingAfter,userId:e.userId,groupIds:e.groupIds?e.groupIds.join(","):void 0,...Object.fromEntries(Object.entries(e.metadata??{}).map(([e,t])=>[`metadata.${e}`,Array.isArray(t)?t.join(","):t]))},i=await this.get(t,r);if(!i.ok){let e=await i.text();throw new iZ(i.status,e)}let n=await i.json(),s=n.data.map(e=>{let t=e.lastConnectionAt?new Date(e.lastConnectionAt):void 0,r=new Date(e.createdAt);return{...e,createdAt:r,lastConnectionAt:t}});return{...n,data:s}}async createRoom(e,t){let{defaultAccesses:r,groupsAccesses:i,usersAccesses:n,metadata:s}=t,o=await this.post(iV`/v2/rooms`,{id:e,defaultAccesses:r,groupsAccesses:i,usersAccesses:n,metadata:s});if(!o.ok){let e=await o.text();throw new iZ(o.status,e)}let a=await o.json(),l=a.lastConnectionAt?new Date(a.lastConnectionAt):void 0,u=new Date(a.createdAt);return{...a,lastConnectionAt:l,createdAt:u}}async getRoom(e){let t=await this.get(iV`/v2/rooms/${e}`);if(!t.ok){let e=await t.text();throw new iZ(t.status,e)}let r=await t.json(),i=r.lastConnectionAt?new Date(r.lastConnectionAt):void 0,n=new Date(r.createdAt);return{...r,createdAt:n,lastConnectionAt:i}}async updateRoom(e,t){let{defaultAccesses:r,groupsAccesses:i,usersAccesses:n,metadata:s}=t,o=await this.post(iV`/v2/rooms/${e}`,{defaultAccesses:r,groupsAccesses:i,usersAccesses:n,metadata:s});if(!o.ok){let e=await o.text();throw new iZ(o.status,e)}let a=await o.json(),l=a.lastConnectionAt?new Date(a.lastConnectionAt):void 0,u=new Date(a.createdAt);return{...a,lastConnectionAt:l,createdAt:u}}async deleteRoom(e){let t=await this.delete(iV`/v2/rooms/${e}`);if(!t.ok){let e=await t.text();throw new iZ(t.status,e)}}async getActiveUsers(e){let t=await this.get(iV`/v2/rooms/${e}/active_users`);if(!t.ok){let e=await t.text();throw new iZ(t.status,e)}return await t.json()}async broadcastEvent(e,t){let r=await this.post(iV`/v2/rooms/${e}/broadcast_event`,t);if(!r.ok){let e=await r.text();throw new iZ(r.status,e)}}async getStorageDocument(e,t="plain-lson"){let r=await this.get(iV`/v2/rooms/${e}/storage`,{format:t});if(!r.ok){let e=await r.text();throw new iZ(r.status,e)}return await r.json()}async initializeStorageDocument(e,t){let r=await this.post(iV`/v2/rooms/${e}/storage`,t);if(!r.ok){let e=await r.text();throw new iZ(r.status,e)}return await r.json()}async deleteStorageDocument(e){let t=await this.delete(iV`/v2/rooms/${e}/storage`);if(!t.ok){let e=await t.text();throw new iZ(t.status,e)}}async getYjsDocument(e,t={}){let{format:r,key:i,type:n}=t,s=iV`v2/rooms/${e}/ydoc`,o=await this.get(s,{formatting:r?"true":void 0,key:i,type:n});if(!o.ok){let e=await o.text();throw new iZ(o.status,e)}return await o.json()}async sendYjsBinaryUpdate(e,t){let r=await this.putBinary(iV`/v2/rooms/${e}/ydoc`,t);if(!r.ok){let e=await r.text();throw new iZ(r.status,e)}}async getYjsDocumentAsBinaryUpdate(e){let t=await this.get(iV`/v2/rooms/${e}/ydoc-binary`);if(!t.ok){let e=await t.text();throw new iZ(t.status,e)}return t.arrayBuffer()}async createSchema(e,t){let r=await this.post(iV`/v2/schemas`,{name:e,body:t});if(!r.ok){let e=await r.text();throw new iZ(r.status,e)}let i=await r.json(),n=new Date(i.createdAt),s=new Date(i.updatedAt);return{...i,createdAt:n,updatedAt:s}}async getSchema(e){let t=await this.get(iV`/v2/schemas/${e}`);if(!t.ok){let e=await t.text();throw new iZ(t.status,e)}let r=await t.json(),i=new Date(r.createdAt),n=new Date(r.updatedAt);return{...r,createdAt:i,updatedAt:n}}async updateSchema(e,t){let r=await this.put(iV`/v2/schemas/${e}`,{body:t});if(!r.ok){let e=await r.text();throw new iZ(r.status,e)}let i=await r.json(),n=new Date(i.createdAt),s=new Date(i.updatedAt);return{...i,createdAt:n,updatedAt:s}}async deleteSchema(e){let t=await this.delete(iV`/v2/schemas/${e}`);if(!t.ok){let e=await t.text();throw new iZ(t.status,e)}}async getSchemaByRoomId(e){let t=await this.get(iV`/v2/rooms/${e}/schema`);if(!t.ok){let e=await t.text();throw new iZ(t.status,e)}let r=await t.json(),i=new Date(r.createdAt),n=new Date(r.updatedAt);return{...r,createdAt:i,updatedAt:n}}async attachSchemaToRoom(e,t){let r=await this.post(iV`/v2/rooms/${e}/schema`,{schema:t});if(!r.ok){let e=await r.text();throw new iZ(r.status,e)}return await r.json()}async detachSchemaFromRoom(e){let t=await this.delete(iV`/v2/rooms/${e}/schema`);if(!t.ok){let e=await t.text();throw new iZ(t.status,e)}}async getThreads(e){let{roomId:t}=e,r=await this.get(iV`/v2/rooms/${t}/threads`);if(!r.ok){let e=await r.text();throw new iZ(r.status,e)}let{data:i}=await r.json();return{data:i.map(e=>r5(e))}}async getThread(e){let{roomId:t,threadId:r}=e,i=await this.get(iV`/v2/rooms/${t}/threads/${r}`);if(!i.ok){let e=await i.text();throw new iZ(i.status,e)}return r5(await i.json())}async getThreadParticipants(e){let{roomId:t,threadId:r}=e,i=await this.get(iV`/v2/rooms/${t}/threads/${r}/participants`);if(!i.ok){let e=await i.text();throw new iZ(i.status,e)}return await i.json()}async getComment(e){let{roomId:t,threadId:r,commentId:i}=e,n=await this.get(iV`/v2/rooms/${t}/threads/${r}/comments/${i}`);if(!n.ok){let e=await n.text();throw new iZ(n.status,e)}return r4(await n.json())}async createComment(e){let{roomId:t,threadId:r,data:i}=e,n=await this.post(iV`/v2/rooms/${t}/threads/${r}/comments`,{...i,createdAt:i.createdAt?.toISOString()});if(!n.ok){let e=await n.text();throw new iZ(n.status,e)}return r4(await n.json())}async editComment(e){let{roomId:t,threadId:r,commentId:i,data:n}=e,s=await this.post(iV`/v2/rooms/${t}/threads/${r}/comments/${i}`,{...n,editedAt:n.editedAt?.toISOString()});if(!s.ok){let e=await s.text();throw new iZ(s.status,e)}return r4(await s.json())}async deleteComment(e){let{roomId:t,threadId:r,commentId:i}=e,n=await this.delete(iV`/v2/rooms/${t}/threads/${r}/comments/${i}`);if(!n.ok){let e=await n.text();throw new iZ(n.status,e)}}async createThread(e){let{roomId:t,data:r}=e,i=await this.post(iV`/v2/rooms/${t}/threads`,{...r,comment:{...r.comment,createdAt:r.comment.createdAt?.toISOString()}});if(!i.ok){let e=await i.text();throw new iZ(i.status,e)}return r5(await i.json())}async editThreadMetadata(e){let{roomId:t,threadId:r,data:i}=e,n=await this.post(iV`/v2/rooms/${t}/threads/${r}/metadata`,{...i,updatedAt:i.updatedAt?.toISOString()});if(!n.ok){let e=await n.text();throw new iZ(n.status,e)}return await n.json()}async addCommentReaction(e){var t;let{roomId:r,threadId:i,commentId:n,data:s}=e,o=await this.post(iV`/v2/rooms/${r}/threads/${i}/comments/${n}/add-reaction`,{...s,createdAt:s.createdAt?.toISOString()});if(!o.ok){let e=await o.text();throw new iZ(o.status,e)}return{...t=await o.json(),createdAt:new Date(t.createdAt)}}async removeCommentReaction(e){let{roomId:t,threadId:r,data:i}=e,n=await this.post(iV`/v2/rooms/${t}/threads/${r}/comments/${e.commentId}/remove-reaction`,{...i,removedAt:i.removedAt?.toISOString()});if(!n.ok){let e=await n.text();throw new iZ(n.status,e)}}async getInboxNotification(e){let{userId:t,inboxNotificationId:r}=e,i=await this.get(iV`/v2/users/${t}/inbox-notifications/${r}`);if(!i.ok){let e=await i.text();throw new iZ(i.status,e)}let n=await i.json();return{...n,notifiedAt:new Date(n.notifiedAt),readAt:n.readAt?new Date(n.readAt):null}}async getRoomNotificationSettings(e){let{userId:t,roomId:r}=e,i=await this.get(iV`/v2/rooms/${r}/users/${t}/notification-settings`);if(!i.ok){let e=await i.text();throw new iZ(i.status,e)}return await i.json()}async updateRoomNotificationSettings(e){let{userId:t,roomId:r,data:i}=e,n=await this.post(iV`/v2/rooms/${r}/users/${t}/notification-settings`,i);if(!n.ok){let e=await n.text();throw new iZ(n.status,e)}return await n.json()}async deleteRoomNotificationSettings(e){let{userId:t,roomId:r}=e,i=await this.delete(iV`/v2/rooms/${r}/users/${t}/notification-settings`);if(!i.ok){let e=await i.text();throw new iZ(i.status,e)}}},iZ=class extends Error{constructor(e,t=""){super(t),this.name="LiveblocksError",this.status=e}};rM("@liveblocks/node","1.10.1","esm");for(var i0=[],i1=[],i2=Uint8Array,i8="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i3=0,i4=i8.length;i3<i4;++i3)i0[i3]=i8[i3],i1[i8.charCodeAt(i3)]=i3;function i5(e){var t,r,i=function(e){var t=e.length;if(t%4>0)throw Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");-1===r&&(r=t);var i=r===t?0:4-r%4;return[r,i]}(e),n=i[0],s=i[1],o=new i2((n+s)*3/4-s),a=0,l=s>0?n-4:n;for(r=0;r<l;r+=4)t=i1[e.charCodeAt(r)]<<18|i1[e.charCodeAt(r+1)]<<12|i1[e.charCodeAt(r+2)]<<6|i1[e.charCodeAt(r+3)],o[a++]=t>>16&255,o[a++]=t>>8&255,o[a++]=255&t;return 2===s&&(t=i1[e.charCodeAt(r)]<<2|i1[e.charCodeAt(r+1)]>>4,o[a++]=255&t),1===s&&(t=i1[e.charCodeAt(r)]<<10|i1[e.charCodeAt(r+1)]<<4|i1[e.charCodeAt(r+2)]>>2,o[a++]=t>>8&255,o[a++]=255&t),o}function i6(e){for(var t,r=e.length,i=r%3,n=[],s=0,o=r-i;s<o;s+=16383)n.push(function(e,t,r){for(var i,n=[],s=t;s<r;s+=3)n.push(i0[(i=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]))>>18&63]+i0[i>>12&63]+i0[i>>6&63]+i0[63&i]);return n.join("")}(e,s,s+16383>o?o:s+16383));return 1===i?n.push(i0[(t=e[r-1])>>2]+i0[t<<4&63]+"=="):2===i&&n.push(i0[(t=(e[r-2]<<8)+e[r-1])>>10]+i0[t>>4&63]+i0[t<<2&63]+"="),n.join("")}function i7(e){if(void 0===e)return{};if(!i9(e))throw Error(`The arguments to a Convex function must be an object. Received: ${e}`);return e}function i9(e){let t="object"==typeof e,r=Object.getPrototypeOf(e),i=null===r||r===Object.prototype||r?.constructor?.name==="Object";return t&&i}i1["-".charCodeAt(0)]=62,i1["_".charCodeAt(0)]=63;let ne=BigInt("-9223372036854775808"),nt=BigInt("9223372036854775807"),nr=BigInt("0"),ni=BigInt("8"),nn=BigInt("256");function ns(e){return Number.isNaN(e)||!Number.isFinite(e)||Object.is(e,-0)}let no=DataView.prototype.setBigInt64?function(e){if(e<ne||nt<e)throw Error(`BigInt ${e} does not fit into a 64-bit signed integer.`);let t=new ArrayBuffer(8);return new DataView(t).setBigInt64(0,e,!0),i6(new Uint8Array(t))}:function(e){e<nr&&(e-=ne+ne);let t=e.toString(16);t.length%2==1&&(t="0"+t);let r=new Uint8Array(new ArrayBuffer(8)),i=0;for(let n of t.match(/.{2}/g).reverse())r.set([parseInt(n,16)],i++),e>>=ni;return i6(r)},na=DataView.prototype.getBigInt64?function(e){let t=i5(e);if(8!==t.byteLength)throw Error(`Received ${t.byteLength} bytes, expected 8 for $integer`);return new DataView(t.buffer).getBigInt64(0,!0)}:function(e){let t=i5(e);if(8!==t.byteLength)throw Error(`Received ${t.byteLength} bytes, expected 8 for $integer`);let r=nr,i=nr;for(let e of t)r+=BigInt(e)*nn**i,i++;return r>nt&&(r+=ne+ne),r};function nl(e){if(0===e.length)throw Error("Empty field names are disallowed.");if(e.length>1024)throw Error(`Field name ${e} exceeds maximum field name length 1024.`);if(e.startsWith("$"))throw Error(`Field name ${e} starts with a '$', which is reserved.`);for(let t=0;t<e.length;t+=1){let r=e.charCodeAt(t);if(r<32||r>=127)throw Error(`Field name ${e} has invalid character '${e[t]}': Field names can only contain non-control ASCII characters`)}}function nu(e){if(null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e)return e;if(Array.isArray(e))return e.map(e=>nu(e));if("object"!=typeof e)throw Error(`Unexpected type of ${e}`);let t=Object.entries(e);if(1===t.length){let r=t[0][0];if("$bytes"===r){if("string"!=typeof e.$bytes)throw Error(`Malformed $bytes field on ${e}`);return i5(e.$bytes).buffer}if("$integer"===r){if("string"!=typeof e.$integer)throw Error(`Malformed $integer field on ${e}`);return na(e.$integer)}if("$float"===r){if("string"!=typeof e.$float)throw Error(`Malformed $float field on ${e}`);let t=i5(e.$float);if(8!==t.byteLength)throw Error(`Received ${t.byteLength} bytes, expected 8 for $float`);let r=new DataView(t.buffer).getFloat64(0,!0);if(!ns(r))throw Error(`Float ${r} should be encoded as a number`);return r}if("$set"===r)throw Error("Received a Set which is no longer supported as a Convex type.");if("$map"===r)throw Error("Received a Map which is no longer supported as a Convex type.")}let r={};for(let[t,i]of Object.entries(e))nl(t),r[t]=nu(i);return r}function nc(e){return JSON.stringify(e,(e,t)=>void 0===t?"undefined":"bigint"==typeof t?`${t.toString()}n`:t)}function nh(e,t,r,i){if(void 0===e){let e=r&&` (present at path ${r} in original object ${nc(t)})`;throw Error(`undefined is not a valid Convex value${e}. To learn about Convex's supported types, see https://docs.convex.dev/using/types.`)}if(null===e)return e;if("bigint"==typeof e){if(e<ne||nt<e)throw Error(`BigInt ${e} does not fit into a 64-bit signed integer.`);return{$integer:no(e)}}if("number"==typeof e){if(!ns(e))return e;{let t=new ArrayBuffer(8);return new DataView(t).setFloat64(0,e,!0),{$float:i6(new Uint8Array(t))}}}if("boolean"==typeof e||"string"==typeof e)return e;if(e instanceof ArrayBuffer)return{$bytes:i6(new Uint8Array(e))};if(Array.isArray(e))return e.map((e,i)=>nh(e,t,r+`[${i}]`,!1));if(e instanceof Set)throw Error(nd(r,"Set",[...e],t));if(e instanceof Map)throw Error(nd(r,"Map",[...e],t));if(!i9(e)){let i=e?.constructor?.name;throw Error(nd(r,i?`${i} `:"",e,t))}let n={},s=Object.entries(e);for(let[e,o]of(s.sort(([e,t],[r,i])=>e===r?0:e<r?-1:1),s))void 0!==o?(nl(e),n[e]=nh(o,t,r+`.${e}`,!1)):i&&(nl(e),n[e]=nf(o,t,r+`.${e}`));return n}function nd(e,t,r,i){return e?`${t}${nc(r)} is not a supported Convex type (present at path ${e} in original object ${nc(i)}). To learn about Convex's supported types, see https://docs.convex.dev/using/types.`:`${t}${nc(r)} is not a supported Convex type.`}function nf(e,t,r){if(void 0===e)return{$undefined:null};if(void 0===t)throw Error(`Programming error. Current value is ${nc(e)} but original value is undefined`);return nh(e,t,r,!1)}function np(e){return nh(e,e,"",!1)}function nm(e){return nf(e,e,"")}class ny{constructor(e,t){this.json=e,this.optional=t}}let ng={id:e=>new ny({type:"id",tableName:e},!1),null:()=>new ny({type:"null"},!1),number:()=>new ny({type:"number"},!1),float64:()=>new ny({type:"number"},!1),bigint:()=>new ny({type:"bigint"},!1),int64:()=>new ny({type:"bigint"},!1),boolean:()=>new ny({type:"boolean"},!1),string:()=>new ny({type:"string"},!1),bytes:()=>new ny({type:"bytes"},!1),literal:e=>new ny({type:"literal",value:np(e)},!1),array:e=>new ny({type:"array",value:e.json},!1),object:e=>new ny({type:"object",value:Object.fromEntries(Object.entries(e).map(([e,t])=>[e,{fieldType:t.json,optional:t.optional}]))},!1),record:(e,t)=>new ny({type:"record",keys:e.json,values:{fieldType:t.json,optional:t.optional}},!1),union:(...e)=>new ny({type:"union",value:e.map(e=>e.json)},!1),any:()=>new ny({type:"any"},!1),optional:e=>new ny(e.json,!0)},nb=Symbol.for("ConvexError");class n_ extends Error{constructor(e){super("string"==typeof e?e:nc(e)),this.name="ConvexError",this[d]=!0,this.data=e}}d=nb;let nv=Symbol.for("functionName");function nw(e){if("string"==typeof e)return e;let t=e[nv];if(!t)throw Error(`${e} is not a functionReference`);return t}let nS=function e(t=[]){return new Proxy({},{get(r,i){if("string"==typeof i)return e([...t,i]);if(i===nv){if(t.length<2){let e=["api",...t].join(".");throw Error(`API path is expected to be of the form \`api.moduleName.functionName\`. Found: \`${e}\``)}let e=t.slice(0,-1).join("/"),r=t[t.length-1];return"default"===r?e:e+":"+r}return i===Symbol.toStringTag?"FunctionReference":void 0}})}();class nA{static isLong(e){return!0===(e&&e.__isUnsignedLong__)}constructor(e,t){this.low=0|e,this.high=0|t,this.__isUnsignedLong__=!0}static fromBytesLE(e){return new nA(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24)}toBytesLE(){let e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]}static fromNumber(e){return isNaN(e)||e<0?nk:e>=nx?nC:new nA(e%nE|0,e/nE|0)}toString(){return(BigInt(this.high)*BigInt(nE)+BigInt(this.low)).toString()}equals(e){return nA.isLong(e)||(e=nA.fromValue(e)),(this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low}notEquals(e){return!this.equals(e)}comp(e){return(nA.isLong(e)||(e=nA.fromValue(e)),this.equals(e))?0:e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1}lessThanOrEqual(e){return 0>=this.comp(e)}static fromValue(e){return"number"==typeof e?nA.fromNumber(e):new nA(e.low,e.high)}}let nk=new nA(0,0),nE=4294967296,nx=18446744073709552e3,nC=new nA(-1,-1);function nP(e){this.message=e}function nT(e){this.message=e}nP.prototype=Error(),nP.prototype.name="InvalidCharacterError",nT.prototype=Error(),nT.prototype.name="InvalidTokenError";let nO=require("module");var nB=r(71017);let nR="1.11.0";function nI(e,t,r,i){let n=function(e){switch(e){case"query":return"Q";case"mutation":return"M";case"action":return"A";case"any":return"?"}}(t);if("object"==typeof i&&(i=`ConvexError ${JSON.stringify(i.errorData,null,2)}`),"info"===e){let e=i.match(/^\[.*?\] /);if(null===e){console.error(`[CONVEX ${n}(${r})] Could not parse console.log`);return}let t=i.slice(1,e[0].length-2);console.log(`%c[CONVEX ${n}(${r})] [${t}]`,"color:rgb(0, 145, 255)",i.slice(e[0].length))}else console.error(`[CONVEX ${n}(${r})] ${i}`)}class nN{constructor(e){(function(e){if(void 0===e)throw Error("Client created with undefined deployment address. If you used an environment variable, check that it's set.");if("string"!=typeof e)throw Error(`Invalid deployment address: found ${e}".`);if(!(e.startsWith("http:")||e.startsWith("https:")))throw Error(`Invalid deployment address: Must start with "https://" or "http://". Found "${e}".`);if(-1===e.indexOf("127.0.0.1")&&-1===e.indexOf("localhost")&&!e.endsWith(".convex.cloud"))throw Error(`Invalid deployment address: Must end with ".convex.cloud". Found "${e}".`)})(e),this.address=`${e}/api`,this.debug=!0}backendUrl(){return this.address}setAuth(e){this.clearAuth(),this.auth=e}setAdminAuth(e,t){if(this.clearAuth(),void 0!==t){let r=btoa(String.fromCodePoint(...new TextEncoder().encode(JSON.stringify(t))));this.adminAuth=`${e}:${r}`}else this.adminAuth=e}clearAuth(){this.auth=void 0,this.adminAuth=void 0}setDebug(e){this.debug=e}setFetchOptions(e){this.fetchOptions=e}async query(e,...t){let r=i7(t[0]),n=nw(e),s=JSON.stringify({path:n,format:"convex_encoded_json",args:[np(r)]}),o={"Content-Type":"application/json","Convex-Client":`npm-${nR}`};this.adminAuth?o.Authorization=`Convex ${this.adminAuth}`:this.auth&&(o.Authorization=`Bearer ${this.auth}`);let a=i||fetch,l=await a(`${this.address}/query`,{...this.fetchOptions,body:s,method:"POST",headers:o,credentials:"include"});if(!l.ok&&560!==l.status)throw Error(await l.text());let u=await l.json();if(this.debug)for(let e of u.logLines??[])nI("info","query",n,e);switch(u.status){case"success":return nu(u.value);case"error":if(void 0!==u.errorData)throw nU(u.errorData,new n_(u.errorMessage));throw Error(u.errorMessage);default:throw Error(`Invalid response: ${JSON.stringify(u)}`)}}async mutation(e,...t){let r=i7(t[0]),n=nw(e),s=JSON.stringify({path:n,format:"convex_encoded_json",args:[np(r)]}),o={"Content-Type":"application/json","Convex-Client":`npm-${nR}`};this.adminAuth?o.Authorization=`Convex ${this.adminAuth}`:this.auth&&(o.Authorization=`Bearer ${this.auth}`);let a=i||fetch,l=await a(`${this.address}/mutation`,{...this.fetchOptions,body:s,method:"POST",headers:o,credentials:"include"});if(!l.ok&&560!==l.status)throw Error(await l.text());let u=await l.json();if(this.debug)for(let e of u.logLines??[])nI("info","mutation",n,e);switch(u.status){case"success":return nu(u.value);case"error":if(void 0!==u.errorData)throw nU(u.errorData,new n_(u.errorMessage));throw Error(u.errorMessage);default:throw Error(`Invalid response: ${JSON.stringify(u)}`)}}async action(e,...t){let r=i7(t[0]),n=nw(e),s=JSON.stringify({path:n,format:"convex_encoded_json",args:[np(r)]}),o={"Content-Type":"application/json","Convex-Client":`npm-${nR}`};this.adminAuth?o.Authorization=`Convex ${this.adminAuth}`:this.auth&&(o.Authorization=`Bearer ${this.auth}`);let a=i||fetch,l=await a(`${this.address}/action`,{...this.fetchOptions,body:s,method:"POST",headers:o,credentials:"include"});if(!l.ok&&560!==l.status)throw Error(await l.text());let u=await l.json();if(this.debug)for(let e of u.logLines??[])nI("info","action",n,e);switch(u.status){case"success":return nu(u.value);case"error":if(void 0!==u.errorData)throw nU(u.errorData,new n_(u.errorMessage));throw Error(u.errorMessage);default:throw Error(`Invalid response: ${JSON.stringify(u)}`)}}async function(e,...t){let r=i7(t[0]),n="string"==typeof e?e:nw(e),s=JSON.stringify({path:n,format:"convex_encoded_json",args:np(r)}),o={"Content-Type":"application/json","Convex-Client":`npm-${nR}`};this.adminAuth?o.Authorization=`Convex ${this.adminAuth}`:this.auth&&(o.Authorization=`Bearer ${this.auth}`);let a=i||fetch,l=await a(`${this.address}/function`,{...this.fetchOptions,body:s,method:"POST",headers:o,credentials:"include"});if(!l.ok&&560!==l.status)throw Error(await l.text());let u=await l.json();if(this.debug)for(let e of u.logLines??[])nI("info","any",n,e);switch(u.status){case"success":return nu(u.value);case"error":if(void 0!==u.errorData)throw nU(u.errorData,new n_(u.errorMessage));throw Error(u.errorMessage);default:throw Error(`Invalid response: ${JSON.stringify(u)}`)}}}function nU(e,t){return t.data=nu(e),t}let nL=(0,nO.createRequire)((0,nB.resolve)("."));var nj=Object.create,nK=Object.defineProperty,nD=Object.getOwnPropertyDescriptor,nM=Object.getOwnPropertyNames,n$=Object.getPrototypeOf,nq=Object.prototype.hasOwnProperty,nH=(h=function(e){if(void 0!==nL)return nL.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')},void 0!==nL?nL:"undefined"!=typeof Proxy?new Proxy(h,{get:(e,t)=>(void 0!==nL?nL:e)[t]}):h),nz=(e,t)=>function(){return t||(0,e[nM(e)[0]])((t={exports:{}}).exports,t),t.exports},nF=(e,t,r,i)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let n of nM(t))nq.call(e,n)||n===r||nK(e,n,{get:()=>t[n],enumerable:!(i=nD(t,n))||i.enumerable});return e},nV=(e,t,r)=>(r=null!=e?nj(n$(e)):{},nF(!t&&e&&e.__esModule?r:nK(r,"default",{value:e,enumerable:!0}),e)),nW=nz({"../common/temp/node_modules/.pnpm/ws@8.14.2_3cxu5zja4e2r5wmvge7mdcljwq/node_modules/ws/lib/stream.js"(e,t){var{Duplex:r}=nH("stream");function i(e){e.emit("close")}function n(){!this.destroyed&&this._writableState.finished&&this.destroy()}function s(e){this.removeListener("error",s),this.destroy(),0===this.listenerCount("error")&&this.emit("error",e)}t.exports=function(e,t){let o=!0,a=new r({...t,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return e.on("message",function(t,r){let i=!r&&a._readableState.objectMode?t.toString():t;a.push(i)||e.pause()}),e.once("error",function(e){a.destroyed||(o=!1,a.destroy(e))}),e.once("close",function(){a.destroyed||a.push(null)}),a._destroy=function(t,r){if(e.readyState===e.CLOSED){r(t),process.nextTick(i,a);return}let n=!1;e.once("error",function(e){n=!0,r(e)}),e.once("close",function(){n||r(t),process.nextTick(i,a)}),o&&e.terminate()},a._final=function(t){if(e.readyState===e.CONNECTING){e.once("open",function(){a._final(t)});return}null!==e._socket&&(e._socket._writableState.finished?(t(),a._readableState.endEmitted&&a.destroy()):(e._socket.once("finish",function(){t()}),e.close()))},a._read=function(){e.isPaused&&e.resume()},a._write=function(t,r,i){if(e.readyState===e.CONNECTING){e.once("open",function(){a._write(t,r,i)});return}e.send(t,i)},a.on("end",n),a.on("error",s),a}}}),nJ=nz({"../common/temp/node_modules/.pnpm/ws@8.14.2_3cxu5zja4e2r5wmvge7mdcljwq/node_modules/ws/lib/constants.js"(e,t){t.exports={BINARY_TYPES:["nodebuffer","arraybuffer","fragments"],EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}}}),nG=nz({"../common/temp/node_modules/.pnpm/node-gyp-build@4.6.1/node_modules/node-gyp-build/node-gyp-build.js"(e,t){var r=nH("fs"),i=nH("path"),n=nH("os"),s=process.config&&process.config.variables||{},o=!!process.env.PREBUILDS_ONLY,a=process.versions.modules,l=process.versions&&process.versions.electron||process.env.ELECTRON_RUN_AS_NODE?"electron":process.versions&&process.versions.nw?"node-webkit":"node",u=process.env.npm_config_arch||n.arch(),c=process.env.npm_config_platform||n.platform(),h=process.env.LIBC||("linux"===c&&r.existsSync("/etc/alpine-release")?"musl":"glibc"),d=process.env.ARM_VERSION||("arm64"===u?"8":s.arm_version)||"",f=(process.versions.uv||"").split(".")[0];function p(e){return nL(p.resolve(e))}function m(e){try{return r.readdirSync(e)}catch(e){return[]}}function y(e,t){var r=m(e).filter(t);return r[0]&&i.join(e,r[0])}function g(e){return/\.node$/.test(e)}function b(e){var t=e.split("-");if(2===t.length){var r=t[0],i=t[1].split("+");if(r&&i.length&&i.every(Boolean))return{name:e,platform:r,architectures:i}}}function _(e,t){return function(r){return null!=r&&r.platform===e&&r.architectures.includes(t)}}function v(e,t){return e.architectures.length-t.architectures.length}function w(e){var t=e.split("."),r=t.pop(),i={file:e,specificity:0};if("node"===r){for(var n=0;n<t.length;n++){var s=t[n];if("node"===s||"electron"===s||"node-webkit"===s)i.runtime=s;else if("napi"===s)i.napi=!0;else if("abi"===s.slice(0,3))i.abi=s.slice(3);else if("uv"===s.slice(0,2))i.uv=s.slice(2);else if("armv"===s.slice(0,4))i.armv=s.slice(4);else{if("glibc"!==s&&"musl"!==s)continue;i.libc=s}i.specificity++}return i}}function S(e,t){return function(r){return null!=r&&(r.runtime===e||!!("node"===r.runtime&&r.napi))&&(r.abi===t||!!r.napi)&&(!r.uv||r.uv===f)&&(!r.armv||r.armv===d)&&(!r.libc||r.libc===h)}}function A(e){return function(t,r){return t.runtime!==r.runtime?t.runtime===e?-1:1:t.abi!==r.abi?t.abi?-1:1:t.specificity!==r.specificity?t.specificity>r.specificity?-1:1:0}}t.exports=p,p.resolve=p.path=function(e){e=i.resolve(e||".");try{var t=nL(i.join(e,"package.json")).name.toUpperCase().replace(/-/g,"_");process.env[t+"_PREBUILD"]&&(e=process.env[t+"_PREBUILD"])}catch(e){}if(!o){var r=y(i.join(e,"build/Release"),g);if(r)return r;var n=y(i.join(e,"build/Debug"),g);if(n)return n}var s=k(e);if(s)return s;var p=k(i.dirname(process.execPath));if(p)return p;throw Error("No native build was found for "+["platform="+c,"arch="+u,"runtime="+l,"abi="+a,"uv="+f,d?"armv="+d:"","libc="+h,"node="+process.versions.node,process.versions.electron?"electron="+process.versions.electron:"","webpack=true"].filter(Boolean).join(" ")+"\n    loaded from: "+e+"\n");function k(e){var t=m(i.join(e,"prebuilds")).map(b).filter(_(c,u)).sort(v)[0];if(t){var r=i.join(e,"prebuilds",t.name),n=m(r).map(w).filter(S(l,a)).sort(A(l))[0];if(n)return i.join(r,n.file)}}},p.parseTags=w,p.matchTags=S,p.compareTags=A,p.parseTuple=b,p.matchTuple=_,p.compareTuples=v}}),nY=nz({"../common/temp/node_modules/.pnpm/node-gyp-build@4.6.1/node_modules/node-gyp-build/index.js"(e,t){"function"==typeof process.addon?t.exports=process.addon.bind(process):t.exports=nG()}}),nX=nz({"../common/temp/node_modules/.pnpm/bufferutil@4.0.7/node_modules/bufferutil/fallback.js"(e,t){t.exports={mask:(e,t,r,i,n)=>{for(var s=0;s<n;s++)r[i+s]=e[s]^t[3&s]},unmask:(e,t)=>{let r=e.length;for(var i=0;i<r;i++)e[i]^=t[3&i]}}}}),nQ=nz({"../common/temp/node_modules/.pnpm/bufferutil@4.0.7/node_modules/bufferutil/index.js"(e,t){try{t.exports=nY()(__dirname)}catch(e){t.exports=nX()}}}),nZ=nz({"../common/temp/node_modules/.pnpm/ws@8.14.2_3cxu5zja4e2r5wmvge7mdcljwq/node_modules/ws/lib/buffer-util.js"(e,t){var{EMPTY_BUFFER:r}=nJ(),i=Buffer[Symbol.species];function n(e,t,r,i,n){for(let s=0;s<n;s++)r[i+s]=e[s]^t[3&s]}function s(e,t){for(let r=0;r<e.length;r++)e[r]^=t[3&r]}if(t.exports={concat:function(e,t){if(0===e.length)return r;if(1===e.length)return e[0];let n=Buffer.allocUnsafe(t),s=0;for(let t=0;t<e.length;t++){let r=e[t];n.set(r,s),s+=r.length}return s<t?new i(n.buffer,n.byteOffset,s):n},mask:n,toArrayBuffer:function(e){return e.length===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.length)},toBuffer:function e(t){let r;return(e.readOnly=!0,Buffer.isBuffer(t))?t:(t instanceof ArrayBuffer?r=new i(t):ArrayBuffer.isView(t)?r=new i(t.buffer,t.byteOffset,t.byteLength):(r=Buffer.from(t),e.readOnly=!1),r)},unmask:s},!process.env.WS_NO_BUFFER_UTIL)try{let e=nQ();t.exports.mask=function(t,r,i,s,o){o<48?n(t,r,i,s,o):e.mask(t,r,i,s,o)},t.exports.unmask=function(t,r){t.length<32?s(t,r):e.unmask(t,r)}}catch(e){}}}),n0=nz({"../common/temp/node_modules/.pnpm/ws@8.14.2_3cxu5zja4e2r5wmvge7mdcljwq/node_modules/ws/lib/limiter.js"(e,t){var r=Symbol("kDone"),i=Symbol("kRun"),n=class{constructor(e){this[r]=()=>{this.pending--,this[i]()},this.concurrency=e||1/0,this.jobs=[],this.pending=0}add(e){this.jobs.push(e),this[i]()}[i](){if(this.pending!==this.concurrency&&this.jobs.length){let e=this.jobs.shift();this.pending++,e(this[r])}}};t.exports=n}}),n1=nz({"../common/temp/node_modules/.pnpm/ws@8.14.2_3cxu5zja4e2r5wmvge7mdcljwq/node_modules/ws/lib/permessage-deflate.js"(e,t){var r,i=nH("zlib"),n=nZ(),s=n0(),{kStatusCode:o}=nJ(),a=Buffer[Symbol.species],l=Buffer.from([0,0,255,255]),u=Symbol("permessage-deflate"),c=Symbol("total-length"),h=Symbol("callback"),d=Symbol("buffers"),f=Symbol("error"),p=class{constructor(e,t,i){this._maxPayload=0|i,this._options=e||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!t,this._deflate=null,this._inflate=null,this.params=null,r||(r=new s(void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10))}static get extensionName(){return"permessage-deflate"}offer(){let e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){let e=this._deflate[h];this._deflate.close(),this._deflate=null,e&&e(Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(e){let t=this._options,r=e.find(e=>(!1!==t.serverNoContextTakeover||!e.server_no_context_takeover)&&(!e.server_max_window_bits||!1!==t.serverMaxWindowBits&&("number"!=typeof t.serverMaxWindowBits||!(t.serverMaxWindowBits>e.server_max_window_bits)))&&("number"!=typeof t.clientMaxWindowBits||!!e.client_max_window_bits));if(!r)throw Error("None of the extension offers can be accepted");return t.serverNoContextTakeover&&(r.server_no_context_takeover=!0),t.clientNoContextTakeover&&(r.client_no_context_takeover=!0),"number"==typeof t.serverMaxWindowBits&&(r.server_max_window_bits=t.serverMaxWindowBits),"number"==typeof t.clientMaxWindowBits?r.client_max_window_bits=t.clientMaxWindowBits:(!0===r.client_max_window_bits||!1===t.clientMaxWindowBits)&&delete r.client_max_window_bits,r}acceptAsClient(e){let t=e[0];if(!1===this._options.clientNoContextTakeover&&t.client_no_context_takeover)throw Error('Unexpected parameter "client_no_context_takeover"');if(t.client_max_window_bits){if(!1===this._options.clientMaxWindowBits||"number"==typeof this._options.clientMaxWindowBits&&t.client_max_window_bits>this._options.clientMaxWindowBits)throw Error('Unexpected or invalid parameter "client_max_window_bits"')}else"number"==typeof this._options.clientMaxWindowBits&&(t.client_max_window_bits=this._options.clientMaxWindowBits);return t}normalizeParams(e){return e.forEach(e=>{Object.keys(e).forEach(t=>{let r=e[t];if(r.length>1)throw Error(`Parameter "${t}" must have only a single value`);if(r=r[0],"client_max_window_bits"===t){if(!0!==r){let e=+r;if(!Number.isInteger(e)||e<8||e>15)throw TypeError(`Invalid value for parameter "${t}": ${r}`);r=e}else if(!this._isServer)throw TypeError(`Invalid value for parameter "${t}": ${r}`)}else if("server_max_window_bits"===t){let e=+r;if(!Number.isInteger(e)||e<8||e>15)throw TypeError(`Invalid value for parameter "${t}": ${r}`);r=e}else if("client_no_context_takeover"===t||"server_no_context_takeover"===t){if(!0!==r)throw TypeError(`Invalid value for parameter "${t}": ${r}`)}else throw Error(`Unknown parameter "${t}"`);e[t]=r})}),e}decompress(e,t,i){r.add(r=>{this._decompress(e,t,(e,t)=>{r(),i(e,t)})})}compress(e,t,i){r.add(r=>{this._compress(e,t,(e,t)=>{r(),i(e,t)})})}_decompress(e,t,r){let s=this._isServer?"client":"server";if(!this._inflate){let e=`${s}_max_window_bits`,t="number"!=typeof this.params[e]?i.Z_DEFAULT_WINDOWBITS:this.params[e];this._inflate=i.createInflateRaw({...this._options.zlibInflateOptions,windowBits:t}),this._inflate[u]=this,this._inflate[c]=0,this._inflate[d]=[],this._inflate.on("error",g),this._inflate.on("data",y)}this._inflate[h]=r,this._inflate.write(e),t&&this._inflate.write(l),this._inflate.flush(()=>{let e=this._inflate[f];if(e){this._inflate.close(),this._inflate=null,r(e);return}let i=n.concat(this._inflate[d],this._inflate[c]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[c]=0,this._inflate[d]=[],t&&this.params[`${s}_no_context_takeover`]&&this._inflate.reset()),r(null,i)})}_compress(e,t,r){let s=this._isServer?"server":"client";if(!this._deflate){let e=`${s}_max_window_bits`,t="number"!=typeof this.params[e]?i.Z_DEFAULT_WINDOWBITS:this.params[e];this._deflate=i.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:t}),this._deflate[c]=0,this._deflate[d]=[],this._deflate.on("data",m)}this._deflate[h]=r,this._deflate.write(e),this._deflate.flush(i.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let e=n.concat(this._deflate[d],this._deflate[c]);t&&(e=new a(e.buffer,e.byteOffset,e.length-4)),this._deflate[h]=null,this._deflate[c]=0,this._deflate[d]=[],t&&this.params[`${s}_no_context_takeover`]&&this._deflate.reset(),r(null,e)})}};function m(e){this[d].push(e),this[c]+=e.length}function y(e){if(this[c]+=e.length,this[u]._maxPayload<1||this[c]<=this[u]._maxPayload){this[d].push(e);return}this[f]=RangeError("Max payload size exceeded"),this[f].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[f][o]=1009,this.removeListener("data",y),this.reset()}function g(e){this[u]._inflate=null,e[o]=1007,this[h](e)}t.exports=p}}),n2=nz({"../common/temp/node_modules/.pnpm/utf-8-validate@5.0.10/node_modules/utf-8-validate/fallback.js"(e,t){t.exports=function(e){let t=e.length,r=0;for(;r<t;)if((128&e[r])==0)r++;else if((224&e[r])==192){if(r+1===t||(192&e[r+1])!=128||(254&e[r])==192)return!1;r+=2}else if((240&e[r])==224){if(r+2>=t||(192&e[r+1])!=128||(192&e[r+2])!=128||224===e[r]&&(224&e[r+1])==128||237===e[r]&&(224&e[r+1])==160)return!1;r+=3}else{if((248&e[r])!=240||r+3>=t||(192&e[r+1])!=128||(192&e[r+2])!=128||(192&e[r+3])!=128||240===e[r]&&(240&e[r+1])==128||244===e[r]&&e[r+1]>143||e[r]>244)return!1;r+=4}return!0}}}),n8=nz({"../common/temp/node_modules/.pnpm/utf-8-validate@5.0.10/node_modules/utf-8-validate/index.js"(e,t){try{t.exports=nY()(__dirname)}catch(e){t.exports=n2()}}}),n3=nz({"../common/temp/node_modules/.pnpm/ws@8.14.2_3cxu5zja4e2r5wmvge7mdcljwq/node_modules/ws/lib/validation.js"(e,t){var{isUtf8:r}=nH("buffer");function i(e){let t=e.length,r=0;for(;r<t;)if((128&e[r])==0)r++;else if((224&e[r])==192){if(r+1===t||(192&e[r+1])!=128||(254&e[r])==192)return!1;r+=2}else if((240&e[r])==224){if(r+2>=t||(192&e[r+1])!=128||(192&e[r+2])!=128||224===e[r]&&(224&e[r+1])==128||237===e[r]&&(224&e[r+1])==160)return!1;r+=3}else{if((248&e[r])!=240||r+3>=t||(192&e[r+1])!=128||(192&e[r+2])!=128||(192&e[r+3])!=128||240===e[r]&&(240&e[r+1])==128||244===e[r]&&e[r+1]>143||e[r]>244)return!1;r+=4}return!0}if(t.exports={isValidStatusCode:function(e){return e>=1e3&&e<=1014&&1004!==e&&1005!==e&&1006!==e||e>=3e3&&e<=4999},isValidUTF8:i,tokenChars:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0]},r)t.exports.isValidUTF8=function(e){return e.length<24?i(e):r(e)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{let e=n8();t.exports.isValidUTF8=function(t){return t.length<32?i(t):e(t)}}catch(e){}}}),n4=nz({"../common/temp/node_modules/.pnpm/ws@8.14.2_3cxu5zja4e2r5wmvge7mdcljwq/node_modules/ws/lib/receiver.js"(e,t){var{Writable:r}=nH("stream"),i=n1(),{BINARY_TYPES:n,EMPTY_BUFFER:s,kStatusCode:o,kWebSocket:a}=nJ(),{concat:l,toArrayBuffer:u,unmask:c}=nZ(),{isValidStatusCode:h,isValidUTF8:d}=n3(),f=Buffer[Symbol.species],p=Promise.resolve(),m="function"==typeof queueMicrotask?queueMicrotask:function(e){p.then(e).catch(_)},y=class extends r{constructor(e={}){super(),this._binaryType=e.binaryType||n[0],this._extensions=e.extensions||{},this._isServer=!!e.isServer,this._maxPayload=0|e.maxPayload,this._skipUTF8Validation=!!e.skipUTF8Validation,this[a]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._state=0,this._loop=!1}_write(e,t,r){if(8===this._opcode&&0==this._state)return r();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(r)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){let t=this._buffers[0];return this._buffers[0]=new f(t.buffer,t.byteOffset+e,t.length-e),new f(t.buffer,t.byteOffset,e)}let t=Buffer.allocUnsafe(e);do{let r=this._buffers[0],i=t.length-e;e>=r.length?t.set(this._buffers.shift(),i):(t.set(new Uint8Array(r.buffer,r.byteOffset,e),i),this._buffers[0]=new f(r.buffer,r.byteOffset+e,r.length-e)),e-=r.length}while(e>0);return t}startLoop(e){let t;this._loop=!0;do switch(this._state){case 0:t=this.getInfo();break;case 1:t=this.getPayloadLength16();break;case 2:t=this.getPayloadLength64();break;case 3:this.getMask();break;case 4:t=this.getData(e);break;case 5:this._loop=!1;return;default:this._loop=!1,m(()=>{this._state=0,this.startLoop(e)});return}while(this._loop);e(t)}getInfo(){if(this._bufferedBytes<2){this._loop=!1;return}let e=this.consume(2);if((48&e[0])!=0)return this._loop=!1,g(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3");let t=(64&e[0])==64;if(t&&!this._extensions[i.extensionName])return this._loop=!1,g(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._fin=(128&e[0])==128,this._opcode=15&e[0],this._payloadLength=127&e[1],0===this._opcode){if(t)return this._loop=!1,g(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(!this._fragmented)return this._loop=!1,g(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE");this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented)return this._loop=!1,g(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");this._compressed=t}else{if(!(this._opcode>7)||!(this._opcode<11))return this._loop=!1,g(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");if(!this._fin)return this._loop=!1,g(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN");if(t)return this._loop=!1,g(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._payloadLength>125||8===this._opcode&&1===this._payloadLength)return this._loop=!1,g(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH")}if(this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=(128&e[1])==128,this._isServer){if(!this._masked)return this._loop=!1,g(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK")}else if(this._masked)return this._loop=!1,g(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK");if(126===this._payloadLength)this._state=1;else{if(127!==this._payloadLength)return this.haveLength();this._state=2}}getPayloadLength16(){if(this._bufferedBytes<2){this._loop=!1;return}return this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength()}getPayloadLength64(){if(this._bufferedBytes<8){this._loop=!1;return}let e=this.consume(8),t=e.readUInt32BE(0);return t>2097151?(this._loop=!1,g(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH")):(this._payloadLength=4294967296*t+e.readUInt32BE(4),this.haveLength())}haveLength(){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0))return this._loop=!1,g(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");this._masked?this._state=3:this._state=4}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=4}getData(e){let t=s;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}t=this.consume(this._payloadLength),this._masked&&(this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3])!=0&&c(t,this._mask)}if(this._opcode>7)return this.controlMessage(t);if(this._compressed){this._state=5,this.decompress(t,e);return}return t.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(t)),this.dataMessage()}decompress(e,t){this._extensions[i.extensionName].decompress(e,this._fin,(e,r)=>{if(e)return t(e);if(r.length){if(this._messageLength+=r.length,this._messageLength>this._maxPayload&&this._maxPayload>0)return t(g(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));this._fragments.push(r)}let i=this.dataMessage();if(i)return t(i);this.startLoop(t)})}dataMessage(){if(this._fin){let e=this._messageLength,t=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){let r;r="nodebuffer"===this._binaryType?l(t,e):"arraybuffer"===this._binaryType?u(l(t,e)):t,this.emit("message",r,!0)}else{let r=l(t,e);if(!this._skipUTF8Validation&&!d(r))return this._loop=!1,g(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("message",r,!1)}}this._state=6}controlMessage(e){if(8===this._opcode){if(this._loop=!1,0===e.length)this.emit("conclude",1005,s),this.end(),this._state=0;else{let t=e.readUInt16BE(0);if(!h(t))return g(RangeError,`invalid status code ${t}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");let r=new f(e.buffer,e.byteOffset+2,e.length-2);if(!this._skipUTF8Validation&&!d(r))return g(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("conclude",t,r),this.end(),this._state=0}}else 9===this._opcode?this.emit("ping",e):this.emit("pong",e),this._state=6}};function g(e,t,r,i,n){let s=new e(r?`Invalid WebSocket frame: ${t}`:t);return Error.captureStackTrace(s,g),s.code=n,s[o]=i,s}function b(e){throw e}function _(e){process.nextTick(b,e)}t.exports=y}}),n5=nz({"../common/temp/node_modules/.pnpm/ws@8.14.2_3cxu5zja4e2r5wmvge7mdcljwq/node_modules/ws/lib/sender.js"(e,t){var{Duplex:r}=nH("stream"),{randomFillSync:i}=nH("crypto"),n=n1(),{EMPTY_BUFFER:s}=nJ(),{isValidStatusCode:o}=n3(),{mask:a,toBuffer:l}=nZ(),u=Symbol("kByteLength"),c=Buffer.alloc(4),h=class{constructor(e,t,r){this._extensions=t||{},r&&(this._generateMask=r,this._maskBuffer=Buffer.alloc(4)),this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._deflating=!1,this._queue=[]}static frame(e,t){let r,n;let s=!1,o=2,l=!1;t.mask&&(r=t.maskBuffer||c,t.generateMask?t.generateMask(r):i(r,0,4),l=(r[0]|r[1]|r[2]|r[3])==0,o=6),"string"==typeof e?n=(!t.mask||l)&&void 0!==t[u]?t[u]:(e=Buffer.from(e)).length:(n=e.length,s=t.mask&&t.readOnly&&!l);let h=n;n>=65536?(o+=8,h=127):n>125&&(o+=2,h=126);let d=Buffer.allocUnsafe(s?n+o:o);return(d[0]=t.fin?128|t.opcode:t.opcode,t.rsv1&&(d[0]|=64),d[1]=h,126===h?d.writeUInt16BE(n,2):127===h&&(d[2]=d[3]=0,d.writeUIntBE(n,4,6)),t.mask)?(d[1]|=128,d[o-4]=r[0],d[o-3]=r[1],d[o-2]=r[2],d[o-1]=r[3],l)?[d,e]:s?(a(e,r,d,o,n),[d]):(a(e,r,e,0,n),[d,e]):[d,e]}close(e,t,r,i){let n;if(void 0===e)n=s;else if("number"==typeof e&&o(e)){if(void 0!==t&&t.length){let r=Buffer.byteLength(t);if(r>123)throw RangeError("The message must not be greater than 123 bytes");(n=Buffer.allocUnsafe(2+r)).writeUInt16BE(e,0),"string"==typeof t?n.write(t,2):n.set(t,2)}else(n=Buffer.allocUnsafe(2)).writeUInt16BE(e,0)}else throw TypeError("First argument must be a valid error code number");let a={[u]:n.length,fin:!0,generateMask:this._generateMask,mask:r,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};this._deflating?this.enqueue([this.dispatch,n,!1,a,i]):this.sendFrame(h.frame(n,a),i)}ping(e,t,r){let i,n;if("string"==typeof e?(i=Buffer.byteLength(e),n=!1):(i=(e=l(e)).length,n=l.readOnly),i>125)throw RangeError("The data size must not be greater than 125 bytes");let s={[u]:i,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:9,readOnly:n,rsv1:!1};this._deflating?this.enqueue([this.dispatch,e,!1,s,r]):this.sendFrame(h.frame(e,s),r)}pong(e,t,r){let i,n;if("string"==typeof e?(i=Buffer.byteLength(e),n=!1):(i=(e=l(e)).length,n=l.readOnly),i>125)throw RangeError("The data size must not be greater than 125 bytes");let s={[u]:i,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:10,readOnly:n,rsv1:!1};this._deflating?this.enqueue([this.dispatch,e,!1,s,r]):this.sendFrame(h.frame(e,s),r)}send(e,t,r){let i,s;let o=this._extensions[n.extensionName],a=t.binary?2:1,c=t.compress;if("string"==typeof e?(i=Buffer.byteLength(e),s=!1):(i=(e=l(e)).length,s=l.readOnly),this._firstFragment?(this._firstFragment=!1,c&&o&&o.params[o._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(c=i>=o._threshold),this._compress=c):(c=!1,a=0),t.fin&&(this._firstFragment=!0),o){let n={[u]:i,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:a,readOnly:s,rsv1:c};this._deflating?this.enqueue([this.dispatch,e,this._compress,n,r]):this.dispatch(e,this._compress,n,r)}else this.sendFrame(h.frame(e,{[u]:i,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:a,readOnly:s,rsv1:!1}),r)}dispatch(e,t,r,i){if(!t){this.sendFrame(h.frame(e,r),i);return}let s=this._extensions[n.extensionName];this._bufferedBytes+=r[u],this._deflating=!0,s.compress(e,r.fin,(e,t)=>{if(this._socket.destroyed){let e=Error("The socket was closed while data was being compressed");"function"==typeof i&&i(e);for(let t=0;t<this._queue.length;t++){let r=this._queue[t],i=r[r.length-1];"function"==typeof i&&i(e)}return}this._bufferedBytes-=r[u],this._deflating=!1,r.readOnly=!1,this.sendFrame(h.frame(t,r),i),this.dequeue()})}dequeue(){for(;!this._deflating&&this._queue.length;){let e=this._queue.shift();this._bufferedBytes-=e[3][u],Reflect.apply(e[0],this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[3][u],this._queue.push(e)}sendFrame(e,t){2===e.length?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],t),this._socket.uncork()):this._socket.write(e[0],t)}};t.exports=h}}),n6=nz({"../common/temp/node_modules/.pnpm/ws@8.14.2_3cxu5zja4e2r5wmvge7mdcljwq/node_modules/ws/lib/event-target.js"(e,t){var{kForOnEventAttribute:r,kListener:i}=nJ(),n=Symbol("kCode"),s=Symbol("kData"),o=Symbol("kError"),a=Symbol("kMessage"),l=Symbol("kReason"),u=Symbol("kTarget"),c=Symbol("kType"),h=Symbol("kWasClean"),d=class{constructor(e){this[u]=null,this[c]=e}get target(){return this[u]}get type(){return this[c]}};Object.defineProperty(d.prototype,"target",{enumerable:!0}),Object.defineProperty(d.prototype,"type",{enumerable:!0});var f=class extends d{constructor(e,t={}){super(e),this[n]=void 0===t.code?0:t.code,this[l]=void 0===t.reason?"":t.reason,this[h]=void 0!==t.wasClean&&t.wasClean}get code(){return this[n]}get reason(){return this[l]}get wasClean(){return this[h]}};Object.defineProperty(f.prototype,"code",{enumerable:!0}),Object.defineProperty(f.prototype,"reason",{enumerable:!0}),Object.defineProperty(f.prototype,"wasClean",{enumerable:!0});var p=class extends d{constructor(e,t={}){super(e),this[o]=void 0===t.error?null:t.error,this[a]=void 0===t.message?"":t.message}get error(){return this[o]}get message(){return this[a]}};Object.defineProperty(p.prototype,"error",{enumerable:!0}),Object.defineProperty(p.prototype,"message",{enumerable:!0});var m=class extends d{constructor(e,t={}){super(e),this[s]=void 0===t.data?null:t.data}get data(){return this[s]}};function y(e,t,r){"object"==typeof e&&e.handleEvent?e.handleEvent.call(e,r):e.call(t,r)}Object.defineProperty(m.prototype,"data",{enumerable:!0}),t.exports={CloseEvent:f,ErrorEvent:p,Event:d,EventTarget:{addEventListener(e,t,n={}){let s;for(let s of this.listeners(e))if(!n[r]&&s[i]===t&&!s[r])return;if("message"===e)s=function(e,r){let i=new m("message",{data:r?e:e.toString()});i[u]=this,y(t,this,i)};else if("close"===e)s=function(e,r){let i=new f("close",{code:e,reason:r.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});i[u]=this,y(t,this,i)};else if("error"===e)s=function(e){let r=new p("error",{error:e,message:e.message});r[u]=this,y(t,this,r)};else{if("open"!==e)return;s=function(){let e=new d("open");e[u]=this,y(t,this,e)}}s[r]=!!n[r],s[i]=t,n.once?this.once(e,s):this.on(e,s)},removeEventListener(e,t){for(let n of this.listeners(e))if(n[i]===t&&!n[r]){this.removeListener(e,n);break}}},MessageEvent:m}}}),n7=nz({"../common/temp/node_modules/.pnpm/ws@8.14.2_3cxu5zja4e2r5wmvge7mdcljwq/node_modules/ws/lib/extension.js"(e,t){var{tokenChars:r}=n3();function i(e,t,r){void 0===e[t]?e[t]=[r]:e[t].push(r)}t.exports={format:function(e){return Object.keys(e).map(t=>{let r=e[t];return Array.isArray(r)||(r=[r]),r.map(e=>[t].concat(Object.keys(e).map(t=>{let r=e[t];return Array.isArray(r)||(r=[r]),r.map(e=>!0===e?t:`${t}=${e}`).join("; ")})).join("; ")).join(", ")}).join(", ")},parse:function(e){let t,n;let s=Object.create(null),o=Object.create(null),a=!1,l=!1,u=!1,c=-1,h=-1,d=-1,f=0;for(;f<e.length;f++)if(h=e.charCodeAt(f),void 0===t){if(-1===d&&1===r[h])-1===c&&(c=f);else if(0!==f&&(32===h||9===h))-1===d&&-1!==c&&(d=f);else if(59===h||44===h){if(-1===c)throw SyntaxError(`Unexpected character at index ${f}`);-1===d&&(d=f);let r=e.slice(c,d);44===h?(i(s,r,o),o=Object.create(null)):t=r,c=d=-1}else throw SyntaxError(`Unexpected character at index ${f}`)}else if(void 0===n){if(-1===d&&1===r[h])-1===c&&(c=f);else if(32===h||9===h)-1===d&&-1!==c&&(d=f);else if(59===h||44===h){if(-1===c)throw SyntaxError(`Unexpected character at index ${f}`);-1===d&&(d=f),i(o,e.slice(c,d),!0),44===h&&(i(s,t,o),o=Object.create(null),t=void 0),c=d=-1}else if(61===h&&-1!==c&&-1===d)n=e.slice(c,f),c=d=-1;else throw SyntaxError(`Unexpected character at index ${f}`)}else if(l){if(1!==r[h])throw SyntaxError(`Unexpected character at index ${f}`);-1===c?c=f:a||(a=!0),l=!1}else if(u){if(1===r[h])-1===c&&(c=f);else if(34===h&&-1!==c)u=!1,d=f;else if(92===h)l=!0;else throw SyntaxError(`Unexpected character at index ${f}`)}else if(34===h&&61===e.charCodeAt(f-1))u=!0;else if(-1===d&&1===r[h])-1===c&&(c=f);else if(-1!==c&&(32===h||9===h))-1===d&&(d=f);else if(59===h||44===h){if(-1===c)throw SyntaxError(`Unexpected character at index ${f}`);-1===d&&(d=f);let r=e.slice(c,d);a&&(r=r.replace(/\\/g,""),a=!1),i(o,n,r),44===h&&(i(s,t,o),o=Object.create(null),t=void 0),n=void 0,c=d=-1}else throw SyntaxError(`Unexpected character at index ${f}`);if(-1===c||u||32===h||9===h)throw SyntaxError("Unexpected end of input");-1===d&&(d=f);let p=e.slice(c,d);return void 0===t?i(s,p,o):(void 0===n?i(o,p,!0):a?i(o,n,p.replace(/\\/g,"")):i(o,n,p),i(s,t,o)),s}}}}),n9=nz({"../common/temp/node_modules/.pnpm/ws@8.14.2_3cxu5zja4e2r5wmvge7mdcljwq/node_modules/ws/lib/websocket.js"(e,t){var r=nH("events"),i=nH("https"),n=nH("http"),s=nH("net"),o=nH("tls"),{randomBytes:a,createHash:l}=nH("crypto"),{Duplex:u,Readable:c}=nH("stream"),{URL:h}=nH("url"),d=n1(),f=n4(),p=n5(),{BINARY_TYPES:m,EMPTY_BUFFER:y,GUID:g,kForOnEventAttribute:b,kListener:_,kStatusCode:v,kWebSocket:w,NOOP:S}=nJ(),{EventTarget:{addEventListener:A,removeEventListener:k}}=n6(),{format:E,parse:x}=n7(),{toBuffer:C}=nZ(),P=Symbol("kAborted"),T=[8,13],O=["CONNECTING","OPEN","CLOSING","CLOSED"],B=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/,R=class extends r{constructor(e,t,r){super(),this._binaryType=m[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=y,this._closeTimer=null,this._extensions={},this._paused=!1,this._protocol="",this._readyState=R.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,null!==e?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,void 0===t?t=[]:Array.isArray(t)||("object"==typeof t&&null!==t?(r=t,t=[]):t=[t]),function e(t,r,s,o){let u,c,f,p;let m={protocolVersion:T[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...o,createConnection:void 0,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(!T.includes(m.protocolVersion))throw RangeError(`Unsupported protocol version: ${m.protocolVersion} (supported versions: ${T.join(", ")})`);if(r instanceof h)u=r;else try{u=new h(r)}catch(e){throw SyntaxError(`Invalid URL: ${r}`)}"http:"===u.protocol?u.protocol="ws:":"https:"===u.protocol&&(u.protocol="wss:"),t._url=u.href;let y="wss:"===u.protocol,b="ws+unix:"===u.protocol;if("ws:"===u.protocol||y||b?b&&!u.pathname?c="The URL's pathname is empty":u.hash&&(c="The URL contains a fragment identifier"):c='The URL\'s protocol must be one of "ws:", "wss:", "http:", "https", or "ws+unix:"',c){let e=SyntaxError(c);if(0===t._redirects)throw e;I(t,e);return}let _=y?443:80,v=a(16).toString("base64"),w=y?i.request:n.request,S=new Set;if(m.createConnection=y?U:N,m.defaultPort=m.defaultPort||_,m.port=u.port||_,m.host=u.hostname.startsWith("[")?u.hostname.slice(1,-1):u.hostname,m.headers={...m.headers,"Sec-WebSocket-Version":m.protocolVersion,"Sec-WebSocket-Key":v,Connection:"Upgrade",Upgrade:"websocket"},m.path=u.pathname+u.search,m.timeout=m.handshakeTimeout,m.perMessageDeflate&&(f=new d(!0!==m.perMessageDeflate?m.perMessageDeflate:{},!1,m.maxPayload),m.headers["Sec-WebSocket-Extensions"]=E({[d.extensionName]:f.offer()})),s.length){for(let e of s){if("string"!=typeof e||!B.test(e)||S.has(e))throw SyntaxError("An invalid or duplicated subprotocol was specified");S.add(e)}m.headers["Sec-WebSocket-Protocol"]=s.join(",")}if(m.origin&&(m.protocolVersion<13?m.headers["Sec-WebSocket-Origin"]=m.origin:m.headers.Origin=m.origin),(u.username||u.password)&&(m.auth=`${u.username}:${u.password}`),b){let e=m.path.split(":");m.socketPath=e[0],m.path=e[1]}if(m.followRedirects){if(0===t._redirects){t._originalIpc=b,t._originalSecure=y,t._originalHostOrSocketPath=b?m.socketPath:u.host;let e=o&&o.headers;if(o={...o,headers:{}},e)for(let[t,r]of Object.entries(e))o.headers[t.toLowerCase()]=r}else if(0===t.listenerCount("redirect")){let e=b?!!t._originalIpc&&m.socketPath===t._originalHostOrSocketPath:!t._originalIpc&&u.host===t._originalHostOrSocketPath;e&&(!t._originalSecure||y)||(delete m.headers.authorization,delete m.headers.cookie,e||delete m.headers.host,m.auth=void 0)}m.auth&&!o.headers.authorization&&(o.headers.authorization="Basic "+Buffer.from(m.auth).toString("base64")),p=t._req=w(m),t._redirects&&t.emit("redirect",t.url,p)}else p=t._req=w(m);m.timeout&&p.on("timeout",()=>{L(t,p,"Opening handshake has timed out")}),p.on("error",e=>{null===p||p[P]||(p=t._req=null,I(t,e))}),p.on("response",i=>{let n=i.headers.location,a=i.statusCode;if(n&&m.followRedirects&&a>=300&&a<400){let i;if(++t._redirects>m.maxRedirects){L(t,p,"Maximum redirects exceeded");return}p.abort();try{i=new h(n,r)}catch(e){I(t,SyntaxError(`Invalid URL: ${n}`));return}e(t,i,s,o)}else t.emit("unexpected-response",p,i)||L(t,p,`Unexpected server response: ${i.statusCode}`)}),p.on("upgrade",(e,r,i)=>{let n;if(t.emit("upgrade",e),t.readyState!==R.CONNECTING)return;if(p=t._req=null,"websocket"!==e.headers.upgrade.toLowerCase()){L(t,r,"Invalid Upgrade header");return}let s=l("sha1").update(v+g).digest("base64");if(e.headers["sec-websocket-accept"]!==s){L(t,r,"Invalid Sec-WebSocket-Accept header");return}let o=e.headers["sec-websocket-protocol"];if(void 0!==o?S.size?S.has(o)||(n="Server sent an invalid subprotocol"):n="Server sent a subprotocol but none was requested":S.size&&(n="Server sent no subprotocol"),n){L(t,r,n);return}o&&(t._protocol=o);let a=e.headers["sec-websocket-extensions"];if(void 0!==a){let e;if(!f){L(t,r,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");return}try{e=x(a)}catch(e){L(t,r,"Invalid Sec-WebSocket-Extensions header");return}let i=Object.keys(e);if(1!==i.length||i[0]!==d.extensionName){L(t,r,"Server indicated an extension that was not requested");return}try{f.accept(e[d.extensionName])}catch(e){L(t,r,"Invalid Sec-WebSocket-Extensions header");return}t._extensions[d.extensionName]=f}t.setSocket(r,i,{generateMask:m.generateMask,maxPayload:m.maxPayload,skipUTF8Validation:m.skipUTF8Validation})}),m.finishRequest?m.finishRequest(p,t):p.end()}(this,e,t,r)):this._isServer=!0}get binaryType(){return this._binaryType}set binaryType(e){m.includes(e)&&(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(e,t,r){let i=new f({binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:r.maxPayload,skipUTF8Validation:r.skipUTF8Validation});this._sender=new p(e,this._extensions,r.generateMask),this._receiver=i,this._socket=e,i[w]=this,e[w]=this,i.on("conclude",K),i.on("drain",D),i.on("error",M),i.on("message",q),i.on("ping",H),i.on("pong",z),e.setTimeout&&e.setTimeout(0),e.setNoDelay&&e.setNoDelay(),t.length>0&&e.unshift(t),e.on("close",V),e.on("data",W),e.on("end",J),e.on("error",G),this._readyState=R.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=R.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}this._extensions[d.extensionName]&&this._extensions[d.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=R.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(e,t){if(this.readyState!==R.CLOSED){if(this.readyState===R.CONNECTING){L(this,this._req,"WebSocket was closed before the connection was established");return}if(this.readyState===R.CLOSING){this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();return}this._readyState=R.CLOSING,this._sender.close(e,t,!this._isServer,e=>{!e&&(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),this._closeTimer=setTimeout(this._socket.destroy.bind(this._socket),3e4)}}pause(){this.readyState!==R.CONNECTING&&this.readyState!==R.CLOSED&&(this._paused=!0,this._socket.pause())}ping(e,t,r){if(this.readyState===R.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof e?(r=e,e=t=void 0):"function"==typeof t&&(r=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState!==R.OPEN){j(this,e,r);return}void 0===t&&(t=!this._isServer),this._sender.ping(e||y,t,r)}pong(e,t,r){if(this.readyState===R.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof e?(r=e,e=t=void 0):"function"==typeof t&&(r=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState!==R.OPEN){j(this,e,r);return}void 0===t&&(t=!this._isServer),this._sender.pong(e||y,t,r)}resume(){this.readyState!==R.CONNECTING&&this.readyState!==R.CLOSED&&(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(e,t,r){if(this.readyState===R.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof t&&(r=t,t={}),"number"==typeof e&&(e=e.toString()),this.readyState!==R.OPEN){j(this,e,r);return}let i={binary:"string"!=typeof e,mask:!this._isServer,compress:!0,fin:!0,...t};this._extensions[d.extensionName]||(i.compress=!1),this._sender.send(e||y,i,r)}terminate(){if(this.readyState!==R.CLOSED){if(this.readyState===R.CONNECTING){L(this,this._req,"WebSocket was closed before the connection was established");return}this._socket&&(this._readyState=R.CLOSING,this._socket.destroy())}}};function I(e,t){e._readyState=R.CLOSING,e.emit("error",t),e.emitClose()}function N(e){return e.path=e.socketPath,s.connect(e)}function U(e){return e.path=void 0,e.servername||""===e.servername||(e.servername=s.isIP(e.host)?"":e.host),o.connect(e)}function L(e,t,r){e._readyState=R.CLOSING;let i=Error(r);Error.captureStackTrace(i,L),t.setHeader?(t[P]=!0,t.abort(),t.socket&&!t.socket.destroyed&&t.socket.destroy(),process.nextTick(I,e,i)):(t.destroy(i),t.once("error",e.emit.bind(e,"error")),t.once("close",e.emitClose.bind(e)))}function j(e,t,r){if(t){let r=C(t).length;e._socket?e._sender._bufferedBytes+=r:e._bufferedAmount+=r}if(r){let t=Error(`WebSocket is not open: readyState ${e.readyState} (${O[e.readyState]})`);process.nextTick(r,t)}}function K(e,t){let r=this[w];r._closeFrameReceived=!0,r._closeMessage=t,r._closeCode=e,void 0!==r._socket[w]&&(r._socket.removeListener("data",W),process.nextTick(F,r._socket),1005===e?r.close():r.close(e,t))}function D(){let e=this[w];e.isPaused||e._socket.resume()}function M(e){let t=this[w];void 0!==t._socket[w]&&(t._socket.removeListener("data",W),process.nextTick(F,t._socket),t.close(e[v])),t.emit("error",e)}function $(){this[w].emitClose()}function q(e,t){this[w].emit("message",e,t)}function H(e){let t=this[w];t.pong(e,!t._isServer,S),t.emit("ping",e)}function z(e){this[w].emit("pong",e)}function F(e){e.resume()}function V(){let e;let t=this[w];this.removeListener("close",V),this.removeListener("data",W),this.removeListener("end",J),t._readyState=R.CLOSING,this._readableState.endEmitted||t._closeFrameReceived||t._receiver._writableState.errorEmitted||null===(e=t._socket.read())||t._receiver.write(e),t._receiver.end(),this[w]=void 0,clearTimeout(t._closeTimer),t._receiver._writableState.finished||t._receiver._writableState.errorEmitted?t.emitClose():(t._receiver.on("error",$),t._receiver.on("finish",$))}function W(e){this[w]._receiver.write(e)||this.pause()}function J(){let e=this[w];e._readyState=R.CLOSING,e._receiver.end(),this.end()}function G(){let e=this[w];this.removeListener("error",G),this.on("error",S),e&&(e._readyState=R.CLOSING,this.destroy())}Object.defineProperty(R,"CONNECTING",{enumerable:!0,value:O.indexOf("CONNECTING")}),Object.defineProperty(R.prototype,"CONNECTING",{enumerable:!0,value:O.indexOf("CONNECTING")}),Object.defineProperty(R,"OPEN",{enumerable:!0,value:O.indexOf("OPEN")}),Object.defineProperty(R.prototype,"OPEN",{enumerable:!0,value:O.indexOf("OPEN")}),Object.defineProperty(R,"CLOSING",{enumerable:!0,value:O.indexOf("CLOSING")}),Object.defineProperty(R.prototype,"CLOSING",{enumerable:!0,value:O.indexOf("CLOSING")}),Object.defineProperty(R,"CLOSED",{enumerable:!0,value:O.indexOf("CLOSED")}),Object.defineProperty(R.prototype,"CLOSED",{enumerable:!0,value:O.indexOf("CLOSED")}),["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach(e=>{Object.defineProperty(R.prototype,e,{enumerable:!0})}),["open","error","close","message"].forEach(e=>{Object.defineProperty(R.prototype,`on${e}`,{enumerable:!0,get(){for(let t of this.listeners(e))if(t[b])return t[_];return null},set(t){for(let t of this.listeners(e))if(t[b]){this.removeListener(e,t);break}"function"==typeof t&&this.addEventListener(e,t,{[b]:!0})}})}),R.prototype.addEventListener=A,R.prototype.removeEventListener=k,t.exports=R}}),se=nz({"../common/temp/node_modules/.pnpm/ws@8.14.2_3cxu5zja4e2r5wmvge7mdcljwq/node_modules/ws/lib/subprotocol.js"(e,t){var{tokenChars:r}=n3();t.exports={parse:function(e){let t=new Set,i=-1,n=-1,s=0;for(;s<e.length;s++){let o=e.charCodeAt(s);if(-1===n&&1===r[o])-1===i&&(i=s);else if(0!==s&&(32===o||9===o))-1===n&&-1!==i&&(n=s);else if(44===o){if(-1===i)throw SyntaxError(`Unexpected character at index ${s}`);-1===n&&(n=s);let r=e.slice(i,n);if(t.has(r))throw SyntaxError(`The "${r}" subprotocol is duplicated`);t.add(r),i=n=-1}else throw SyntaxError(`Unexpected character at index ${s}`)}if(-1===i||-1!==n)throw SyntaxError("Unexpected end of input");let o=e.slice(i,s);if(t.has(o))throw SyntaxError(`The "${o}" subprotocol is duplicated`);return t.add(o),t}}}}),st=nz({"../common/temp/node_modules/.pnpm/ws@8.14.2_3cxu5zja4e2r5wmvge7mdcljwq/node_modules/ws/lib/websocket-server.js"(e,t){var r=nH("events"),i=nH("http"),{Duplex:n}=nH("stream"),{createHash:s}=nH("crypto"),o=n7(),a=n1(),l=se(),u=n9(),{GUID:c,kWebSocket:h}=nJ(),d=/^[+/0-9A-Za-z]{22}==$/,f=class extends r{constructor(e,t){if(super(),null==(e={maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:u,...e}).port&&!e.server&&!e.noServer||null!=e.port&&(e.server||e.noServer)||e.server&&e.noServer)throw TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(null!=e.port?(this._server=i.createServer((e,t)=>{let r=i.STATUS_CODES[426];t.writeHead(426,{"Content-Length":r.length,"Content-Type":"text/plain"}),t.end(r)}),this._server.listen(e.port,e.host,e.backlog,t)):e.server&&(this._server=e.server),this._server){let e=this.emit.bind(this,"connection");this._removeListeners=function(e,t){for(let r of Object.keys(t))e.on(r,t[r]);return function(){for(let r of Object.keys(t))e.removeListener(r,t[r])}}(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(t,r,i)=>{this.handleUpgrade(t,r,i,e)}})}!0===e.perMessageDeflate&&(e.perMessageDeflate={}),e.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=e,this._state=0}address(){if(this.options.noServer)throw Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(e){if(2===this._state){e&&this.once("close",()=>{e(Error("The server is not running"))}),process.nextTick(p,this);return}if(e&&this.once("close",e),1!==this._state){if(this._state=1,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients&&this.clients.size?this._shouldEmitClose=!0:process.nextTick(p,this);else{let e=this._server;this._removeListeners(),this._removeListeners=this._server=null,e.close(()=>{p(this)})}}}shouldHandle(e){if(this.options.path){let t=e.url.indexOf("?");if((-1!==t?e.url.slice(0,t):e.url)!==this.options.path)return!1}return!0}handleUpgrade(e,t,r,i){t.on("error",m);let n=e.headers["sec-websocket-key"],s=+e.headers["sec-websocket-version"];if("GET"!==e.method){g(this,e,t,405,"Invalid HTTP method");return}if("websocket"!==e.headers.upgrade.toLowerCase()){g(this,e,t,400,"Invalid Upgrade header");return}if(!n||!d.test(n)){g(this,e,t,400,"Missing or invalid Sec-WebSocket-Key header");return}if(8!==s&&13!==s){g(this,e,t,400,"Missing or invalid Sec-WebSocket-Version header");return}if(!this.shouldHandle(e)){y(t,400);return}let u=e.headers["sec-websocket-protocol"],c=new Set;if(void 0!==u)try{c=l.parse(u)}catch(r){g(this,e,t,400,"Invalid Sec-WebSocket-Protocol header");return}let h=e.headers["sec-websocket-extensions"],f={};if(this.options.perMessageDeflate&&void 0!==h){let r=new a(this.options.perMessageDeflate,!0,this.options.maxPayload);try{let e=o.parse(h);e[a.extensionName]&&(r.accept(e[a.extensionName]),f[a.extensionName]=r)}catch(r){g(this,e,t,400,"Invalid or unacceptable Sec-WebSocket-Extensions header");return}}if(this.options.verifyClient){let o={origin:e.headers[`${8===s?"sec-websocket-origin":"origin"}`],secure:!!(e.socket.authorized||e.socket.encrypted),req:e};if(2===this.options.verifyClient.length){this.options.verifyClient(o,(s,o,a,l)=>{if(!s)return y(t,o||401,a,l);this.completeUpgrade(f,n,c,e,t,r,i)});return}if(!this.options.verifyClient(o))return y(t,401)}this.completeUpgrade(f,n,c,e,t,r,i)}completeUpgrade(e,t,r,i,n,l,u){if(!n.readable||!n.writable)return n.destroy();if(n[h])throw Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>0)return y(n,503);let d=s("sha1").update(t+c).digest("base64"),f=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${d}`],g=new this.options.WebSocket(null);if(r.size){let e=this.options.handleProtocols?this.options.handleProtocols(r,i):r.values().next().value;e&&(f.push(`Sec-WebSocket-Protocol: ${e}`),g._protocol=e)}if(e[a.extensionName]){let t=e[a.extensionName].params,r=o.format({[a.extensionName]:[t]});f.push(`Sec-WebSocket-Extensions: ${r}`),g._extensions=e}this.emit("headers",f,i),n.write(f.concat("\r\n").join("\r\n")),n.removeListener("error",m),g.setSocket(n,l,{maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(g),g.on("close",()=>{this.clients.delete(g),this._shouldEmitClose&&!this.clients.size&&process.nextTick(p,this)})),u(g,i)}};function p(e){e._state=2,e.emit("close")}function m(){this.destroy()}function y(e,t,r,n){r=r||i.STATUS_CODES[t],n={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(r),...n},e.once("finish",e.destroy),e.end(`HTTP/1.1 ${t} ${i.STATUS_CODES[t]}\r
`+Object.keys(n).map(e=>`${e}: ${n[e]}`).join("\r\n")+"\r\n\r\n"+r)}function g(e,t,r,i,n){if(e.listenerCount("wsClientError")){let i=Error(n);Error.captureStackTrace(i,g),e.emit("wsClientError",i,r,t)}else y(r,i,n)}t.exports=f}});nV(nW(),1),nV(n4(),1),nV(n5(),1);var sr=nV(n9(),1);function si(e,t){if("undefined"==typeof Convex||void 0===Convex.syscall)throw Error("The Convex database and auth objects are being used outside of a Convex backend. Did you mean to use `useQuery` or `useMutation` to call a Convex function?");return JSON.parse(Convex.syscall(e,JSON.stringify(t)))}async function sn(e,t){let r;if("undefined"==typeof Convex||void 0===Convex.asyncSyscall)throw Error("The Convex database and auth objects are being used outside of a Convex backend. Did you mean to use `useQuery` or `useMutation` to call a Convex function?");try{r=await Convex.asyncSyscall(e,JSON.stringify(t))}catch(e){if(void 0!==e.data){let t=new n_(e.message);throw t.data=nu(e.data),t}throw Error(e.message)}return JSON.parse(r)}nV(st(),1),sr.default,void 0===globalThis.fetch&&(i=(...e)=>r.e(319).then(r.bind(r,319)).then(({default:t})=>t(...e)));class ss{constructor(){}}class so extends ss{constructor(e){super(),this.inner=e}serialize(){return this.inner}}function sa(e){return e instanceof so?e.serialize():{$literal:nm(e)}}class sl{constructor(){}}class su extends sl{constructor(e){super(),this.inner=e}serialize(){return this.inner}}function sc(e){return e instanceof su?e.serialize():{$literal:nm(e)}}let sh={eq:(e,t)=>new su({$eq:[sc(e),sc(t)]}),neq:(e,t)=>new su({$neq:[sc(e),sc(t)]}),lt:(e,t)=>new su({$lt:[sc(e),sc(t)]}),lte:(e,t)=>new su({$lte:[sc(e),sc(t)]}),gt:(e,t)=>new su({$gt:[sc(e),sc(t)]}),gte:(e,t)=>new su({$gte:[sc(e),sc(t)]}),add:(e,t)=>new su({$add:[sc(e),sc(t)]}),sub:(e,t)=>new su({$sub:[sc(e),sc(t)]}),mul:(e,t)=>new su({$mul:[sc(e),sc(t)]}),div:(e,t)=>new su({$div:[sc(e),sc(t)]}),mod:(e,t)=>new su({$mod:[sc(e),sc(t)]}),neg:e=>new su({$neg:sc(e)}),and:(...e)=>new su({$and:e.map(sc)}),or:(...e)=>new su({$or:e.map(sc)}),not:e=>new su({$not:sc(e)}),field:e=>new su({$field:e})};class sd{constructor(){}}class sf extends sd{constructor(e){super(),this.rangeExpressions=e,this.isConsumed=!1}static new(){return new sf([])}consume(){if(this.isConsumed)throw Error("IndexRangeBuilder has already been used! Chain your method calls like `q => q.eq(...).eq(...)`. See https://docs.convex.dev/using/indexes");this.isConsumed=!0}eq(e,t){return this.consume(),new sf(this.rangeExpressions.concat({type:"Eq",fieldPath:e,value:nm(t)}))}gt(e,t){return this.consume(),new sf(this.rangeExpressions.concat({type:"Gt",fieldPath:e,value:np(t)}))}gte(e,t){return this.consume(),new sf(this.rangeExpressions.concat({type:"Gte",fieldPath:e,value:np(t)}))}lt(e,t){return this.consume(),new sf(this.rangeExpressions.concat({type:"Lt",fieldPath:e,value:np(t)}))}lte(e,t){return this.consume(),new sf(this.rangeExpressions.concat({type:"Lte",fieldPath:e,value:np(t)}))}export(){return this.consume(),this.rangeExpressions}}class sp{constructor(){}}function sm(e,t,r,i){if(void 0===e)throw Error(`Must provide arg ${t} \`${i}\` to \`${r}\``)}class sy extends sp{constructor(e){super(),this.filters=e,this.isConsumed=!1}static new(){return new sy([])}consume(){if(this.isConsumed)throw Error("SearchFilterBuilder has already been used! Chain your method calls like `q => q.search(...).eq(...)`.");this.isConsumed=!0}search(e,t){return sm(e,1,"search","fieldName"),sm(t,2,"search","query"),this.consume(),new sy(this.filters.concat({type:"Search",fieldPath:e,value:t}))}eq(e,t){return sm(e,1,"eq","fieldName"),2!=arguments.length&&sm(t,2,"search","value"),this.consume(),new sy(this.filters.concat({type:"Eq",fieldPath:e,value:nm(t)}))}export(){return this.consume(),this.filters}}function sg(e){throw Error("consumed"===e?"This query is closed and can't emit any more values.":"This query has been chained with another operator and can't be reused.")}Symbol.asyncIterator;class sb{constructor(e){this.state={type:"preparing",query:e}}takeQuery(){if("preparing"!==this.state.type)throw Error("A query can only be chained once and can't be chained after iteration begins.");let e=this.state.query;return this.state={type:"closed"},e}startQuery(){if("executing"===this.state.type)throw Error("Iteration can only begin on a query once.");("closed"===this.state.type||"consumed"===this.state.type)&&sg(this.state.type);let{queryId:e}=si("1.0/queryStream",{query:this.state.query,version:nR});return this.state={type:"executing",queryId:e},e}closeQuery(){"executing"===this.state.type&&si("1.0/queryCleanup",{queryId:this.state.queryId}),this.state={type:"consumed"}}order(e){sm(e,1,"order","order");let t=this.takeQuery();if("Search"===t.source.type)throw Error("Search queries must always be in relevance order. Can not set order manually.");if(null!==t.source.order)throw Error("Queries may only specify order at most once");return t.source.order=e,new sb(t)}filter(e){sm(e,1,"filter","predicate");let t=this.takeQuery();return t.operators.push({filter:sc(e(sh))}),new sb(t)}limit(e){sm(e,1,"limit","n");let t=this.takeQuery();return t.operators.push({limit:e}),new sb(t)}[Symbol.asyncIterator](){return this.startQuery(),this}async next(){("closed"===this.state.type||"consumed"===this.state.type)&&sg(this.state.type);let e="preparing"===this.state.type?this.startQuery():this.state.queryId,{value:t,done:r}=await sn("1.0/queryStreamNext",{queryId:e});return r&&this.closeQuery(),{value:nu(t),done:r}}return(){return this.closeQuery(),Promise.resolve({done:!0,value:void 0})}async paginate(e){if(sm(e,1,"paginate","options"),"number"!=typeof e?.numItems||e.numItems<0)throw Error(`\`options.numItems\` must be a positive number. Received \`${e?.numItems}\`.`);let t=this.takeQuery(),r=e.numItems,i=e.cursor,n=e?.endCursor??null,s=e.maximumRowsRead??null,{page:o,isDone:a,continueCursor:l,splitCursor:u,pageStatus:c}=await sn("1.0/queryPage",{query:t,cursor:i,endCursor:n,pageSize:r,maximumRowsRead:s,maximumBytesRead:e.maximumBytesRead,version:nR});return{page:o.map(e=>nu(e)),isDone:a,continueCursor:l,splitCursor:u,pageStatus:c}}async collect(){let e=[];for await(let t of this)e.push(t);return e}async take(e){return sm(e,1,"take","n"),this.limit(e).collect()}async first(){let e=await this.take(1);return 0===e.length?null:e[0]}async unique(){let e=await this.take(2);if(0===e.length)return null;if(2===e.length)throw Error("unique() query returned more than one result");return e[0]}}ng.object({numItems:ng.number(),cursor:ng.union(ng.string(),ng.null()),endCursor:ng.optional(ng.union(ng.string(),ng.null())),id:ng.optional(ng.number()),maximumRowsRead:ng.optional(ng.number()),maximumBytesRead:ng.optional(ng.number())});class s_{constructor(e){this.indexes=[],this.searchIndexes=[],this.vectorIndexes=[],this.documentType=e}index(e,t){return this.indexes.push({indexDescriptor:e,fields:t}),this}searchIndex(e,t){return this.searchIndexes.push({indexDescriptor:e,searchField:t.searchField,filterFields:t.filterFields||[]}),this}vectorIndex(e,t){return this.vectorIndexes.push({indexDescriptor:e,vectorField:t.vectorField,dimensions:t.dimensions,filterFields:t.filterFields||[]}),this}self(){return this}export(){return{indexes:this.indexes,searchIndexes:this.searchIndexes,vectorIndexes:this.vectorIndexes,documentType:this.documentType.json}}}function sv(e){return new s_(e instanceof ny?e:ng.object(e))}class sw{constructor(e,t){this.tables=e,this.schemaValidation=t?.schemaValidation===void 0||t.schemaValidation}export(){return JSON.stringify({tables:Object.entries(this.tables).map(([e,t])=>{let{indexes:r,searchIndexes:i,vectorIndexes:n,documentType:s}=t.export();return{tableName:e,indexes:r,searchIndexes:i,vectorIndexes:n,documentType:s}}),schemaValidation:this.schemaValidation})}}new sw({_scheduled_functions:sv({name:ng.string(),args:ng.array(ng.any()),scheduledTime:ng.float64(),completedTime:ng.optional(ng.float64()),state:ng.union(ng.object({kind:ng.literal("pending")}),ng.object({kind:ng.literal("inProgress")}),ng.object({kind:ng.literal("success")}),ng.object({kind:ng.literal("failed"),error:ng.string()}),ng.object({kind:ng.literal("canceled")}))}),_storage:sv({sha256:ng.string(),size:ng.float64(),contentType:ng.optional(ng.string())})},void 0);let sS=new nN("https://dynamic-llama-701.convex.cloud"),sA=new iQ({secret:"sk_dev_yUbx_RQ09s6bIzwCjH7-s_YgIF48efOY80FB_64wcRGleZvBEJ1YO60U4de18XP2"});async function sk(e){let t=rT(),r=await rB();if(!t||!r)return new ry.Z("Unauthorized.",{status:403});let{room:i}=await e.json(),n=await sS.query(nS.board.get,{id:i});if(n?.orgId!==t.orgId)return new ry.Z("Unauthorized.",{status:403});let s={name:r.firstName||"Teammate",picture:r.imageUrl},o=sA.prepareSession(r.id,{userInfo:s});if(i){o.allow(i,o.FULL_ACCESS);let{status:e,body:t}=await o.authorize();return new Response(t,{status:e})}}let sE=new p.AppRouteRouteModule({definition:{kind:m.x.APP_ROUTE,page:"/api/liveblocks-auth/route",pathname:"/api/liveblocks-auth",filename:"route",bundlePath:"app/api/liveblocks-auth/route"},resolvedPagePath:"/home/homenok/LastHap/miro-clone/app/api/liveblocks-auth/route.ts",nextConfigOutput:"",userland:f}),{requestAsyncStorage:sx,staticGenerationAsyncStorage:sC,serverHooks:sP,headerHooks:sT,staticGenerationBailout:sO}=sE,sB="/api/liveblocks-auth/route";function sR(){return(0,y.patchFetch)({serverHooks:sP,staticGenerationAsyncStorage:sC})}},52743:(e,t,r)=>{let i;try{(i=r(6005).webcrypto)||(i=new(r(50250)).w)}catch(e){i=new(r(50250)).w}e.exports=i},27988:(e,t,r)=>{let{fetch:i,Blob:n,FormData:s,Headers:o,Request:a,Response:l,AbortController:u}=r(41434);e.exports=i,e.exports.RuntimeBlob=n,e.exports.RuntimeFormData=s,e.exports.RuntimeHeaders=o,e.exports.RuntimeRequest=a,e.exports.RuntimeResponse=l,e.exports.RuntimeAbortController=u,e.exports.RuntimeFetch=i},50250:(e,t,r)=>{r.d(t,{w:()=>iQ});var i,n,s,o={};r.r(o),r.d(o,{Any:()=>eM,BaseBlock:()=>M,BaseStringBlock:()=>$,BitString:()=>er,BmpString:()=>ew,Boolean:()=>Q,CharacterString:()=>eR,Choice:()=>e$,Constructed:()=>W,DATE:()=>eU,DateTime:()=>ej,Duration:()=>eK,EndOfContent:()=>G,Enumerated:()=>eo,GeneralString:()=>eB,GeneralizedTime:()=>eN,GraphicString:()=>eT,HexBlock:()=>N,IA5String:()=>eP,Integer:()=>es,Null:()=>Y,NumericString:()=>ek,ObjectIdentifier:()=>eu,OctetString:()=>ee,Primitive:()=>H,PrintableString:()=>eE,RawData:()=>eH,RelativeObjectIdentifier:()=>ed,Repeated:()=>eq,Sequence:()=>ef,Set:()=>ep,TIME:()=>eD,TeletexString:()=>ex,TimeOfDay:()=>eL,UTCTime:()=>eI,UniversalString:()=>eA,Utf8String:()=>e_,ValueBlock:()=>L,VideotexString:()=>eC,ViewWriter:()=>k,VisibleString:()=>eO,compareSchema:()=>ez,fromBER:()=>F,verifySchema:()=>eF});class a{static isArrayBuffer(e){return"[object ArrayBuffer]"===Object.prototype.toString.call(e)}static toArrayBuffer(e){return this.isArrayBuffer(e)?e:e.byteLength===e.buffer.byteLength||0===e.byteOffset&&e.byteLength===e.buffer.byteLength?e.buffer:this.toUint8Array(e.buffer).slice(e.byteOffset,e.byteOffset+e.byteLength).buffer}static toUint8Array(e){return this.toView(e,Uint8Array)}static toView(e,t){if(e.constructor===t)return e;if(this.isArrayBuffer(e))return new t(e);if(this.isArrayBufferView(e))return new t(e.buffer,e.byteOffset,e.byteLength);throw TypeError("The provided value is not of type '(ArrayBuffer or ArrayBufferView)'")}static isBufferSource(e){return this.isArrayBufferView(e)||this.isArrayBuffer(e)}static isArrayBufferView(e){return ArrayBuffer.isView(e)||e&&this.isArrayBuffer(e.buffer)}static isEqual(e,t){let r=a.toUint8Array(e),i=a.toUint8Array(t);if(r.length!==i.byteLength)return!1;for(let e=0;e<r.length;e++)if(r[e]!==i[e])return!1;return!0}static concat(...e){let t;t=!Array.isArray(e[0])||e[1]instanceof Function?Array.isArray(e[0])&&e[1]instanceof Function?e[0]:e[e.length-1]instanceof Function?e.slice(0,e.length-1):e:e[0];let r=0;for(let e of t)r+=e.byteLength;let i=new Uint8Array(r),n=0;for(let e of t){let t=this.toUint8Array(e);i.set(t,n),n+=t.length}return e[e.length-1]instanceof Function?this.toView(i,e[e.length-1]):i.buffer}}let l="string",u=/^[0-9a-f]+$/i,c=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/,h=/^[a-zA-Z0-9-_]+$/;class d{static fromString(e){let t=unescape(encodeURIComponent(e)),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r.buffer}static toString(e){let t=a.toUint8Array(e),r="";for(let e=0;e<t.length;e++)r+=String.fromCharCode(t[e]);return decodeURIComponent(escape(r))}}class f{static toString(e,t=!1){let r=a.toArrayBuffer(e),i=new DataView(r),n="";for(let e=0;e<r.byteLength;e+=2)n+=String.fromCharCode(i.getUint16(e,t));return n}static fromString(e,t=!1){let r=new ArrayBuffer(2*e.length),i=new DataView(r);for(let r=0;r<e.length;r++)i.setUint16(2*r,e.charCodeAt(r),t);return r}}class p{static isHex(e){return typeof e===l&&u.test(e)}static isBase64(e){return typeof e===l&&c.test(e)}static isBase64Url(e){return typeof e===l&&h.test(e)}static ToString(e,t="utf8"){let r=a.toUint8Array(e);switch(t.toLowerCase()){case"utf8":return this.ToUtf8String(r);case"binary":return this.ToBinary(r);case"hex":return this.ToHex(r);case"base64":return this.ToBase64(r);case"base64url":return this.ToBase64Url(r);case"utf16le":return f.toString(r,!0);case"utf16":case"utf16be":return f.toString(r);default:throw Error(`Unknown type of encoding '${t}'`)}}static FromString(e,t="utf8"){if(!e)return new ArrayBuffer(0);switch(t.toLowerCase()){case"utf8":return this.FromUtf8String(e);case"binary":return this.FromBinary(e);case"hex":return this.FromHex(e);case"base64":return this.FromBase64(e);case"base64url":return this.FromBase64Url(e);case"utf16le":return f.fromString(e,!0);case"utf16":case"utf16be":return f.fromString(e);default:throw Error(`Unknown type of encoding '${t}'`)}}static ToBase64(e){let t=a.toUint8Array(e);return"undefined"!=typeof btoa?btoa(this.ToString(t,"binary")):Buffer.from(t).toString("base64")}static FromBase64(e){let t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!p.isBase64(t))throw TypeError("Argument 'base64Text' is not Base64 encoded");return"undefined"!=typeof atob?this.FromBinary(atob(t)):new Uint8Array(Buffer.from(t,"base64")).buffer}static FromBase64Url(e){let t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!p.isBase64Url(t))throw TypeError("Argument 'base64url' is not Base64Url encoded");return this.FromBase64(this.Base64Padding(t.replace(/\-/g,"+").replace(/\_/g,"/")))}static ToBase64Url(e){return this.ToBase64(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}static FromUtf8String(e,t=p.DEFAULT_UTF8_ENCODING){switch(t){case"ascii":return this.FromBinary(e);case"utf8":return d.fromString(e);case"utf16":case"utf16be":return f.fromString(e);case"utf16le":case"usc2":return f.fromString(e,!0);default:throw Error(`Unknown type of encoding '${t}'`)}}static ToUtf8String(e,t=p.DEFAULT_UTF8_ENCODING){switch(t){case"ascii":return this.ToBinary(e);case"utf8":return d.toString(e);case"utf16":case"utf16be":return f.toString(e);case"utf16le":case"usc2":return f.toString(e,!0);default:throw Error(`Unknown type of encoding '${t}'`)}}static FromBinary(e){let t=e.length,r=new Uint8Array(t);for(let i=0;i<t;i++)r[i]=e.charCodeAt(i);return r.buffer}static ToBinary(e){let t=a.toUint8Array(e),r="";for(let e=0;e<t.length;e++)r+=String.fromCharCode(t[e]);return r}static ToHex(e){let t=a.toUint8Array(e),r="",i=t.length;for(let e=0;e<i;e++){let i=t[e];i<16&&(r+="0"),r+=i.toString(16)}return r}static FromHex(e){let t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!p.isHex(t))throw TypeError("Argument 'hexString' is not HEX encoded");t.length%2&&(t=`0${t}`);let r=new Uint8Array(t.length/2);for(let e=0;e<t.length;e+=2){let i=t.slice(e,e+2);r[e/2]=parseInt(i,16)}return r.buffer}static ToUtf16String(e,t=!1){return f.toString(e,t)}static FromUtf16String(e,t=!1){return f.fromString(e,t)}static Base64Padding(e){let t=4-e.length%4;if(t<4)for(let r=0;r<t;r++)e+="=";return e}static formatString(e){return(null==e?void 0:e.replace(/[\n\r\t ]/g,""))||""}}function m(...e){let t=e.map(e=>e.byteLength).reduce((e,t)=>e+t),r=new Uint8Array(t),i=0;return e.map(e=>new Uint8Array(e)).forEach(e=>{for(let t of e)r[i++]=t}),r.buffer}function y(e,t){let r=0;if(1===e.length)return e[0];for(let i=e.length-1;i>=0;i--)r+=e[e.length-1-i]*Math.pow(2,t*i);return r}function g(e,t,r=-1){let i=e,n=0,s=Math.pow(2,t);for(let o=1;o<8;o++){if(e<s){let e;if(r<0)e=new ArrayBuffer(o),n=o;else{if(r<o)return new ArrayBuffer(0);e=new ArrayBuffer(r),n=r}let s=new Uint8Array(e);for(let e=o-1;e>=0;e--){let r=Math.pow(2,e*t);s[n-e-1]=Math.floor(i/r),i-=s[n-e-1]*r}return e}s*=Math.pow(2,t)}return new ArrayBuffer(0)}function b(...e){let t=0,r=0;for(let r of e)t+=r.length;let i=new ArrayBuffer(t),n=new Uint8Array(i);for(let t of e)n.set(t,r),r+=t.length;return n}function _(){let e=new Uint8Array(this.valueHex);if(this.valueHex.byteLength>=2){let t=255===e[0]&&128&e[1],r=0===e[0]&&(128&e[1])==0;(t||r)&&this.warnings.push("Needlessly long format")}let t=new ArrayBuffer(this.valueHex.byteLength),r=new Uint8Array(t);for(let e=0;e<this.valueHex.byteLength;e++)r[e]=0;r[0]=128&e[0];let i=y(r,8),n=new ArrayBuffer(this.valueHex.byteLength),s=new Uint8Array(n);for(let t=0;t<this.valueHex.byteLength;t++)s[t]=e[t];return s[0]&=127,y(s,8)-i}function v(e,t){let r=e.toString(10);if(t<r.length)return"";let i=t-r.length,n=Array(i);for(let e=0;e<i;e++)n[e]="0";return n.join("").concat(r)}/*!
 * Copyright (c) 2014, GMO GlobalSign
 * Copyright (c) 2015-2022, Peculiar Ventures
 * All rights reserved.
 * 
 * Author 2014-2019, Yury Strozhevsky
 * 
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 * 
 * * Redistributions of source code must retain the above copyright notice, this
 *   list of conditions and the following disclaimer.
 * 
 * * Redistributions in binary form must reproduce the above copyright notice, this
 *   list of conditions and the following disclaimer in the documentation and/or
 *   other materials provided with the distribution.
 * 
 * * Neither the name of the copyright holder nor the names of its
 *   contributors may be used to endorse or promote products derived from
 *   this software without specific prior written permission.
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR
 * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
 * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 * 
 */function w(){if("undefined"==typeof BigInt)throw Error("BigInt is not defined. Your environment doesn't implement BigInt.")}function S(e){let t=0,r=0;for(let r=0;r<e.length;r++)t+=e[r].byteLength;let i=new Uint8Array(t);for(let t=0;t<e.length;t++){let n=e[t];i.set(new Uint8Array(n),r),r+=n.byteLength}return i.buffer}function A(e,t,r,i){return t instanceof Uint8Array?t.byteLength?r<0?(e.error="Wrong parameter: inputOffset less than zero",!1):i<0?(e.error="Wrong parameter: inputLength less than zero",!1):!(t.byteLength-r-i<0)||(e.error="End of input reached before message was fully decoded (inconsistent offset and length values)",!1):(e.error="Wrong parameter: inputBuffer has zero length",!1):(e.error="Wrong parameter: inputBuffer must be 'Uint8Array'",!1)}p.DEFAULT_UTF8_ENCODING="utf8";class k{constructor(){this.items=[]}write(e){this.items.push(e)}final(){return S(this.items)}}let E=[new Uint8Array([1])],x="0123456789",C="name",P="valueHexView",T=new ArrayBuffer(0),O=new Uint8Array(0),B="EndOfContent",R="OCTET STRING",I="BIT STRING";function N(e){var t;return(t=class extends e{constructor(...e){var t;super(...e);let r=e[0]||{};this.isHexOnly=null!==(t=r.isHexOnly)&&void 0!==t&&t,this.valueHexView=r.valueHex?a.toUint8Array(r.valueHex):O}get valueHex(){return this.valueHexView.slice().buffer}set valueHex(e){this.valueHexView=new Uint8Array(e)}fromBER(e,t,r){let i=e instanceof ArrayBuffer?new Uint8Array(e):e;if(!A(this,i,t,r))return -1;let n=t+r;return(this.valueHexView=i.subarray(t,n),this.valueHexView.length)?(this.blockLength=r,n):(this.warnings.push("Zero buffer length"),t)}toBER(e=!1){return this.isHexOnly?e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.byteLength===this.valueHexView.buffer.byteLength?this.valueHexView.buffer:this.valueHexView.slice().buffer:(this.error="Flag 'isHexOnly' is not set, abort",T)}toJSON(){return{...super.toJSON(),isHexOnly:this.isHexOnly,valueHex:p.ToHex(this.valueHexView)}}}).NAME="hexBlock",t}class U{constructor({blockLength:e=0,error:t="",warnings:r=[],valueBeforeDecode:i=O}={}){this.blockLength=e,this.error=t,this.warnings=r,this.valueBeforeDecodeView=a.toUint8Array(i)}static blockName(){return this.NAME}get valueBeforeDecode(){return this.valueBeforeDecodeView.slice().buffer}set valueBeforeDecode(e){this.valueBeforeDecodeView=new Uint8Array(e)}toJSON(){return{blockName:this.constructor.NAME,blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:p.ToHex(this.valueBeforeDecodeView)}}}U.NAME="baseBlock";class L extends U{fromBER(e,t,r){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}toBER(e,t){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}}L.NAME="valueBlock";class j extends N(U){constructor({idBlock:e={}}={}){var t,r,i,n;super(),e?(this.isHexOnly=null!==(t=e.isHexOnly)&&void 0!==t&&t,this.valueHexView=e.valueHex?a.toUint8Array(e.valueHex):O,this.tagClass=null!==(r=e.tagClass)&&void 0!==r?r:-1,this.tagNumber=null!==(i=e.tagNumber)&&void 0!==i?i:-1,this.isConstructed=null!==(n=e.isConstructed)&&void 0!==n&&n):(this.tagClass=-1,this.tagNumber=-1,this.isConstructed=!1)}toBER(e=!1){let t=0;switch(this.tagClass){case 1:t|=0;break;case 2:t|=64;break;case 3:t|=128;break;case 4:t|=192;break;default:return this.error="Unknown tag class",T}if(this.isConstructed&&(t|=32),this.tagNumber<31&&!this.isHexOnly){let r=new Uint8Array(1);if(!e){let e=this.tagNumber;e&=31,t|=e,r[0]=t}return r.buffer}if(!this.isHexOnly){let r=g(this.tagNumber,7),i=new Uint8Array(r),n=r.byteLength,s=new Uint8Array(n+1);if(s[0]=31|t,!e){for(let e=0;e<n-1;e++)s[e+1]=128|i[e];s[n]=i[n-1]}return s.buffer}let r=new Uint8Array(this.valueHexView.byteLength+1);if(r[0]=31|t,!e){let e=this.valueHexView;for(let t=0;t<e.length-1;t++)r[t+1]=128|e[t];r[this.valueHexView.byteLength]=e[e.length-1]}return r.buffer}fromBER(e,t,r){let i=a.toUint8Array(e);if(!A(this,i,t,r))return -1;let n=i.subarray(t,t+r);if(0===n.length)return this.error="Zero buffer length",-1;switch(192&n[0]){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=(32&n[0])==32,this.isHexOnly=!1;let s=31&n[0];if(31!==s)this.tagNumber=s,this.blockLength=1;else{let e=1,t=this.valueHexView=new Uint8Array(255),r=255;for(;128&n[e];){if(t[e-1]=127&n[e],++e>=n.length)return this.error="End of input reached before message was fully decoded",-1;if(e===r){r+=255;let e=new Uint8Array(r);for(let r=0;r<t.length;r++)e[r]=t[r];t=this.valueHexView=new Uint8Array(r)}}this.blockLength=e+1,t[e-1]=127&n[e];let i=new Uint8Array(e);for(let r=0;r<e;r++)i[r]=t[r];(t=this.valueHexView=new Uint8Array(e)).set(i),this.blockLength<=9?this.tagNumber=y(t,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(1===this.tagClass&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return t+this.blockLength}toJSON(){return{...super.toJSON(),tagClass:this.tagClass,tagNumber:this.tagNumber,isConstructed:this.isConstructed}}}j.NAME="identificationBlock";class K extends U{constructor({lenBlock:e={}}={}){var t,r,i;super(),this.isIndefiniteForm=null!==(t=e.isIndefiniteForm)&&void 0!==t&&t,this.longFormUsed=null!==(r=e.longFormUsed)&&void 0!==r&&r,this.length=null!==(i=e.length)&&void 0!==i?i:0}fromBER(e,t,r){let i=a.toUint8Array(e);if(!A(this,i,t,r))return -1;let n=i.subarray(t,t+r);if(0===n.length)return this.error="Zero buffer length",-1;if(255===n[0])return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=128===n[0],this.isIndefiniteForm)return this.blockLength=1,t+this.blockLength;if(this.longFormUsed=!!(128&n[0]),!1===this.longFormUsed)return this.length=n[0],this.blockLength=1,t+this.blockLength;let s=127&n[0];if(s>8)return this.error="Too big integer",-1;if(s+1>n.length)return this.error="End of input reached before message was fully decoded",-1;let o=t+1,l=i.subarray(o,o+s);return 0===l[s-1]&&this.warnings.push("Needlessly long encoded length"),this.length=y(l,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unnecessary usage of long length form"),this.blockLength=s+1,t+this.blockLength}toBER(e=!1){let t,r;if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return t=new ArrayBuffer(1),!1===e&&((r=new Uint8Array(t))[0]=128),t;if(this.longFormUsed){let i=g(this.length,8);if(i.byteLength>127)return this.error="Too big length",T;if(t=new ArrayBuffer(i.byteLength+1),e)return t;let n=new Uint8Array(i);(r=new Uint8Array(t))[0]=128|i.byteLength;for(let e=0;e<i.byteLength;e++)r[e+1]=n[e];return t}return t=new ArrayBuffer(1),!1===e&&((r=new Uint8Array(t))[0]=this.length),t}toJSON(){return{...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,longFormUsed:this.longFormUsed,length:this.length}}}K.NAME="lengthBlock";let D={};class M extends U{constructor({name:e="",optional:t=!1,primitiveSchema:r,...i}={},n){super(i),this.name=e,this.optional=t,r&&(this.primitiveSchema=r),this.idBlock=new j(i),this.lenBlock=new K(i),this.valueBlock=n?new n(i):new L(i)}fromBER(e,t,r){let i=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return -1===i?this.error=this.valueBlock.error:(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength)),i}toBER(e,t){let r=t||new k;t||function e(t){if(t instanceof D.Constructed)for(let r of t.valueBlock.value)e(r)&&(t.lenBlock.isIndefiniteForm=!0);return!!t.lenBlock.isIndefiniteForm}(this);let i=this.idBlock.toBER(e);if(r.write(i),this.lenBlock.isIndefiniteForm)r.write(new Uint8Array([128]).buffer),this.valueBlock.toBER(e,r),r.write(new ArrayBuffer(2));else{let t=this.valueBlock.toBER(e);this.lenBlock.length=t.byteLength;let i=this.lenBlock.toBER(e);r.write(i),r.write(t)}return t?T:r.final()}toJSON(){let e={...super.toJSON(),idBlock:this.idBlock.toJSON(),lenBlock:this.lenBlock.toJSON(),valueBlock:this.valueBlock.toJSON(),name:this.name,optional:this.optional};return this.primitiveSchema&&(e.primitiveSchema=this.primitiveSchema.toJSON()),e}toString(e="ascii"){return"ascii"===e?this.onAsciiEncoding():p.ToHex(this.toBER())}onAsciiEncoding(){return`${this.constructor.NAME} : ${p.ToHex(this.valueBlock.valueBeforeDecodeView)}`}isEqual(e){return this===e||e instanceof this.constructor&&function(e,t){if(e.byteLength!==t.byteLength)return!1;let r=new Uint8Array(e),i=new Uint8Array(t);for(let e=0;e<r.length;e++)if(r[e]!==i[e])return!1;return!0}(this.toBER(),e.toBER())}}M.NAME="BaseBlock";class $ extends M{constructor({value:e="",...t}={},r){super(t,r),e&&this.fromString(e)}getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}fromBER(e,t,r){let i=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return -1===i?this.error=this.valueBlock.error:(this.fromBuffer(this.valueBlock.valueHexView),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength)),i}onAsciiEncoding(){return`${this.constructor.NAME} : '${this.valueBlock.value}'`}}$.NAME="BaseStringBlock";class q extends N(L){constructor({isHexOnly:e=!0,...t}={}){super(t),this.isHexOnly=e}}q.NAME="PrimitiveValueBlock";class H extends M{constructor(e={}){super(e,q),this.idBlock.isConstructed=!1}}function z(e,t=0,r=e.length){let i=t,n=new M({},L),s=new U;if(!A(s,e,t,r))return n.error=s.error,{offset:-1,result:n};if(!e.subarray(t,t+r).length)return n.error="Zero buffer length",{offset:-1,result:n};let o=n.idBlock.fromBER(e,t,r);if(n.idBlock.warnings.length&&n.warnings.concat(n.idBlock.warnings),-1===o)return n.error=n.idBlock.error,{offset:-1,result:n};if(t=o,r-=n.idBlock.blockLength,o=n.lenBlock.fromBER(e,t,r),n.lenBlock.warnings.length&&n.warnings.concat(n.lenBlock.warnings),-1===o)return n.error=n.lenBlock.error,{offset:-1,result:n};if(t=o,r-=n.lenBlock.blockLength,!n.idBlock.isConstructed&&n.lenBlock.isIndefiniteForm)return n.error="Indefinite length form used for primitive encoding form",{offset:-1,result:n};let a=M;if(1===n.idBlock.tagClass){if(n.idBlock.tagNumber>=37&&!1===n.idBlock.isHexOnly)return n.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:n};switch(n.idBlock.tagNumber){case 0:if(n.idBlock.isConstructed&&n.lenBlock.length>0)return n.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:n};a=D.EndOfContent;break;case 1:a=D.Boolean;break;case 2:a=D.Integer;break;case 3:a=D.BitString;break;case 4:a=D.OctetString;break;case 5:a=D.Null;break;case 6:a=D.ObjectIdentifier;break;case 10:a=D.Enumerated;break;case 12:a=D.Utf8String;break;case 13:a=D.RelativeObjectIdentifier;break;case 14:a=D.TIME;break;case 15:return n.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:n};case 16:a=D.Sequence;break;case 17:a=D.Set;break;case 18:a=D.NumericString;break;case 19:a=D.PrintableString;break;case 20:a=D.TeletexString;break;case 21:a=D.VideotexString;break;case 22:a=D.IA5String;break;case 23:a=D.UTCTime;break;case 24:a=D.GeneralizedTime;break;case 25:a=D.GraphicString;break;case 26:a=D.VisibleString;break;case 27:a=D.GeneralString;break;case 28:a=D.UniversalString;break;case 29:a=D.CharacterString;break;case 30:a=D.BmpString;break;case 31:a=D.DATE;break;case 32:a=D.TimeOfDay;break;case 33:a=D.DateTime;break;case 34:a=D.Duration;break;default:{let e=n.idBlock.isConstructed?new D.Constructed:new D.Primitive;e.idBlock=n.idBlock,e.lenBlock=n.lenBlock,e.warnings=n.warnings,n=e}}}else a=n.idBlock.isConstructed?D.Constructed:D.Primitive;return o=(n=function(e,t){if(e instanceof t)return e;let r=new t;return r.idBlock=e.idBlock,r.lenBlock=e.lenBlock,r.warnings=e.warnings,r.valueBeforeDecodeView=e.valueBeforeDecodeView,r}(n,a)).fromBER(e,t,n.lenBlock.isIndefiniteForm?r:n.lenBlock.length),n.valueBeforeDecodeView=e.subarray(i,i+n.blockLength),{offset:o,result:n}}function F(e){if(!e.byteLength){let e=new M({},L);return e.error="Input buffer has zero length",{offset:-1,result:e}}return z(a.toUint8Array(e).slice(),0,e.byteLength)}D.Primitive=H,H.NAME="PRIMITIVE";class V extends L{constructor({value:e=[],isIndefiniteForm:t=!1,...r}={}){super(r),this.value=e,this.isIndefiniteForm=t}fromBER(e,t,r){var i,n;let s=a.toUint8Array(e);if(!A(this,s,t,r))return -1;if(this.valueBeforeDecodeView=s.subarray(t,t+r),0===this.valueBeforeDecodeView.length)return this.warnings.push("Zero buffer length"),t;let o=t;for(;i=this.isIndefiniteForm,n=r,(i?1:n)>0;){let e=z(s,o,r);if(-1===e.offset)return this.error=e.result.error,this.warnings.concat(e.result.warnings),-1;if(o=e.offset,this.blockLength+=e.result.blockLength,r-=e.result.blockLength,this.value.push(e.result),this.isIndefiniteForm&&e.result.constructor.NAME===B)break}return this.isIndefiniteForm&&(this.value[this.value.length-1].constructor.NAME===B?this.value.pop():this.warnings.push("No EndOfContent block encoded")),o}toBER(e,t){let r=t||new k;for(let t=0;t<this.value.length;t++)this.value[t].toBER(e,r);return t?T:r.final()}toJSON(){let e={...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,value:[]};for(let t of this.value)e.value.push(t.toJSON());return e}}V.NAME="ConstructedValueBlock";class W extends M{constructor(e={}){super(e,V),this.idBlock.isConstructed=!0}fromBER(e,t,r){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;let i=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return -1===i?this.error=this.valueBlock.error:(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength)),i}onAsciiEncoding(){let e=[];for(let t of this.valueBlock.value)e.push(t.toString("ascii").split("\n").map(e=>`  ${e}`).join("\n"));let t=3===this.idBlock.tagClass?`[${this.idBlock.tagNumber}]`:this.constructor.NAME;return e.length?`${t} :
${e.join("\n")}`:`${t} :`}}D.Constructed=W,W.NAME="CONSTRUCTED";class J extends L{fromBER(e,t,r){return t}toBER(e){return T}}J.override="EndOfContentValueBlock";class G extends M{constructor(e={}){super(e,J),this.idBlock.tagClass=1,this.idBlock.tagNumber=0}}D.EndOfContent=G,G.NAME=B;class Y extends M{constructor(e={}){super(e,L),this.idBlock.tagClass=1,this.idBlock.tagNumber=5}fromBER(e,t,r){return(this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=r,t+r>e.byteLength)?(this.error="End of input reached before message was fully decoded (inconsistent offset and length values)",-1):t+r}toBER(e,t){let r=new ArrayBuffer(2);if(!e){let e=new Uint8Array(r);e[0]=5,e[1]=0}return t&&t.write(r),r}onAsciiEncoding(){return`${this.constructor.NAME}`}}D.Null=Y,Y.NAME="NULL";class X extends N(L){constructor({value:e,...t}={}){super(t),t.valueHex?this.valueHexView=a.toUint8Array(t.valueHex):this.valueHexView=new Uint8Array(1),e&&(this.value=e)}get value(){for(let e of this.valueHexView)if(e>0)return!0;return!1}set value(e){this.valueHexView[0]=e?255:0}fromBER(e,t,r){let i=a.toUint8Array(e);return A(this,i,t,r)?(this.valueHexView=i.subarray(t,t+r),r>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.isHexOnly=!0,_.call(this),this.blockLength=r,t+r):-1}toBER(){return this.valueHexView.slice()}toJSON(){return{...super.toJSON(),value:this.value}}}X.NAME="BooleanValueBlock";class Q extends M{constructor(e={}){super(e,X),this.idBlock.tagClass=1,this.idBlock.tagNumber=1}getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.getValue}`}}D.Boolean=Q,Q.NAME="BOOLEAN";class Z extends N(V){constructor({isConstructed:e=!1,...t}={}){super(t),this.isConstructed=e}fromBER(e,t,r){let i=0;if(this.isConstructed){if(this.isHexOnly=!1,-1===(i=V.prototype.fromBER.call(this,e,t,r)))return i;for(let e=0;e<this.value.length;e++){let t=this.value[e].constructor.NAME;if(t===B){if(!this.isIndefiniteForm)return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1;break}if(t!==R)return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,i=super.fromBER(e,t,r),this.blockLength=r;return i}toBER(e,t){return this.isConstructed?V.prototype.toBER.call(this,e,t):e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),isConstructed:this.isConstructed}}}Z.NAME="OctetStringValueBlock";class ee extends M{constructor({idBlock:e={},lenBlock:t={},...r}={}){var i,n;null!==(i=r.isConstructed)&&void 0!==i||(r.isConstructed=!!(null===(n=r.value)||void 0===n?void 0:n.length)),super({idBlock:{isConstructed:r.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!r.isIndefiniteForm},...r},Z),this.idBlock.tagClass=1,this.idBlock.tagNumber=4}fromBER(e,t,r){if(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,0===r)return 0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),t;if(!this.valueBlock.isConstructed){let i=(e instanceof ArrayBuffer?new Uint8Array(e):e).subarray(t,t+r);try{if(i.byteLength){let e=z(i,0,i.byteLength);-1!==e.offset&&e.offset===r&&(this.valueBlock.value=[e.result])}}catch(e){}}return super.fromBER(e,t,r)}onAsciiEncoding(){return this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length?W.prototype.onAsciiEncoding.call(this):`${this.constructor.NAME} : ${p.ToHex(this.valueBlock.valueHexView)}`}getValue(){if(!this.idBlock.isConstructed)return this.valueBlock.valueHexView.slice().buffer;let e=[];for(let t of this.valueBlock.value)t instanceof ee&&e.push(t.valueBlock.valueHexView);return a.concat(e)}}D.OctetString=ee,ee.NAME=R;class et extends N(V){constructor({unusedBits:e=0,isConstructed:t=!1,...r}={}){super(r),this.unusedBits=e,this.isConstructed=t,this.blockLength=this.valueHexView.byteLength}fromBER(e,t,r){if(!r)return t;let i=-1;if(this.isConstructed){if(-1===(i=V.prototype.fromBER.call(this,e,t,r)))return i;for(let e of this.value){let t=e.constructor.NAME;if(t===B){if(!this.isIndefiniteForm)return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1;break}if(t!==I)return this.error="BIT STRING may consists of BIT STRINGs only",-1;let r=e.valueBlock;if(this.unusedBits>0&&r.unusedBits>0)return this.error='Using of "unused bits" inside constructive BIT STRING allowed for least one only',-1;this.unusedBits=r.unusedBits}return i}let n=a.toUint8Array(e);if(!A(this,n,t,r))return -1;let s=n.subarray(t,t+r);if(this.unusedBits=s[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;if(!this.unusedBits){let e=s.subarray(1);try{if(e.byteLength){let t=z(e,0,e.byteLength);-1!==t.offset&&t.offset===r-1&&(this.value=[t.result])}}catch(e){}}return this.valueHexView=s.subarray(1),this.blockLength=s.length,t+r}toBER(e,t){if(this.isConstructed)return V.prototype.toBER.call(this,e,t);if(e)return new ArrayBuffer(this.valueHexView.byteLength+1);if(!this.valueHexView.byteLength)return T;let r=new Uint8Array(this.valueHexView.length+1);return r[0]=this.unusedBits,r.set(this.valueHexView,1),r.buffer}toJSON(){return{...super.toJSON(),unusedBits:this.unusedBits,isConstructed:this.isConstructed}}}et.NAME="BitStringValueBlock";class er extends M{constructor({idBlock:e={},lenBlock:t={},...r}={}){var i,n;null!==(i=r.isConstructed)&&void 0!==i||(r.isConstructed=!!(null===(n=r.value)||void 0===n?void 0:n.length)),super({idBlock:{isConstructed:r.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!r.isIndefiniteForm},...r},et),this.idBlock.tagClass=1,this.idBlock.tagNumber=3}fromBER(e,t,r){return this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,super.fromBER(e,t,r)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return W.prototype.onAsciiEncoding.call(this);{let e=[];for(let t of this.valueBlock.valueHexView)e.push(t.toString(2).padStart(8,"0"));let t=e.join("");return`${this.constructor.NAME} : ${t.substring(0,t.length-this.valueBlock.unusedBits)}`}}}function ei(e){if(e>=E.length)for(let t=E.length;t<=e;t++){let e=new Uint8Array([0]),r=E[t-1].slice(0);for(let t=r.length-1;t>=0;t--){let i=new Uint8Array([(r[t]<<1)+e[0]]);e[0]=i[0]/10,r[t]=i[0]%10}e[0]>0&&(r=b(e,r)),E.push(r)}return E[e]}D.BitString=er,er.NAME=I;class en extends N(L){constructor({value:e,...t}={}){super(t),this._valueDec=0,t.valueHex&&this.setValueHex(),void 0!==e&&(this.valueDec=e)}setValueHex(){this.valueHexView.length>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,this.valueHexView.length>0&&(this._valueDec=_.call(this)))}set valueDec(e){this._valueDec=e,this.isHexOnly=!1,this.valueHexView=new Uint8Array(function(e){let t=e<0?-1*e:e,r=128;for(let i=1;i<8;i++){if(t<=r){if(e<0){let e=g(r-t,8,i),n=new Uint8Array(e);return n[0]|=128,e}let n=g(t,8,i),s=new Uint8Array(n);if(128&s[0]){let e=n.slice(0),t=new Uint8Array(e);n=new ArrayBuffer(n.byteLength+1),s=new Uint8Array(n);for(let r=0;r<e.byteLength;r++)s[r+1]=t[r];s[0]=0}return n}r*=256}return new ArrayBuffer(0)}(e))}get valueDec(){return this._valueDec}fromDER(e,t,r,i=0){let n=this.fromBER(e,t,r);if(-1===n)return n;let s=this.valueHexView;return 0===s[0]&&(128&s[1])!=0?this.valueHexView=s.subarray(1):0!==i&&s.length<i&&(i-s.length>1&&(i=s.length+1),this.valueHexView=s.subarray(i-s.length)),n}toDER(e=!1){let t=this.valueHexView;switch(!0){case(128&t[0])!=0:{let e=new Uint8Array(this.valueHexView.length+1);e[0]=0,e.set(t,1),this.valueHexView=e}break;case 0===t[0]&&(128&t[1])==0:this.valueHexView=this.valueHexView.subarray(1)}return this.toBER(e)}fromBER(e,t,r){let i=super.fromBER(e,t,r);return -1===i||this.setValueHex(),i}toBER(e){return e?new ArrayBuffer(this.valueHexView.length):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}toString(){let e;let t=8*this.valueHexView.length-1,r=new Uint8Array(8*this.valueHexView.length/3),i=0,n=this.valueHexView,s="",o=!1;for(let o=n.byteLength-1;o>=0;o--){e=n[o];for(let n=0;n<8;n++)(1&e)==1&&(i===t?(r=function(e,t){let r,i=0,n=new Uint8Array(e),s=new Uint8Array(t),o=n.slice(0),a=o.length-1,l=s.slice(0),u=l.length-1,c=0;for(let e=u;e>=0;e--,c++)!0==(r=o[a-c]-l[u-c]-i)<0?(i=1,o[a-c]=r+10):(i=0,o[a-c]=r);if(i>0)for(let e=a-u+1;e>=0;e--,c++)if((r=o[a-c]-i)<0)i=1,o[a-c]=r+10;else{i=0,o[a-c]=r;break}return o.slice()}(ei(i),r),s="-"):r=function(e,t){let r=new Uint8Array([0]),i=new Uint8Array(e),n=new Uint8Array(t),s=i.slice(0),o=s.length-1,a=n.slice(0),l=a.length-1,u=0,c=l<o?o:l,h=0;for(let e=c;e>=0;e--,h++)u=!0==h<a.length?s[o-h]+a[l-h]+r[0]:s[o-h]+r[0],(r[0]=u/10,!0==h>=s.length)?s=b(new Uint8Array([u%10]),s):s[o-h]=u%10;return r[0]>0&&(s=b(r,s)),s}(r,ei(i))),i++,e>>=1}for(let e=0;e<r.length;e++)r[e]&&(o=!0),o&&(s+=x.charAt(r[e]));return!1===o&&(s+=x.charAt(0)),s}}en.NAME="IntegerValueBlock",Object.defineProperty(en.prototype,"valueHex",{set:function(e){this.valueHexView=new Uint8Array(e),this.setValueHex()},get:function(){return this.valueHexView.slice().buffer}});class es extends M{constructor(e={}){super(e,en),this.idBlock.tagClass=1,this.idBlock.tagNumber=2}toBigInt(){return w(),BigInt(this.valueBlock.toString())}static fromBigInt(e){w();let t=BigInt(e),r=new k,i=t.toString(16).replace(/^-/,""),n=new Uint8Array(p.FromHex(i));if(t<0){let e=new Uint8Array(n.length+(128&n[0]?1:0));e[0]|=128;let i=BigInt(`0x${p.ToHex(e)}`),s=a.toUint8Array(p.FromHex((i+t).toString(16)));s[0]|=128,r.write(s)}else 128&n[0]&&r.write(new Uint8Array([0])),r.write(n);return new es({valueHex:r.final()})}convertToDER(){let e=new es({valueHex:this.valueBlock.valueHexView});return e.valueBlock.toDER(),e}convertFromDER(){return new es({valueHex:0===this.valueBlock.valueHexView[0]?this.valueBlock.valueHexView.subarray(1):this.valueBlock.valueHexView})}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()}`}}D.Integer=es,es.NAME="INTEGER";class eo extends es{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=10}}D.Enumerated=eo,eo.NAME="ENUMERATED";class ea extends N(L){constructor({valueDec:e=-1,isFirstSid:t=!1,...r}={}){super(r),this.valueDec=e,this.isFirstSid=t}fromBER(e,t,r){if(!r)return t;let i=a.toUint8Array(e);if(!A(this,i,t,r))return -1;let n=i.subarray(t,t+r);this.valueHexView=new Uint8Array(r);for(let e=0;e<r&&(this.valueHexView[e]=127&n[e],this.blockLength++,(128&n[e])!=0);e++);let s=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength;e++)s[e]=this.valueHexView[e];return(this.valueHexView=s,(128&n[this.blockLength-1])!=0)?(this.error="End of input reached before message was fully decoded",-1):(0===this.valueHexView[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=y(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}set valueBigInt(e){w();let t=BigInt(e).toString(2);for(;t.length%7;)t="0"+t;let r=new Uint8Array(t.length/7);for(let e=0;e<r.length;e++)r[e]=parseInt(t.slice(7*e,7*e+7),2)+(e+1<r.length?128:0);this.fromBER(r.buffer,0,r.length)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);let t=this.valueHexView,r=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength-1;e++)r[e]=128|t[e];return r[this.blockLength-1]=t[this.blockLength-1],r.buffer}let t=g(this.valueDec,7);if(0===t.byteLength)return this.error="Error during encoding SID value",T;let r=new Uint8Array(t.byteLength);if(!e){let e=new Uint8Array(t),i=t.byteLength-1;for(let t=0;t<i;t++)r[t]=128|e[t];r[i]=e[i]}return r}toString(){let e="";if(this.isHexOnly)e=p.ToHex(this.valueHexView);else if(this.isFirstSid){let t=this.valueDec;this.valueDec<=39?e="0.":this.valueDec<=79?(e="1.",t-=40):(e="2.",t-=80),e+=t.toString()}else e=this.valueDec.toString();return e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec,isFirstSid:this.isFirstSid}}}ea.NAME="sidBlock";class el extends L{constructor({value:e="",...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,r){let i=t;for(;r>0;){let t=new ea;if(-1===(i=t.fromBER(e,i,r))){this.blockLength=0,this.error=t.error;break}0===this.value.length&&(t.isFirstSid=!0),this.blockLength+=t.blockLength,r-=t.blockLength,this.value.push(t)}return i}toBER(e){let t=[];for(let r=0;r<this.value.length;r++){let i=this.value[r].toBER(e);if(0===i.byteLength)return this.error=this.value[r].error,T;t.push(i)}return S(t)}fromString(e){this.value=[];let t=0,r=0,i="",n=!1;do if(i=-1===(r=e.indexOf(".",t))?e.substring(t):e.substring(t,r),t=r+1,n){let e=this.value[0],t=0;switch(e.valueDec){case 0:break;case 1:t=40;break;case 2:t=80;break;default:this.value=[];return}let r=parseInt(i,10);if(isNaN(r))return;e.valueDec=r+t,n=!1}else{let e=new ea;if(i>Number.MAX_SAFE_INTEGER){w();let t=BigInt(i);e.valueBigInt=t}else if(e.valueDec=parseInt(i,10),isNaN(e.valueDec))return;this.value.length||(e.isFirstSid=!0,n=!0),this.value.push(e)}while(-1!==r)}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let i=this.value[r].toString();0!==r&&(e=`${e}.`),t?(i=`{${i}}`,this.value[r].isFirstSid?e=`2.{${i} - 80}`:e+=i):e+=i}return e}toJSON(){let e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}el.NAME="ObjectIdentifierValueBlock";class eu extends M{constructor(e={}){super(e,el),this.idBlock.tagClass=1,this.idBlock.tagNumber=6}getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}D.ObjectIdentifier=eu,eu.NAME="OBJECT IDENTIFIER";class ec extends N(U){constructor({valueDec:e=0,...t}={}){super(t),this.valueDec=e}fromBER(e,t,r){if(0===r)return t;let i=a.toUint8Array(e);if(!A(this,i,t,r))return -1;let n=i.subarray(t,t+r);this.valueHexView=new Uint8Array(r);for(let e=0;e<r&&(this.valueHexView[e]=127&n[e],this.blockLength++,(128&n[e])!=0);e++);let s=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength;e++)s[e]=this.valueHexView[e];return(this.valueHexView=s,(128&n[this.blockLength-1])!=0)?(this.error="End of input reached before message was fully decoded",-1):(0===this.valueHexView[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=y(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);let t=this.valueHexView,r=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength-1;e++)r[e]=128|t[e];return r[this.blockLength-1]=t[this.blockLength-1],r.buffer}let t=g(this.valueDec,7);if(0===t.byteLength)return this.error="Error during encoding SID value",T;let r=new Uint8Array(t.byteLength);if(!e){let e=new Uint8Array(t),i=t.byteLength-1;for(let t=0;t<i;t++)r[t]=128|e[t];r[i]=e[i]}return r.buffer}toString(){return this.isHexOnly?p.ToHex(this.valueHexView):this.valueDec.toString()}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}}ec.NAME="relativeSidBlock";class eh extends L{constructor({value:e="",...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,r){let i=t;for(;r>0;){let t=new ec;if(-1===(i=t.fromBER(e,i,r))){this.blockLength=0,this.error=t.error;break}this.blockLength+=t.blockLength,r-=t.blockLength,this.value.push(t)}return i}toBER(e,t){let r=[];for(let t=0;t<this.value.length;t++){let i=this.value[t].toBER(e);if(0===i.byteLength)return this.error=this.value[t].error,T;r.push(i)}return S(r)}fromString(e){this.value=[];let t=0,r=0,i="";do{i=-1===(r=e.indexOf(".",t))?e.substring(t):e.substring(t,r),t=r+1;let n=new ec;if(n.valueDec=parseInt(i,10),isNaN(n.valueDec))break;this.value.push(n)}while(-1!==r);return!0}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let i=this.value[r].toString();0!==r&&(e=`${e}.`),t?e+=i=`{${i}}`:e+=i}return e}toJSON(){let e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}eh.NAME="RelativeObjectIdentifierValueBlock";class ed extends M{constructor(e={}){super(e,eh),this.idBlock.tagClass=1,this.idBlock.tagNumber=13}getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}D.RelativeObjectIdentifier=ed,ed.NAME="RelativeObjectIdentifier";class ef extends W{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=16}}D.Sequence=ef,ef.NAME="SEQUENCE";class ep extends W{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=17}}D.Set=ep,ep.NAME="SET";class em extends N(L){constructor({...e}={}){super(e),this.isHexOnly=!0,this.value=""}toJSON(){return{...super.toJSON(),value:this.value}}}em.NAME="StringValueBlock";class ey extends em{}ey.NAME="SimpleStringValueBlock";class eg extends ${constructor({...e}={}){super(e,ey)}fromBuffer(e){this.valueBlock.value=String.fromCharCode.apply(null,a.toUint8Array(e))}fromString(e){let t=e.length,r=this.valueBlock.valueHexView=new Uint8Array(t);for(let i=0;i<t;i++)r[i]=e.charCodeAt(i);this.valueBlock.value=e}}eg.NAME="SIMPLE STRING";class eb extends eg{fromBuffer(e){this.valueBlock.valueHexView=a.toUint8Array(e);try{this.valueBlock.value=p.ToUtf8String(e)}catch(t){this.warnings.push(`Error during "decodeURIComponent": ${t}, using raw string`),this.valueBlock.value=p.ToBinary(e)}}fromString(e){this.valueBlock.valueHexView=new Uint8Array(p.FromUtf8String(e)),this.valueBlock.value=e}}eb.NAME="Utf8StringValueBlock";class e_ extends eb{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=12}}D.Utf8String=e_,e_.NAME="UTF8String";class ev extends eg{fromBuffer(e){this.valueBlock.value=p.ToUtf16String(e),this.valueBlock.valueHexView=a.toUint8Array(e)}fromString(e){this.valueBlock.value=e,this.valueBlock.valueHexView=new Uint8Array(p.FromUtf16String(e))}}ev.NAME="BmpStringValueBlock";class ew extends ev{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=30}}D.BmpString=ew,ew.NAME="BMPString";class eS extends eg{fromBuffer(e){let t=ArrayBuffer.isView(e)?e.slice().buffer:e.slice(0),r=new Uint8Array(t);for(let e=0;e<r.length;e+=4)r[e]=r[e+3],r[e+1]=r[e+2],r[e+2]=0,r[e+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(t))}fromString(e){let t=e.length,r=this.valueBlock.valueHexView=new Uint8Array(4*t);for(let i=0;i<t;i++){let t=g(e.charCodeAt(i),8),n=new Uint8Array(t);if(n.length>4)continue;let s=4-n.length;for(let e=n.length-1;e>=0;e--)r[4*i+e+s]=n[e]}this.valueBlock.value=e}}eS.NAME="UniversalStringValueBlock";class eA extends eS{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=28}}D.UniversalString=eA,eA.NAME="UniversalString";class ek extends eg{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=18}}D.NumericString=ek,ek.NAME="NumericString";class eE extends eg{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=19}}D.PrintableString=eE,eE.NAME="PrintableString";class ex extends eg{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=20}}D.TeletexString=ex,ex.NAME="TeletexString";class eC extends eg{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=21}}D.VideotexString=eC,eC.NAME="VideotexString";class eP extends eg{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=22}}D.IA5String=eP,eP.NAME="IA5String";class eT extends eg{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=25}}D.GraphicString=eT,eT.NAME="GraphicString";class eO extends eg{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=26}}D.VisibleString=eO,eO.NAME="VisibleString";class eB extends eg{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=27}}D.GeneralString=eB,eB.NAME="GeneralString";class eR extends eg{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=29}}D.CharacterString=eR,eR.NAME="CharacterString";class eI extends eO{constructor({value:e,valueDate:t,...r}={}){if(super(r),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,e){this.fromString(e),this.valueBlock.valueHexView=new Uint8Array(e.length);for(let t=0;t<e.length;t++)this.valueBlock.valueHexView[t]=e.charCodeAt(t)}t&&(this.fromDate(t),this.valueBlock.valueHexView=new Uint8Array(this.toBuffer())),this.idBlock.tagClass=1,this.idBlock.tagNumber=23}fromBuffer(e){this.fromString(String.fromCharCode.apply(null,a.toUint8Array(e)))}toBuffer(){let e=this.toString(),t=new ArrayBuffer(e.length),r=new Uint8Array(t);for(let t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return t}fromDate(e){this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}fromString(e){let t=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/ig.exec(e);if(null===t){this.error="Wrong input string for conversion";return}let r=parseInt(t[1],10);r>=50?this.year=1900+r:this.year=2e3+r,this.month=parseInt(t[2],10),this.day=parseInt(t[3],10),this.hour=parseInt(t[4],10),this.minute=parseInt(t[5],10),this.second=parseInt(t[6],10)}toString(e="iso"){if("iso"===e){let e=Array(7);return e[0]=v(this.year<2e3?this.year-1900:this.year-2e3,2),e[1]=v(this.month,2),e[2]=v(this.day,2),e[3]=v(this.hour,2),e[4]=v(this.minute,2),e[5]=v(this.second,2),e[6]="Z",e.join("")}return super.toString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.toDate().toISOString()}`}toJSON(){return{...super.toJSON(),year:this.year,month:this.month,day:this.day,hour:this.hour,minute:this.minute,second:this.second}}}D.UTCTime=eI,eI.NAME="UTCTime";class eN extends eI{constructor(e={}){var t;super(e),null!==(t=this.millisecond)&&void 0!==t||(this.millisecond=0),this.idBlock.tagClass=1,this.idBlock.tagNumber=24}fromDate(e){super.fromDate(e),this.millisecond=e.getUTCMilliseconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond))}fromString(e){let t,r=!1,i="",n="",s=0,o=0,a=0;if("Z"===e[e.length-1])i=e.substring(0,e.length-1),r=!0;else{if(isNaN(new Number(e[e.length-1]).valueOf()))throw Error("Wrong input string for conversion");i=e}if(r){if(-1!==i.indexOf("+")||-1!==i.indexOf("-"))throw Error("Wrong input string for conversion")}else{let e=1,t=i.indexOf("+"),r="";if(-1===t&&(t=i.indexOf("-"),e=-1),-1!==t){if(r=i.substring(t+1),i=i.substring(0,t),2!==r.length&&4!==r.length)throw Error("Wrong input string for conversion");let n=parseInt(r.substring(0,2),10);if(isNaN(n.valueOf()))throw Error("Wrong input string for conversion");if(o=e*n,4===r.length){if(isNaN((n=parseInt(r.substring(2,4),10)).valueOf()))throw Error("Wrong input string for conversion");a=e*n}}}let l=i.indexOf(".");if(-1===l&&(l=i.indexOf(",")),-1!==l){let e=new Number(`0${i.substring(l)}`);if(isNaN(e.valueOf()))throw Error("Wrong input string for conversion");s=e.valueOf(),n=i.substring(0,l)}else n=i;switch(!0){case 8===n.length:if(t=/(\d{4})(\d{2})(\d{2})/ig,-1!==l)throw Error("Wrong input string for conversion");break;case 10===n.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})/ig,-1!==l){let e=60*s;this.minute=Math.floor(e),e=60*(e-this.minute),this.second=Math.floor(e),e=1e3*(e-this.second),this.millisecond=Math.floor(e)}break;case 12===n.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/ig,-1!==l){let e=60*s;this.second=Math.floor(e),e=1e3*(e-this.second),this.millisecond=Math.floor(e)}break;case 14===n.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/ig,-1!==l){let e=1e3*s;this.millisecond=Math.floor(e)}break;default:throw Error("Wrong input string for conversion")}let u=t.exec(n);if(null===u)throw Error("Wrong input string for conversion");for(let e=1;e<u.length;e++)switch(e){case 1:this.year=parseInt(u[e],10);break;case 2:this.month=parseInt(u[e],10);break;case 3:this.day=parseInt(u[e],10);break;case 4:this.hour=parseInt(u[e],10)+o;break;case 5:this.minute=parseInt(u[e],10)+a;break;case 6:this.second=parseInt(u[e],10);break;default:throw Error("Wrong input string for conversion")}if(!1===r){let e=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=e.getUTCFullYear(),this.month=e.getUTCMonth(),this.day=e.getUTCDay(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds(),this.millisecond=e.getUTCMilliseconds()}}toString(e="iso"){if("iso"===e){let e=[];return e.push(v(this.year,4)),e.push(v(this.month,2)),e.push(v(this.day,2)),e.push(v(this.hour,2)),e.push(v(this.minute,2)),e.push(v(this.second,2)),0!==this.millisecond&&(e.push("."),e.push(v(this.millisecond,3))),e.push("Z"),e.join("")}return super.toString(e)}toJSON(){return{...super.toJSON(),millisecond:this.millisecond}}}D.GeneralizedTime=eN,eN.NAME="GeneralizedTime";class eU extends e_{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=31}}D.DATE=eU,eU.NAME="DATE";class eL extends e_{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=32}}D.TimeOfDay=eL,eL.NAME="TimeOfDay";class ej extends e_{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=33}}D.DateTime=ej,ej.NAME="DateTime";class eK extends e_{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=34}}D.Duration=eK,eK.NAME="Duration";class eD extends e_{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=14}}D.TIME=eD,eD.NAME="TIME";class eM{constructor({name:e="",optional:t=!1}={}){this.name=e,this.optional=t}}class e$ extends eM{constructor({value:e=[],...t}={}){super(t),this.value=e}}class eq extends eM{constructor({value:e=new eM,local:t=!1,...r}={}){super(r),this.value=e,this.local=t}}class eH{constructor({data:e=O}={}){this.dataView=a.toUint8Array(e)}get data(){return this.dataView.slice().buffer}set data(e){this.dataView=a.toUint8Array(e)}fromBER(e,t,r){let i=t+r;return this.dataView=a.toUint8Array(e).subarray(t,i),i}toBER(e){return this.dataView.slice().buffer}}function ez(e,t,r){if(r instanceof e$){for(let i=0;i<r.value.length;i++)if(ez(e,t,r.value[i]).verified)return{verified:!0,result:e};{let e={verified:!1,result:{error:"Wrong values for Choice type"}};return r.hasOwnProperty(C)&&(e.name=r.name),e}}if(r instanceof eM)return r.hasOwnProperty(C)&&(e[r.name]=t),{verified:!0,result:e};if(e instanceof Object==!1)return{verified:!1,result:{error:"Wrong root object"}};if(t instanceof Object==!1)return{verified:!1,result:{error:"Wrong ASN.1 data"}};if(r instanceof Object==!1||"idBlock"in r==!1||"fromBER"in r.idBlock==!1||"toBER"in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};let i=r.idBlock.toBER(!1);if(0===i.byteLength)return{verified:!1,result:{error:"Error encoding idBlock for ASN.1 schema"}};if(-1===r.idBlock.fromBER(i,0,i.byteLength))return{verified:!1,result:{error:"Error decoding idBlock for ASN.1 schema"}};if(!1===r.idBlock.hasOwnProperty("tagClass"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagClass!==t.idBlock.tagClass)return{verified:!1,result:e};if(!1===r.idBlock.hasOwnProperty("tagNumber"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagNumber!==t.idBlock.tagNumber)return{verified:!1,result:e};if(!1===r.idBlock.hasOwnProperty("isConstructed"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isConstructed!==t.idBlock.isConstructed)return{verified:!1,result:e};if(!("isHexOnly"in r.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isHexOnly!==t.idBlock.isHexOnly)return{verified:!1,result:e};if(r.idBlock.isHexOnly){if(P in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};let i=r.idBlock.valueHexView,n=t.idBlock.valueHexView;if(i.length!==n.length)return{verified:!1,result:e};for(let t=0;t<i.length;t++)if(i[t]!==n[1])return{verified:!1,result:e}}if(r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,""),r.name&&(e[r.name]=t)),r instanceof D.Constructed){let i=0,n={verified:!1,result:{error:"Unknown error"}},s=r.valueBlock.value.length;if(s>0&&r.valueBlock.value[0]instanceof eq&&(s=t.valueBlock.value.length),0===s)return{verified:!0,result:e};if(0===t.valueBlock.value.length&&0!==r.valueBlock.value.length){let t=!0;for(let e=0;e<r.valueBlock.value.length;e++)t=t&&(r.valueBlock.value[e].optional||!1);return t?{verified:!0,result:e}:(r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,""),r.name&&delete e[r.name]),e.error="Inconsistent object length",{verified:!1,result:e})}for(let o=0;o<s;o++)if(o-i>=t.valueBlock.value.length){if(!1===r.valueBlock.value[o].optional){let t={verified:!1,result:e};return e.error="Inconsistent length between ASN.1 data and schema",r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,""),r.name&&(delete e[r.name],t.name=r.name)),t}}else if(r.valueBlock.value[0]instanceof eq){if(!1===(n=ez(e,t.valueBlock.value[o],r.valueBlock.value[0].value)).verified){if(!r.valueBlock.value[0].optional)return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,""),r.name&&delete e[r.name]),n;i++}if(C in r.valueBlock.value[0]&&r.valueBlock.value[0].name.length>0){let i={};void 0===(i="local"in r.valueBlock.value[0]&&r.valueBlock.value[0].local?t:e)[r.valueBlock.value[0].name]&&(i[r.valueBlock.value[0].name]=[]),i[r.valueBlock.value[0].name].push(t.valueBlock.value[o])}}else if(!1===(n=ez(e,t.valueBlock.value[o-i],r.valueBlock.value[o])).verified){if(!r.valueBlock.value[o].optional)return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,""),r.name&&delete e[r.name]),n;i++}if(!1===n.verified){let t={verified:!1,result:e};return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,""),r.name&&(delete e[r.name],t.name=r.name)),t}return{verified:!0,result:e}}if(r.primitiveSchema&&P in t.valueBlock){let i=z(t.valueBlock.valueHexView);if(-1===i.offset){let t={verified:!1,result:i.result};return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,""),r.name&&(delete e[r.name],t.name=r.name)),t}return ez(e,i.result,r.primitiveSchema)}return{verified:!0,result:e}}function eF(e,t){if(t instanceof Object==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema type"}};let r=z(a.toUint8Array(e));return -1===r.offset?{verified:!1,result:r.result}:ez(r.result,r.result,t)}(function(e){e[e.Sequence=0]="Sequence",e[e.Set=1]="Set",e[e.Choice=2]="Choice"})(i||(i={})),function(e){e[e.Any=1]="Any",e[e.Boolean=2]="Boolean",e[e.OctetString=3]="OctetString",e[e.BitString=4]="BitString",e[e.Integer=5]="Integer",e[e.Enumerated=6]="Enumerated",e[e.ObjectIdentifier=7]="ObjectIdentifier",e[e.Utf8String=8]="Utf8String",e[e.BmpString=9]="BmpString",e[e.UniversalString=10]="UniversalString",e[e.NumericString=11]="NumericString",e[e.PrintableString=12]="PrintableString",e[e.TeletexString=13]="TeletexString",e[e.VideotexString=14]="VideotexString",e[e.IA5String=15]="IA5String",e[e.GraphicString=16]="GraphicString",e[e.VisibleString=17]="VisibleString",e[e.GeneralString=18]="GeneralString",e[e.CharacterString=19]="CharacterString",e[e.UTCTime=20]="UTCTime",e[e.GeneralizedTime=21]="GeneralizedTime",e[e.DATE=22]="DATE",e[e.TimeOfDay=23]="TimeOfDay",e[e.DateTime=24]="DateTime",e[e.Duration=25]="Duration",e[e.TIME=26]="TIME",e[e.Null=27]="Null"}(n||(n={}));let eV={fromASN:e=>e instanceof Y?null:e.valueBeforeDecodeView,toASN:e=>{if(null===e)return new Y;let t=F(e);if(t.result.error)throw Error(t.result.error);return t.result}},eW={fromASN:e=>e.valueBlock.valueHexView.byteLength>=4?e.valueBlock.toString():e.valueBlock.valueDec,toASN:e=>new es({value:+e})},eJ={fromASN:e=>e.valueBlock.valueDec,toASN:e=>new eo({value:e})},eG={fromASN:e=>e.valueBlock.valueHexView,toASN:e=>new er({valueHex:e})},eY={fromASN:e=>e.valueBlock.toString(),toASN:e=>new eu({value:e})},eX={fromASN:e=>e.valueBlock.value,toASN:e=>new Q({value:e})},eQ={fromASN:e=>e.valueBlock.valueHexView,toASN:e=>new ee({valueHex:e})};function eZ(e){return{fromASN:e=>e.valueBlock.value,toASN:t=>new e({value:t})}}let e0=eZ(e_),e1=eZ(ew),e2=eZ(eA),e8=eZ(ek),e3=eZ(eE),e4=eZ(ex),e5=eZ(eC),e6=eZ(eP),e7=eZ(eT),e9=eZ(eO),te=eZ(eB),tt=eZ(eR),tr={fromASN:e=>e.toDate(),toASN:e=>new eI({valueDate:e})},ti={fromASN:e=>e.toDate(),toASN:e=>new eN({valueDate:e})},tn={fromASN:()=>null,toASN:()=>new Y};function ts(e){switch(e){case n.Any:return eV;case n.BitString:return eG;case n.BmpString:return e1;case n.Boolean:return eX;case n.CharacterString:return tt;case n.Enumerated:return eJ;case n.GeneralString:return te;case n.GeneralizedTime:return ti;case n.GraphicString:return e7;case n.IA5String:return e6;case n.Integer:return eW;case n.Null:return tn;case n.NumericString:return e8;case n.ObjectIdentifier:return eY;case n.OctetString:return eQ;case n.PrintableString:return e3;case n.TeletexString:return e4;case n.UTCTime:return tr;case n.UniversalString:return e2;case n.Utf8String:return e0;case n.VideotexString:return e5;case n.VisibleString:return e9;default:return null}}function to(e){return"function"==typeof e&&e.prototype?!!e.prototype.toASN&&!!e.prototype.fromASN||to(e.prototype):!!(e&&"object"==typeof e&&"toASN"in e&&"fromASN"in e)}class ta{constructor(){this.items=new WeakMap}has(e){return this.items.has(e)}get(e,t=!1){let r=this.items.get(e);if(!r)throw Error(`Cannot get schema for '${e.prototype.constructor.name}' target`);if(t&&!r.schema)throw Error(`Schema '${e.prototype.constructor.name}' doesn't contain ASN.1 schema. Call 'AsnSchemaStorage.cache'.`);return r}cache(e){let t=this.get(e);t.schema||(t.schema=this.create(e,!0))}createDefault(e){let t={type:i.Sequence,items:{}},r=this.findParentSchema(e);return r&&(Object.assign(t,r),t.items=Object.assign({},t.items,r.items)),t}create(e,t){let r=this.items.get(e)||this.createDefault(e),s=[];for(let e in r.items){let a;let l=r.items[e],u=t?e:"";if("number"==typeof l.type){let e=n[l.type],t=o[e];if(!t)throw Error(`Cannot get ASN1 class by name '${e}'`);a=new t({name:u})}else to(l.type)?a=new l.type().toSchema(u):l.optional?this.get(l.type).type===i.Choice?a=new eM({name:u}):(a=this.create(l.type,!1)).name=u:a=new eM({name:u});let c=!!l.optional||void 0!==l.defaultValue;if(l.repeated&&(a.name="",a=new("set"===l.repeated?ep:ef)({name:"",value:[new eq({name:u,value:a})]})),null!==l.context&&void 0!==l.context){if(l.implicit){if("number"==typeof l.type||to(l.type)){let e=l.repeated?W:H;s.push(new e({name:u,optional:c,idBlock:{tagClass:3,tagNumber:l.context}}))}else{this.cache(l.type);let e=!!l.repeated,t=e?a:this.get(l.type,!0).schema;t="valueBlock"in t?t.valueBlock.value:t.value,s.push(new W({name:e?"":u,optional:c,idBlock:{tagClass:3,tagNumber:l.context},value:t}))}}else s.push(new W({optional:c,idBlock:{tagClass:3,tagNumber:l.context},value:[a]}))}else a.optional=c,s.push(a)}switch(r.type){case i.Sequence:return new ef({value:s,name:""});case i.Set:return new ep({value:s,name:""});case i.Choice:return new e$({value:s,name:""});default:throw Error("Unsupported ASN1 type in use")}}set(e,t){return this.items.set(e,t),this}findParentSchema(e){let t=Object.getPrototypeOf(e);return t?this.items.get(t)||this.findParentSchema(t):null}}let tl=new ta,tu=e=>t=>{let r;tl.has(t)?r=tl.get(t):(r=tl.createDefault(t),tl.set(t,r)),Object.assign(r,e)},tc=e=>(t,r)=>{let i;tl.has(t.constructor)?i=tl.get(t.constructor):(i=tl.createDefault(t.constructor),tl.set(t.constructor,i));let n=Object.assign({},e);if("number"==typeof n.type&&!n.converter){let i=ts(e.type);if(!i)throw Error(`Cannot get default converter for property '${r}' of ${t.constructor.name}`);n.converter=i}i.items[r]=n};class th extends Error{constructor(){super(...arguments),this.schemas=[]}}class td{static parse(e,t){let r=F(e);if(r.result.error)throw Error(r.result.error);return this.fromASN(r.result,t)}static fromASN(e,t){var r;try{if(to(t))return new t().fromASN(e);let s=tl.get(t);tl.cache(t);let a=s.schema;if(e.constructor===W&&s.type!==i.Choice)for(let t in a=new W({idBlock:{tagClass:3,tagNumber:e.idBlock.tagNumber},value:s.schema.valueBlock.value}),s.items)delete e[t];let l=ez({},e,a);if(!l.verified)throw new th(`Data does not match to ${t.name} ASN1 schema. ${l.result.error}`);let u=new t;if(function e(t){var r;if(t){let i=Object.getPrototypeOf(t);return(null===(r=null==i?void 0:i.prototype)||void 0===r?void 0:r.constructor)===Array||e(i)}return!1}(t)){if(!("value"in e.valueBlock&&Array.isArray(e.valueBlock.value)))throw Error("Cannot get items from the ASN.1 parsed value. ASN.1 object is not constructed.");let r=s.itemType;if("number"!=typeof r)return t.from(e.valueBlock.value,e=>this.fromASN(e,r));{let i=ts(r);if(!i)throw Error(`Cannot get default converter for array item of ${t.name} ASN1 schema`);return t.from(e.valueBlock.value,e=>i.fromASN(e))}}for(let e in s.items){let t=l.result[e];if(!t)continue;let i=s.items[e],a=i.type;if("number"==typeof a||to(a)){let s=null!==(r=i.converter)&&void 0!==r?r:to(a)?new a:null;if(!s)throw Error("Converter is empty");if(i.repeated){if(i.implicit){let r=new("sequence"===i.repeated?ef:ep);r.valueBlock=t.valueBlock;let n=F(r.toBER(!1));if(-1===n.offset)throw Error(`Cannot parse the child item. ${n.result.error}`);if(!("value"in n.result.valueBlock&&Array.isArray(n.result.valueBlock.value)))throw Error("Cannot get items from the ASN.1 parsed value. ASN.1 object is not constructed.");let o=n.result.valueBlock.value;u[e]=Array.from(o,e=>s.fromASN(e))}else u[e]=Array.from(t,e=>s.fromASN(e))}else{let r=t;if(i.implicit){let e;if(to(a))e=new a().toSchema("");else{let t=n[a],r=o[t];if(!r)throw Error(`Cannot get '${t}' class from asn1js module`);e=new r}e.valueBlock=r.valueBlock,r=F(e.toBER(!1)).result}u[e]=s.fromASN(r)}}else if(i.repeated){if(!Array.isArray(t))throw Error("Cannot get list of items from the ASN.1 parsed value. ASN.1 value should be iterable.");u[e]=Array.from(t,e=>this.fromASN(e,a))}else u[e]=this.fromASN(t,a)}return u}catch(e){throw e instanceof th&&e.schemas.push(t.name),e}}}class tf{static serialize(e){return e instanceof M?e.toBER(!1):this.toASN(e).toBER(!1)}static toASN(e){let t;if(e&&"object"==typeof e&&to(e))return e.toASN();if(!(e&&"object"==typeof e))throw TypeError("Parameter 1 should be type of Object.");let r=e.constructor,n=tl.get(r);tl.cache(r);let s=[];if(n.itemType){if(!Array.isArray(e))throw TypeError("Parameter 1 should be type of Array.");if("number"==typeof n.itemType){let t=ts(n.itemType);if(!t)throw Error(`Cannot get default converter for array item of ${r.name} ASN1 schema`);s=e.map(e=>t.toASN(e))}else s=e.map(e=>this.toAsnItem({type:n.itemType},"[]",r,e))}else for(let t in n.items){let i=n.items[t],o=e[t];if(void 0===o||i.defaultValue===o||"object"==typeof i.defaultValue&&"object"==typeof o&&function(e,t){if(!(e&&t)||e.byteLength!==t.byteLength)return!1;let r=new Uint8Array(e),i=new Uint8Array(t);for(let t=0;t<e.byteLength;t++)if(r[t]!==i[t])return!1;return!0}(this.serialize(i.defaultValue),this.serialize(o)))continue;let a=tf.toAsnItem(i,t,r,o);if("number"==typeof i.context){if(i.implicit){if(!i.repeated&&("number"==typeof i.type||to(i.type))){let e={};e.valueHex=a instanceof Y?a.valueBeforeDecodeView:a.valueBlock.toBER(),s.push(new H({optional:i.optional,idBlock:{tagClass:3,tagNumber:i.context},...e}))}else s.push(new W({optional:i.optional,idBlock:{tagClass:3,tagNumber:i.context},value:a.valueBlock.value}))}else s.push(new W({optional:i.optional,idBlock:{tagClass:3,tagNumber:i.context},value:[a]}))}else i.repeated?s=s.concat(a):s.push(a)}switch(n.type){case i.Sequence:t=new ef({value:s});break;case i.Set:t=new ep({value:s});break;case i.Choice:if(!s[0])throw Error(`Schema '${r.name}' has wrong data. Choice cannot be empty.`);t=s[0]}return t}static toAsnItem(e,t,r,i){let s;if("number"==typeof e.type){let o=e.converter;if(!o)throw Error(`Property '${t}' doesn't have converter for type ${n[e.type]} in schema '${r.name}'`);if(e.repeated){if(!Array.isArray(i))throw TypeError("Parameter 'objProp' should be type of Array.");let t=Array.from(i,e=>o.toASN(e));s=new("sequence"===e.repeated?ef:ep)({value:t})}else s=o.toASN(i)}else if(e.repeated){if(!Array.isArray(i))throw TypeError("Parameter 'objProp' should be type of Array.");let t=Array.from(i,e=>this.toASN(e));s=new("sequence"===e.repeated?ef:ep)({value:t})}else s=this.toASN(i);return s}}class tp{static serialize(e){return tf.serialize(e)}static parse(e,t){return td.parse(e,t)}static toString(e){let t=F(a.isBufferSource(e)?a.toArrayBuffer(e):tp.serialize(e));if(-1===t.offset)throw Error(`Cannot decode ASN.1 data. ${t.result.error}`);return t.result.toString()}}var tm=r(74533);class ty extends Error{constructor(e,t){super(t?`${e}. See the inner exception for more details.`:e),this.message=e,this.innerError=t}}class tg extends ty{constructor(e,t,r){super(t,r),this.schema=e}}class tb extends tg{constructor(e,t,r){super(e,`JSON doesn't match to '${e.target.name}' schema. ${t}`,r)}}class t_ extends ty{}class tv extends ty{constructor(e,t,r){super(`Cannot serialize by '${e}' schema. ${t}`,r),this.schemaName=e}}class tw extends tb{constructor(e,t,r={}){super(e,"Some keys doesn't match to schema"),this.keys=t,this.errors=r}}function tS(e,t){if(!function(e,t){switch(t){case s.Boolean:return"boolean"==typeof e;case s.Number:return"number"==typeof e;case s.String:return"string"==typeof e}return!0}(e,t))throw TypeError(`Value must be ${s[t]}`)}function tA(e){return e&&e.prototype?!!e.prototype.toJSON&&!!e.prototype.fromJSON||tA(e.prototype):!!(e&&e.toJSON&&e.fromJSON)}!function(e){e[e.Any=0]="Any",e[e.Boolean=1]="Boolean",e[e.Number=2]="Number",e[e.String=3]="String"}(s||(s={}));class tk{constructor(){this.items=new Map}has(e){return this.items.has(e)||!!this.findParentSchema(e)}get(e){let t=this.items.get(e)||this.findParentSchema(e);if(!t)throw Error("Cannot get schema for current target");return t}create(e){let t={names:{}},r=this.findParentSchema(e);if(r)for(let e in Object.assign(t,r),t.names={},r.names)t.names[e]=Object.assign({},r.names[e]);return t.target=e,t}set(e,t){return this.items.set(e,t),this}findParentSchema(e){let t=e.__proto__;return t?this.items.get(t)||this.findParentSchema(t):null}}let tE="default",tx=new tk;class tC{constructor(e){this.pattern=new RegExp(e)}validate(e){let t=new RegExp(this.pattern.source,this.pattern.flags);if("string"!=typeof e)throw new t_("Incoming value must be string");if(!t.exec(e))throw new t_(`Value doesn't match to pattern '${t.toString()}'`)}}class tP{constructor(e=Number.MIN_VALUE,t=Number.MAX_VALUE){this.min=e,this.max=t}validate(e){if(tS(e,s.Number),!(this.min<=e&&e<=this.max)){let e=this.min===Number.MIN_VALUE?"MIN":this.min,t=this.max===Number.MAX_VALUE?"MAX":this.max;throw new t_(`Value doesn't match to diapason [${e},${t}]`)}}}class tT{constructor(e=Number.MIN_VALUE,t=Number.MAX_VALUE){this.min=e,this.max=t}validate(e){if(tS(e,s.Number),!(this.min<e&&e<this.max)){let e=this.min===Number.MIN_VALUE?"MIN":this.min,t=this.max===Number.MAX_VALUE?"MAX":this.max;throw new t_(`Value doesn't match to diapason (${e},${t})`)}}}class tO{constructor(e,t,r){this.length=e,this.minLength=t,this.maxLength=r}validate(e){if(void 0!==this.length){if(e.length!==this.length)throw new t_(`Value length must be exactly ${this.length}.`);return}if(void 0!==this.minLength&&e.length<this.minLength)throw new t_(`Value length must be more than ${this.minLength}.`);if(void 0!==this.maxLength&&e.length>this.maxLength)throw new t_(`Value length must be less than ${this.maxLength}.`)}}class tB{constructor(e){this.enumeration=e}validate(e){if(tS(e,s.String),!this.enumeration.includes(e))throw new t_(`Value must be one of ${this.enumeration.map(e=>`'${e}'`).join(", ")}`)}}class tR{static checkValues(e,t){for(let r of Array.isArray(e)?e:[e])for(let i of t.validations)i instanceof tO&&t.repeated?i.validate(e):i.validate(r)}static checkTypes(e,t){if(t.repeated&&!Array.isArray(e))throw TypeError("Value must be Array");if("number"==typeof t.type)for(let r of Array.isArray(e)?e:[e])tS(r,t.type)}static getSchemaByName(e,t=tE){return{...e.names[tE],...e.names[t]}}}class tI extends tR{static serialize(e,t,r,i){return JSON.stringify(this.toJSON(e,t),r,i)}static toJSON(e,t={}){let r;let i=t.targetSchema,n=t.schemaName||tE;if(tA(e))return e.toJSON();if(Array.isArray(e))for(let i of(r=[],e))r.push(this.toJSON(i,t));else if("object"==typeof e){if(i&&!tx.has(i))throw new ty("Cannot get schema for `targetSchema` param");if(i=i||e.constructor,tx.has(i)){let t=tx.get(i);r={};let s=this.getSchemaByName(t,n);for(let o in s)try{let t;let a=s[o],l=e[o];if(a.optional&&void 0===l||void 0!==a.defaultValue&&l===a.defaultValue)continue;if(!a.optional&&void 0===l)throw new tv(i.name,`Property '${o}' is required.`);t="number"==typeof a.type?a.converter?a.repeated?l.map(t=>a.converter.toJSON(t,e)):a.converter.toJSON(l,e):l:a.repeated?l.map(e=>this.toJSON(e,{schemaName:n})):this.toJSON(l,{schemaName:n}),this.checkTypes(t,a),this.checkValues(t,a),r[a.name||o]=t}catch(e){if(e instanceof tv)throw e;throw new tv(t.target.name,`Property '${o}' is wrong. ${e.message}`,e)}}else for(let t in r={},e)r[t]=this.toJSON(e[t],{schemaName:n})}else r=e;return r}}class tN extends tR{static parse(e,t){let r=JSON.parse(e);return this.fromJSON(r,t)}static fromJSON(e,t){let r=t.targetSchema,i=t.schemaName||tE,n=new r;if(tA(n))return n.fromJSON(e);let s=tx.get(r),o=this.getSchemaByName(s,i),a={};for(let r in t.strictProperty&&!Array.isArray(e)&&tN.checkStrictProperty(e,o,s),o)try{let a=o[r],l=a.name||r,u=e[l];if(void 0===u&&(a.optional||void 0!==a.defaultValue))continue;if(!a.optional&&void 0===u)throw new tb(s,`Property '${l}' is required.`);if(this.checkTypes(u,a),this.checkValues(u,a),"number"==typeof a.type)a.converter?a.repeated?n[r]=u.map(e=>a.converter.fromJSON(e,n)):n[r]=a.converter.fromJSON(u,n):n[r]=u;else{let e={...t,targetSchema:a.type,schemaName:i};a.repeated?n[r]=u.map(t=>this.fromJSON(t,e)):n[r]=this.fromJSON(u,e)}}catch(e){if(e instanceof tb||(e=new tb(s,`Property '${r}' is wrong. ${e.message}`,e)),t.strictAllKeys)a[r]=e;else throw e}let l=Object.keys(a);if(l.length)throw new tw(s,l,a);return n}static checkStrictProperty(e,t,r){let i=Object.keys(e),n=Object.keys(t),s=[];for(let e of i)-1===n.indexOf(e)&&s.push(e);if(s.length)throw new tw(r,s)}}let tU=(e={})=>(t,r)=>{let i;let n=`Cannot set type for ${r} property of ${t.constructor.name} schema`;tx.has(t.constructor)?(i=tx.get(t.constructor)).target!==t.constructor&&(i=tx.create(t.constructor),tx.set(t.constructor,i)):(i=tx.create(t.constructor),tx.set(t.constructor,i));let o=Object.assign({type:s.Any,validations:[]},e);if(o.validations=function(e){let t=[];return e.pattern&&t.push(new tC(e.pattern)),(e.type===s.Number||e.type===s.Any)&&((void 0!==e.minInclusive||void 0!==e.maxInclusive)&&t.push(new tP(e.minInclusive,e.maxInclusive)),(void 0!==e.minExclusive||void 0!==e.maxExclusive)&&t.push(new tT(e.minExclusive,e.maxExclusive)),void 0!==e.enumeration&&t.push(new tB(e.enumeration))),(e.type===s.String||e.repeated||e.type===s.Any)&&(void 0!==e.length||void 0!==e.minLength||void 0!==e.maxLength)&&t.push(new tO(e.length,e.minLength,e.maxLength)),t}(o),"number"!=typeof o.type&&!tx.has(o.type)&&!tA(o.type))throw Error(`${n}. Assigning type doesn't have schema.`);for(let t of Array.isArray(e.schema)?e.schema:[e.schema||tE])i.names[t]||(i.names[t]={}),i.names[t][r]=o};/*!
 Copyright (c) Peculiar Ventures, LLC
*/class tL extends Error{}class tj extends tL{}class tK extends tL{constructor(e){super(`Unsupported operation: ${e?`${e}`:""}`)}}class tD extends tL{}class tM extends tL{constructor(e){super(`${e}: Missing required property`)}}class t${async digest(...e){return this.checkDigest.apply(this,e),this.onDigest.apply(this,e)}checkDigest(e,t){this.checkAlgorithmName(e)}async onDigest(e,t){throw new tK("digest")}async generateKey(...e){return this.checkGenerateKey.apply(this,e),this.onGenerateKey.apply(this,e)}checkGenerateKey(e,t,r,...i){let n;if(this.checkAlgorithmName(e),this.checkGenerateKeyParams(e),!(r&&r.length))throw TypeError("Usages cannot be empty when creating a key.");n=Array.isArray(this.usages)?this.usages:this.usages.privateKey.concat(this.usages.publicKey),this.checkKeyUsages(r,n)}checkGenerateKeyParams(e){}async onGenerateKey(e,t,r,...i){throw new tK("generateKey")}async sign(...e){return this.checkSign.apply(this,e),this.onSign.apply(this,e)}checkSign(e,t,r,...i){this.checkAlgorithmName(e),this.checkAlgorithmParams(e),this.checkCryptoKey(t,"sign")}async onSign(e,t,r,...i){throw new tK("sign")}async verify(...e){return this.checkVerify.apply(this,e),this.onVerify.apply(this,e)}checkVerify(e,t,r,i,...n){this.checkAlgorithmName(e),this.checkAlgorithmParams(e),this.checkCryptoKey(t,"verify")}async onVerify(e,t,r,i,...n){throw new tK("verify")}async encrypt(...e){return this.checkEncrypt.apply(this,e),this.onEncrypt.apply(this,e)}checkEncrypt(e,t,r,i={},...n){this.checkAlgorithmName(e),this.checkAlgorithmParams(e),this.checkCryptoKey(t,i.keyUsage?"encrypt":void 0)}async onEncrypt(e,t,r,...i){throw new tK("encrypt")}async decrypt(...e){return this.checkDecrypt.apply(this,e),this.onDecrypt.apply(this,e)}checkDecrypt(e,t,r,i={},...n){this.checkAlgorithmName(e),this.checkAlgorithmParams(e),this.checkCryptoKey(t,i.keyUsage?"decrypt":void 0)}async onDecrypt(e,t,r,...i){throw new tK("decrypt")}async deriveBits(...e){return this.checkDeriveBits.apply(this,e),this.onDeriveBits.apply(this,e)}checkDeriveBits(e,t,r,i={},...n){if(this.checkAlgorithmName(e),this.checkAlgorithmParams(e),this.checkCryptoKey(t,i.keyUsage?"deriveBits":void 0),r%8!=0)throw new tD("length: Is not multiple of 8")}async onDeriveBits(e,t,r,...i){throw new tK("deriveBits")}async exportKey(...e){return this.checkExportKey.apply(this,e),this.onExportKey.apply(this,e)}checkExportKey(e,t,...r){if(this.checkKeyFormat(e),this.checkCryptoKey(t),!t.extractable)throw new tL("key: Is not extractable")}async onExportKey(e,t,...r){throw new tK("exportKey")}async importKey(...e){return this.checkImportKey.apply(this,e),this.onImportKey.apply(this,e)}checkImportKey(e,t,r,i,n,...s){this.checkKeyFormat(e),this.checkKeyData(e,t),this.checkAlgorithmName(r),this.checkImportParams(r),Array.isArray(this.usages)&&this.checkKeyUsages(n,this.usages)}async onImportKey(e,t,r,i,n,...s){throw new tK("importKey")}checkAlgorithmName(e){if(e.name.toLowerCase()!==this.name.toLowerCase())throw new tj("Unrecognized name")}checkAlgorithmParams(e){}checkDerivedKeyParams(e){}checkKeyUsages(e,t){for(let r of e)if(-1===t.indexOf(r))throw TypeError("Cannot create a key using the specified key usages")}checkCryptoKey(e,t){if(this.checkAlgorithmName(e.algorithm),t&&-1===e.usages.indexOf(t))throw new tL("key does not match that of operation")}checkRequiredProperty(e,t){if(!(t in e))throw new tM(t)}checkHashAlgorithm(e,t){for(let r of t)if(r.toLowerCase()===e.name.toLowerCase())return;throw new tD(`hash: Must be one of ${t.join(", ")}`)}checkImportParams(e){}checkKeyFormat(e){switch(e){case"raw":case"pkcs8":case"spki":case"jwk":break;default:throw TypeError("format: Is invalid value. Must be 'jwk', 'raw', 'spki', or 'pkcs8'")}}checkKeyData(e,t){if(!t)throw TypeError("keyData: Cannot be empty on empty on key importing");if("jwk"===e){if(!("object"==typeof t&&"kty"in t))throw TypeError("keyData: Is not JsonWebToken")}else if(!a.isBufferSource(t))throw TypeError("keyData: Is not ArrayBufferView or ArrayBuffer")}prepareData(e){return a.toArrayBuffer(e)}}class tq extends t${checkGenerateKeyParams(e){if(this.checkRequiredProperty(e,"length"),"number"!=typeof e.length)throw TypeError("length: Is not of type Number");switch(e.length){case 128:case 192:case 256:break;default:throw TypeError("length: Must be 128, 192, or 256")}}checkDerivedKeyParams(e){this.checkGenerateKeyParams(e)}}class tH extends tq{constructor(){super(...arguments),this.name="AES-CBC",this.usages=["encrypt","decrypt","wrapKey","unwrapKey"]}checkAlgorithmParams(e){if(this.checkRequiredProperty(e,"iv"),!(e.iv instanceof ArrayBuffer||ArrayBuffer.isView(e.iv)))throw TypeError("iv: Is not of type '(ArrayBuffer or ArrayBufferView)'");if(16!==e.iv.byteLength)throw TypeError("iv: Must have length 16 bytes")}}class tz extends tq{constructor(){super(...arguments),this.name="AES-CMAC",this.usages=["sign","verify"]}checkAlgorithmParams(e){if(this.checkRequiredProperty(e,"length"),"number"!=typeof e.length)throw TypeError("length: Is not a Number");if(e.length<1)throw new tD("length: Must be more than 0")}}class tF extends tq{constructor(){super(...arguments),this.name="AES-CTR",this.usages=["encrypt","decrypt","wrapKey","unwrapKey"]}checkAlgorithmParams(e){if(this.checkRequiredProperty(e,"counter"),!(e.counter instanceof ArrayBuffer||ArrayBuffer.isView(e.counter)))throw TypeError("counter: Is not of type '(ArrayBuffer or ArrayBufferView)'");if(16!==e.counter.byteLength)throw TypeError("iv: Must have length 16 bytes");if(this.checkRequiredProperty(e,"length"),"number"!=typeof e.length)throw TypeError("length: Is not a Number");if(e.length<1)throw new tD("length: Must be more than 0")}}class tV extends tq{constructor(){super(...arguments),this.name="AES-ECB",this.usages=["encrypt","decrypt","wrapKey","unwrapKey"]}}class tW extends tq{constructor(){super(...arguments),this.name="AES-GCM",this.usages=["encrypt","decrypt","wrapKey","unwrapKey"]}checkAlgorithmParams(e){if(this.checkRequiredProperty(e,"iv"),!(e.iv instanceof ArrayBuffer||ArrayBuffer.isView(e.iv)))throw TypeError("iv: Is not of type '(ArrayBuffer or ArrayBufferView)'");if(e.iv.byteLength<1)throw new tD("iv: Must have length more than 0 and less than 2^64 - 1");switch("tagLength"in e||(e.tagLength=128),e.tagLength){case 32:case 64:case 96:case 104:case 112:case 120:case 128:break;default:throw new tD("tagLength: Must be one of 32, 64, 96, 104, 112, 120 or 128")}}}class tJ extends tq{constructor(){super(...arguments),this.name="AES-KW",this.usages=["wrapKey","unwrapKey"]}}class tG extends t${constructor(){super(...arguments),this.usages=["encrypt","decrypt","wrapKey","unwrapKey"]}checkAlgorithmParams(e){if(this.ivSize){if(this.checkRequiredProperty(e,"iv"),!(e.iv instanceof ArrayBuffer||ArrayBuffer.isView(e.iv)))throw TypeError("iv: Is not of type '(ArrayBuffer or ArrayBufferView)'");if(e.iv.byteLength!==this.ivSize)throw TypeError(`iv: Must have length ${this.ivSize} bytes`)}}checkGenerateKeyParams(e){if(this.checkRequiredProperty(e,"length"),"number"!=typeof e.length)throw TypeError("length: Is not of type Number");if(e.length!==this.keySizeBits)throw new tD(`algorithm.length: Must be ${this.keySizeBits}`)}checkDerivedKeyParams(e){this.checkGenerateKeyParams(e)}}class tY extends t${constructor(){super(...arguments),this.hashAlgorithms=["SHA-1","SHA-256","SHA-384","SHA-512"]}checkGenerateKeyParams(e){if(this.checkRequiredProperty(e,"hash"),this.checkHashAlgorithm(e.hash,this.hashAlgorithms),this.checkRequiredProperty(e,"publicExponent"),!(e.publicExponent&&e.publicExponent instanceof Uint8Array))throw TypeError("publicExponent: Missing or not a Uint8Array");let t=p.ToBase64(e.publicExponent);if(!("Aw=="===t||"AQAB"===t))throw TypeError("publicExponent: Must be [3] or [1,0,1]");if(this.checkRequiredProperty(e,"modulusLength"),e.modulusLength%8||e.modulusLength<256||e.modulusLength>16384)throw TypeError("The modulus length must be a multiple of 8 bits and >= 256 and <= 16384")}checkImportParams(e){this.checkRequiredProperty(e,"hash"),this.checkHashAlgorithm(e.hash,this.hashAlgorithms)}}class tX extends tY{constructor(){super(...arguments),this.name="RSASSA-PKCS1-v1_5",this.usages={privateKey:["sign"],publicKey:["verify"]}}}class tQ extends tY{constructor(){super(...arguments),this.name="RSA-PSS",this.usages={privateKey:["sign"],publicKey:["verify"]}}checkAlgorithmParams(e){if(this.checkRequiredProperty(e,"saltLength"),"number"!=typeof e.saltLength)throw TypeError("saltLength: Is not a Number");if(e.saltLength<0)throw RangeError("saltLength: Must be positive number")}}class tZ extends tY{constructor(){super(...arguments),this.name="RSA-OAEP",this.usages={privateKey:["decrypt","unwrapKey"],publicKey:["encrypt","wrapKey"]}}checkAlgorithmParams(e){if(e.label&&!(e.label instanceof ArrayBuffer||ArrayBuffer.isView(e.label)))throw TypeError("label: Is not of type '(ArrayBuffer or ArrayBufferView)'")}}class t0 extends t${checkGenerateKeyParams(e){this.checkRequiredProperty(e,"namedCurve"),this.checkNamedCurve(e.namedCurve)}checkNamedCurve(e){for(let t of this.namedCurves)if(t.toLowerCase()===e.toLowerCase())return;throw new tD(`namedCurve: Must be one of ${this.namedCurves.join(", ")}`)}}class t1 extends t0{constructor(){super(...arguments),this.name="ECDSA",this.hashAlgorithms=["SHA-1","SHA-256","SHA-384","SHA-512"],this.usages={privateKey:["sign"],publicKey:["verify"]},this.namedCurves=["P-256","P-384","P-521","K-256"]}checkAlgorithmParams(e){this.checkRequiredProperty(e,"hash"),this.checkHashAlgorithm(e.hash,this.hashAlgorithms)}}let t2=["secret","private","public"];class t8{static create(e,t,r,i){let n=new this;return n.algorithm=e,n.type=t,n.extractable=r,n.usages=i,n}static isKeyType(e){return -1!==t2.indexOf(e)}get[Symbol.toStringTag](){return"CryptoKey"}}class t3 extends t0{constructor(){super(...arguments),this.name="ECDH",this.usages={privateKey:["deriveBits","deriveKey"],publicKey:[]},this.namedCurves=["P-256","P-384","P-521","K-256"]}checkAlgorithmParams(e){if(this.checkRequiredProperty(e,"public"),!(e.public instanceof t8))throw TypeError("public: Is not a CryptoKey");if("public"!==e.public.type)throw new tD("public: Is not a public key");if(e.public.algorithm.name!==this.name)throw new tD(`public: Is not ${this.name} key`)}}class t4 extends t3{constructor(){super(...arguments),this.name="ECDH-ES",this.namedCurves=["X25519","X448"]}}class t5 extends t0{constructor(){super(...arguments),this.name="EdDSA",this.usages={privateKey:["sign"],publicKey:["verify"]},this.namedCurves=["Ed25519","Ed448"]}}let t6=class{constructor(e){e&&(this.value=e)}};(0,tm.gn)([tc({type:n.ObjectIdentifier})],t6.prototype,"value",void 0),t6=(0,tm.gn)([tu({type:i.Choice})],t6);class t7{constructor(e){Object.assign(this,e)}}(0,tm.gn)([tc({type:n.ObjectIdentifier})],t7.prototype,"algorithm",void 0),(0,tm.gn)([tc({type:n.Any,optional:!0})],t7.prototype,"parameters",void 0);class t9{constructor(){this.version=0,this.privateKeyAlgorithm=new t7,this.privateKey=new ArrayBuffer(0)}}(0,tm.gn)([tc({type:n.Integer})],t9.prototype,"version",void 0),(0,tm.gn)([tc({type:t7})],t9.prototype,"privateKeyAlgorithm",void 0),(0,tm.gn)([tc({type:n.OctetString})],t9.prototype,"privateKey",void 0),(0,tm.gn)([tc({type:n.Any,optional:!0})],t9.prototype,"attributes",void 0);class re{constructor(){this.publicKeyAlgorithm=new t7,this.publicKey=new ArrayBuffer(0)}}(0,tm.gn)([tc({type:t7})],re.prototype,"publicKeyAlgorithm",void 0),(0,tm.gn)([tc({type:n.BitString})],re.prototype,"publicKey",void 0);let rt={fromJSON:e=>p.FromBase64Url(e),toJSON:e=>p.ToBase64Url(new Uint8Array(e))},rr={fromASN:e=>{let t=e.valueBlock.valueHex;return new Uint8Array(t)[0]?e.valueBlock.valueHex:e.valueBlock.valueHex.slice(1)},toASN:e=>new es({valueHex:new Uint8Array(e)[0]>127?m(new Uint8Array([0]).buffer,e):e})};class ri{constructor(){this.version=0,this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0),this.privateExponent=new ArrayBuffer(0),this.prime1=new ArrayBuffer(0),this.prime2=new ArrayBuffer(0),this.exponent1=new ArrayBuffer(0),this.exponent2=new ArrayBuffer(0),this.coefficient=new ArrayBuffer(0)}}(0,tm.gn)([tc({type:n.Integer,converter:eW})],ri.prototype,"version",void 0),(0,tm.gn)([tc({type:n.Integer,converter:rr}),tU({name:"n",converter:rt})],ri.prototype,"modulus",void 0),(0,tm.gn)([tc({type:n.Integer,converter:rr}),tU({name:"e",converter:rt})],ri.prototype,"publicExponent",void 0),(0,tm.gn)([tc({type:n.Integer,converter:rr}),tU({name:"d",converter:rt})],ri.prototype,"privateExponent",void 0),(0,tm.gn)([tc({type:n.Integer,converter:rr}),tU({name:"p",converter:rt})],ri.prototype,"prime1",void 0),(0,tm.gn)([tc({type:n.Integer,converter:rr}),tU({name:"q",converter:rt})],ri.prototype,"prime2",void 0),(0,tm.gn)([tc({type:n.Integer,converter:rr}),tU({name:"dp",converter:rt})],ri.prototype,"exponent1",void 0),(0,tm.gn)([tc({type:n.Integer,converter:rr}),tU({name:"dq",converter:rt})],ri.prototype,"exponent2",void 0),(0,tm.gn)([tc({type:n.Integer,converter:rr}),tU({name:"qi",converter:rt})],ri.prototype,"coefficient",void 0),(0,tm.gn)([tc({type:n.Any,optional:!0})],ri.prototype,"otherPrimeInfos",void 0);class rn{constructor(){this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0)}}(0,tm.gn)([tc({type:n.Integer,converter:rr}),tU({name:"n",converter:rt})],rn.prototype,"modulus",void 0),(0,tm.gn)([tc({type:n.Integer,converter:rr}),tU({name:"e",converter:rt})],rn.prototype,"publicExponent",void 0);let rs=class{constructor(e){this.value=new ArrayBuffer(0),e&&(this.value=e)}toJSON(){let e=new Uint8Array(this.value);if(4!==e[0])throw new tL("Wrong ECPoint. Current version supports only Uncompressed (0x04) point");let t=(e=new Uint8Array(this.value.slice(1))).length/2;return{x:p.ToBase64Url(e.buffer.slice(0,0+t)),y:p.ToBase64Url(e.buffer.slice(0+t,0+t+t))}}fromJSON(e){if(!("x"in e))throw Error("x: Missing required property");if(!("y"in e))throw Error("y: Missing required property");let t=p.FromBase64Url(e.x),r=p.FromBase64Url(e.y),i=m(new Uint8Array([4]).buffer,t,r);return this.value=new Uint8Array(i).buffer,this}};(0,tm.gn)([tc({type:n.OctetString})],rs.prototype,"value",void 0),rs=(0,tm.gn)([tu({type:i.Choice})],rs);class ro{constructor(){this.version=1,this.privateKey=new ArrayBuffer(0)}fromJSON(e){if(!("d"in e))throw Error("d: Missing required property");if(this.privateKey=p.FromBase64Url(e.d),"x"in e){let t=new rs;t.fromJSON(e);let r=tf.toASN(t);"valueHex"in r.valueBlock&&(this.publicKey=r.valueBlock.valueHex)}return this}toJSON(){let e={};return e.d=p.ToBase64Url(this.privateKey),this.publicKey&&Object.assign(e,new rs(this.publicKey).toJSON()),e}}(0,tm.gn)([tc({type:n.Integer,converter:eW})],ro.prototype,"version",void 0),(0,tm.gn)([tc({type:n.OctetString})],ro.prototype,"privateKey",void 0),(0,tm.gn)([tc({context:0,type:n.Any,optional:!0})],ro.prototype,"parameters",void 0),(0,tm.gn)([tc({context:1,type:n.BitString,optional:!0})],ro.prototype,"publicKey",void 0);let ra={fromASN:e=>{let t=new Uint8Array(e.valueBlock.valueHex);return 0===t[0]?t.buffer.slice(1):t.buffer},toASN:e=>{let t=new Uint8Array(e);if(t[0]>127){let e=new Uint8Array(t.length+1);return e.set(t,1),new es({valueHex:e.buffer})}return new es({valueHex:e})}};var rl=Object.freeze({__proto__:null,AsnIntegerWithoutPaddingConverter:ra});class ru{static decodePoint(e,t){let r=a.toUint8Array(e);if(0===r.length||4!==r[0])throw Error("Only uncompressed point format supported");let i=(r.length-1)/2;if(i!==Math.ceil(t/8))throw Error("Point does not match field size");return{x:r.slice(1,i+1),y:r.slice(i+1,i+1+i)}}static encodePoint(e,t){let r=Math.ceil(t/8);if(e.x.byteLength!==r||e.y.byteLength!==r)throw Error("X,Y coordinates don't match point size criteria");let i=a.toUint8Array(e.x),n=a.toUint8Array(e.y),s=new Uint8Array(2*r+1);return s[0]=4,s.set(i,1),s.set(n,r+1),s}static getSize(e){return Math.ceil(e/8)}static encodeSignature(e,t){let r=this.getSize(t),i=a.toUint8Array(e.r),n=a.toUint8Array(e.s),s=new Uint8Array(2*r);return s.set(this.padStart(i,r)),s.set(this.padStart(n,r),r),s}static decodeSignature(e,t){let r=this.getSize(t),i=a.toUint8Array(e);if(i.length!==2*r)throw Error("Incorrect size of the signature");let n=i.slice(0,r),s=i.slice(r);return{r:this.trimStart(n),s:this.trimStart(s)}}static trimStart(e){let t=0;for(;t<e.length-1&&0===e[t];)t++;return 0===t?e:e.slice(t,e.length)}static padStart(e,t){if(t===e.length)return e;let r=new Uint8Array(t);return r.set(e,t-e.length),r}}class rc{constructor(){this.r=new ArrayBuffer(0),this.s=new ArrayBuffer(0)}static fromWebCryptoSignature(e){let t=e.byteLength/2,r=ru.decodeSignature(e,8*t),i=new rc;return i.r=a.toArrayBuffer(r.r),i.s=a.toArrayBuffer(r.s),i}toWebCryptoSignature(e){return null!=e||(e=8*Math.max(this.r.byteLength,this.s.byteLength)),ru.encodeSignature(this,e).buffer}}(0,tm.gn)([tc({type:n.Integer,converter:ra})],rc.prototype,"r",void 0),(0,tm.gn)([tc({type:n.Integer,converter:ra})],rc.prototype,"s",void 0);class rh extends t9{}(0,tm.gn)([tc({context:1,implicit:!0,type:n.BitString,optional:!0})],rh.prototype,"publicKey",void 0);let rd=class{constructor(){this.value=new ArrayBuffer(0)}fromJSON(e){if(!e.d)throw Error("d: Missing required property");return this.value=p.FromBase64Url(e.d),this}toJSON(){return{d:p.ToBase64Url(this.value)}}};(0,tm.gn)([tc({type:n.OctetString})],rd.prototype,"value",void 0),rd=(0,tm.gn)([tu({type:i.Choice})],rd);let rf=class{constructor(e){this.value=new ArrayBuffer(0),e&&(this.value=e)}toJSON(){return{x:p.ToBase64Url(this.value)}}fromJSON(e){if(!("x"in e))throw Error("x: Missing required property");return this.value=p.FromBase64Url(e.x),this}};(0,tm.gn)([tc({type:n.BitString})],rf.prototype,"value",void 0),rf=(0,tm.gn)([tu({type:i.Choice})],rf);let rp=class{};(0,tm.gn)([tc({type:n.OctetString}),tU({type:s.String,converter:rt})],rp.prototype,"d",void 0),rp=(0,tm.gn)([tu({type:i.Choice})],rp);let rm="1.2.840.10045.3.1.7",ry="1.3.132.0",rg=`${ry}.34`,rb=`${ry}.35`,r_=`${ry}.10`,rv="1.3.36.3.3.2.8.1.1",rw=`${rv}.1`,rS=`${rv}.2`,rA=`${rv}.3`,rk=`${rv}.4`,rE=`${rv}.5`,rx=`${rv}.6`,rC=`${rv}.7`,rP=`${rv}.8`,rT=`${rv}.9`,rO=`${rv}.10`,rB=`${rv}.11`,rR=`${rv}.12`,rI=`${rv}.13`,rN=`${rv}.14`;var rU=Object.freeze({__proto__:null,AlgorithmIdentifier:t7,get CurvePrivateKey(){return rp},EcDsaSignature:rc,EcPrivateKey:ro,get EcPublicKey(){return rs},get EdPrivateKey(){return rd},get EdPublicKey(){return rf},get ObjectIdentifier(){return t6},OneAsymmetricKey:rh,PrivateKeyInfo:t9,PublicKeyInfo:re,RsaPrivateKey:ri,RsaPublicKey:rn,converters:rl,idBrainpoolP160r1:rw,idBrainpoolP160t1:rS,idBrainpoolP192r1:rA,idBrainpoolP192t1:rk,idBrainpoolP224r1:rE,idBrainpoolP224t1:rx,idBrainpoolP256r1:rC,idBrainpoolP256t1:rP,idBrainpoolP320r1:rT,idBrainpoolP320t1:rO,idBrainpoolP384r1:rB,idBrainpoolP384t1:rR,idBrainpoolP512r1:rI,idBrainpoolP512t1:rN,idEd25519:"1.3.101.112",idEd448:"1.3.101.113",idEllipticCurve:ry,idSecp256k1:r_,idSecp256r1:rm,idSecp384r1:rg,idSecp521r1:rb,idVersionOne:rv,idX25519:"1.3.101.110",idX448:"1.3.101.111"});class rL{constructor(){}static register(e){let t=new t6;t.value=e.id;let r=tp.serialize(t);this.items.push({...e,raw:r}),this.names.push(e.name)}static find(e){for(let t of(e=e.toUpperCase(),this.items))if(t.name.toUpperCase()===e||t.id.toUpperCase()===e)return t;return null}static get(e){let t=this.find(e);if(!t)throw Error(`Unsupported EC named curve '${e}'`);return t}}rL.items=[],rL.names=[],rL.register({name:"P-256",id:rm,size:256}),rL.register({name:"P-384",id:rg,size:384}),rL.register({name:"P-521",id:rb,size:521}),rL.register({name:"K-256",id:r_,size:256}),rL.register({name:"brainpoolP160r1",id:rw,size:160}),rL.register({name:"brainpoolP160t1",id:rS,size:160}),rL.register({name:"brainpoolP192r1",id:rA,size:192}),rL.register({name:"brainpoolP192t1",id:rk,size:192}),rL.register({name:"brainpoolP224r1",id:rE,size:224}),rL.register({name:"brainpoolP224t1",id:rx,size:224}),rL.register({name:"brainpoolP256r1",id:rC,size:256}),rL.register({name:"brainpoolP256t1",id:rP,size:256}),rL.register({name:"brainpoolP320r1",id:rT,size:320}),rL.register({name:"brainpoolP320t1",id:rO,size:320}),rL.register({name:"brainpoolP384r1",id:rB,size:384}),rL.register({name:"brainpoolP384t1",id:rR,size:384}),rL.register({name:"brainpoolP512r1",id:rI,size:512}),rL.register({name:"brainpoolP512t1",id:rN,size:512});class rj extends t${constructor(){super(...arguments),this.name="HMAC",this.hashAlgorithms=["SHA-1","SHA-256","SHA-384","SHA-512"],this.usages=["sign","verify"]}getDefaultLength(e){switch(e.toUpperCase()){case"SHA-1":case"SHA-256":case"SHA-384":case"SHA-512":return 512;default:throw Error(`Unknown algorithm name '${e}'`)}}checkGenerateKeyParams(e){if(this.checkRequiredProperty(e,"hash"),this.checkHashAlgorithm(e.hash,this.hashAlgorithms),"length"in e){if("number"!=typeof e.length)throw TypeError("length: Is not a Number");if(e.length<1)throw RangeError("length: Number is out of range")}}checkImportParams(e){this.checkRequiredProperty(e,"hash"),this.checkHashAlgorithm(e.hash,this.hashAlgorithms)}}class rK extends t${constructor(){super(...arguments),this.name="PBKDF2",this.hashAlgorithms=["SHA-1","SHA-256","SHA-384","SHA-512"],this.usages=["deriveBits","deriveKey"]}checkAlgorithmParams(e){if(this.checkRequiredProperty(e,"hash"),this.checkHashAlgorithm(e.hash,this.hashAlgorithms),this.checkRequiredProperty(e,"salt"),!(e.salt instanceof ArrayBuffer||ArrayBuffer.isView(e.salt)))throw TypeError("salt: Is not of type '(ArrayBuffer or ArrayBufferView)'");if(this.checkRequiredProperty(e,"iterations"),"number"!=typeof e.iterations)throw TypeError("iterations: Is not a Number");if(e.iterations<1)throw TypeError("iterations: Is less than 1")}checkImportKey(e,t,r,i,n,...s){if(super.checkImportKey(e,t,r,i,n,...s),i)throw SyntaxError("extractable: Must be 'false'")}}class rD extends t${constructor(){super(...arguments),this.name="HKDF",this.hashAlgorithms=["SHA-1","SHA-256","SHA-384","SHA-512"],this.usages=["deriveKey","deriveBits"]}checkAlgorithmParams(e){if(this.checkRequiredProperty(e,"hash"),this.checkHashAlgorithm(e.hash,this.hashAlgorithms),this.checkRequiredProperty(e,"salt"),!a.isBufferSource(e.salt)||(this.checkRequiredProperty(e,"info"),!a.isBufferSource(e.info)))throw TypeError("salt: Is not of type '(ArrayBuffer or ArrayBufferView)'")}checkImportKey(e,t,r,i,n,...s){if(super.checkImportKey(e,t,r,i,n,...s),i)throw SyntaxError("extractable: Must be 'false'")}}class rM extends t${constructor(){super(...arguments),this.usages=[],this.defaultLength=0}digest(...e){return e[0]={length:this.defaultLength,...e[0]},super.digest.apply(this,e)}checkDigest(e,t){super.checkDigest(e,t);let r=e.length||0;if("number"!=typeof r)throw TypeError("length: Is not a Number");if(r<0)throw TypeError("length: Is negative")}}class r$ extends rM{constructor(){super(...arguments),this.name="shake128",this.defaultLength=16}}class rq extends rM{constructor(){super(...arguments),this.name="shake256",this.defaultLength=32}}class rH{get[Symbol.toStringTag](){return"Crypto"}randomUUID(){let e=this.getRandomValues(new Uint8Array(16));e[6]=15&e[6]|64,e[8]=63&e[8]|128;let t=p.ToHex(e).toLowerCase();return`${t.substring(0,8)}-${t.substring(8,12)}-${t.substring(12,16)}-${t.substring(16,20)}-${t.substring(20)}`}}class rz{constructor(){this.items={}}get(e){return this.items[e.toLowerCase()]||null}set(e){this.items[e.name.toLowerCase()]=e}removeAt(e){let t=this.get(e.toLowerCase());return t&&delete this.items[e],t}has(e){return!!this.get(e)}get length(){return Object.keys(this.items).length}get algorithms(){let e=[];for(let t in this.items){let r=this.items[t];e.push(r.name)}return e.sort()}}class rF{constructor(){this.providers=new rz}static isHashedAlgorithm(e){return!!e&&"object"==typeof e&&"name"in e&&"hash"in e}get[Symbol.toStringTag](){return"SubtleCrypto"}async digest(...e){this.checkRequiredArguments(e,2,"digest");let[t,r,...i]=e,n=this.prepareAlgorithm(t),s=a.toArrayBuffer(r),o=this.getProvider(n.name);return await o.digest(n,s,...i)}async generateKey(...e){this.checkRequiredArguments(e,3,"generateKey");let[t,r,i,...n]=e,s=this.prepareAlgorithm(t),o=this.getProvider(s.name);return await o.generateKey({...s,name:o.name},r,i,...n)}async sign(...e){this.checkRequiredArguments(e,3,"sign");let[t,r,i,...n]=e;this.checkCryptoKey(r);let s=this.prepareAlgorithm(t),o=a.toArrayBuffer(i),l=this.getProvider(s.name);return await l.sign({...s,name:l.name},r,o,...n)}async verify(...e){this.checkRequiredArguments(e,4,"verify");let[t,r,i,n,...s]=e;this.checkCryptoKey(r);let o=this.prepareAlgorithm(t),l=a.toArrayBuffer(n),u=a.toArrayBuffer(i),c=this.getProvider(o.name);return await c.verify({...o,name:c.name},r,u,l,...s)}async encrypt(...e){this.checkRequiredArguments(e,3,"encrypt");let[t,r,i,...n]=e;this.checkCryptoKey(r);let s=this.prepareAlgorithm(t),o=a.toArrayBuffer(i),l=this.getProvider(s.name);return await l.encrypt({...s,name:l.name},r,o,{keyUsage:!0},...n)}async decrypt(...e){this.checkRequiredArguments(e,3,"decrypt");let[t,r,i,...n]=e;this.checkCryptoKey(r);let s=this.prepareAlgorithm(t),o=a.toArrayBuffer(i),l=this.getProvider(s.name);return await l.decrypt({...s,name:l.name},r,o,{keyUsage:!0},...n)}async deriveBits(...e){this.checkRequiredArguments(e,3,"deriveBits");let[t,r,i,...n]=e;this.checkCryptoKey(r);let s=this.prepareAlgorithm(t),o=this.getProvider(s.name);return await o.deriveBits({...s,name:o.name},r,i,{keyUsage:!0},...n)}async deriveKey(...e){this.checkRequiredArguments(e,5,"deriveKey");let[t,r,i,n,s,...o]=e,a=this.prepareAlgorithm(i);this.getProvider(a.name).checkDerivedKeyParams(a);let l=this.prepareAlgorithm(t),u=this.getProvider(l.name);u.checkCryptoKey(r,"deriveKey");let c=await u.deriveBits({...l,name:u.name},r,i.length||512,{keyUsage:!1},...o);return this.importKey("raw",c,i,n,s,...o)}async exportKey(...e){this.checkRequiredArguments(e,2,"exportKey");let[t,r,...i]=e;this.checkCryptoKey(r);let n=this.getProvider(r.algorithm.name);return await n.exportKey(t,r,...i)}async importKey(...e){this.checkRequiredArguments(e,5,"importKey");let[t,r,i,n,s,...o]=e,l=this.prepareAlgorithm(i),u=this.getProvider(l.name);if(-1!==["pkcs8","spki","raw"].indexOf(t)){let e=a.toArrayBuffer(r);return u.importKey(t,e,{...l,name:u.name},n,s,...o)}if(!r.kty)throw TypeError("keyData: Is not JSON");return u.importKey(t,r,{...l,name:u.name},n,s,...o)}async wrapKey(e,t,r,i,...n){let s=await this.exportKey(e,t,...n);if("jwk"===e){let e=JSON.stringify(s);s=p.FromUtf8String(e)}let o=this.prepareAlgorithm(i),l=a.toArrayBuffer(s),u=this.getProvider(o.name);return u.encrypt({...o,name:u.name},r,l,{keyUsage:!1},...n)}async unwrapKey(e,t,r,i,n,s,o,...l){let u=this.prepareAlgorithm(i),c=a.toArrayBuffer(t),h=this.getProvider(u.name),d=await h.decrypt({...u,name:h.name},r,c,{keyUsage:!1},...l);if("jwk"===e)try{d=JSON.parse(p.ToUtf8String(d))}catch(t){let e=TypeError("wrappedKey: Is not a JSON");throw e.internal=t,e}return this.importKey(e,d,n,s,o,...l)}checkRequiredArguments(e,t,r){if(e.length<t)throw TypeError(`Failed to execute '${r}' on 'SubtleCrypto': ${t} arguments required, but only ${e.length} present`)}prepareAlgorithm(e){if("string"==typeof e)return{name:e};if(rF.isHashedAlgorithm(e)){let t={...e};return t.hash=this.prepareAlgorithm(e.hash),t}return{...e}}getProvider(e){let t=this.providers.get(e);if(!t)throw new tj("Unrecognized name");return t}checkCryptoKey(e){if(!(e instanceof t8))throw TypeError("Key is not of type 'CryptoKey'")}}var rV=r(6113),rW=r.n(rV),rJ=r(77282);/*!
 Copyright (c) Peculiar Ventures, LLC
*/let rG={fromJSON:e=>Buffer.from(p.FromBase64Url(e)),toJSON:e=>p.ToBase64Url(e)};class rY extends t8{constructor(){super(...arguments),this.data=Buffer.alloc(0),this.algorithm={name:""},this.extractable=!1,this.type="secret",this.usages=[],this.kty="oct",this.alg=""}}(0,tm.gn)([tU({name:"ext",type:s.Boolean,optional:!0})],rY.prototype,"extractable",void 0),(0,tm.gn)([tU({name:"key_ops",type:s.String,repeated:!0,optional:!0})],rY.prototype,"usages",void 0),(0,tm.gn)([tU({type:s.String})],rY.prototype,"kty",void 0),(0,tm.gn)([tU({type:s.String,optional:!0})],rY.prototype,"alg",void 0);class rX extends rY{constructor(){super(...arguments),this.kty="oct",this.type="secret"}}class rQ extends rY{}class rZ extends rX{get alg(){switch(this.algorithm.name.toUpperCase()){case"AES-CBC":return`A${this.algorithm.length}CBC`;case"AES-CTR":return`A${this.algorithm.length}CTR`;case"AES-GCM":return`A${this.algorithm.length}GCM`;case"AES-KW":return`A${this.algorithm.length}KW`;case"AES-CMAC":return`A${this.algorithm.length}CMAC`;case"AES-ECB":return`A${this.algorithm.length}ECB`;default:throw new tj("Unsupported algorithm name")}}set alg(e){}}(0,tm.gn)([tU({name:"k",converter:rG})],rZ.prototype,"data",void 0);let r0=new WeakMap;function r1(e){let t=r0.get(e);if(!t)throw new tD("Cannot get CryptoKey from secure storage");return t}function r2(e){let t=t8.create(e.algorithm,e.type,e.extractable,e.usages);return Object.freeze(t),r0.set(t,e),t}class r8{static async generateKey(e,t,r){let i=new rZ;return i.algorithm=e,i.extractable=t,i.usages=r,i.data=rW().randomBytes(e.length>>3),i}static async exportKey(e,t){if(!(t instanceof rZ))throw Error("key: Is not AesCryptoKey");switch(e.toLowerCase()){case"jwk":return tI.toJSON(t);case"raw":return new Uint8Array(t.data).buffer;default:throw new tD("format: Must be 'jwk' or 'raw'")}}static async importKey(e,t,r,i,n){let s;switch(e.toLowerCase()){case"jwk":s=tN.fromJSON(t,{targetSchema:rZ});break;case"raw":(s=new rZ).data=Buffer.from(t);break;default:throw new tD("format: Must be 'jwk' or 'raw'")}switch(s.algorithm=r,s.algorithm.length=s.data.length<<3,s.extractable=i,s.usages=n,s.algorithm.length){case 128:case 192:case 256:break;default:throw new tD("keyData: Is wrong key length")}return s}static async encrypt(e,t,r){switch(e.name.toUpperCase()){case"AES-CBC":return this.encryptAesCBC(e,t,Buffer.from(r));case"AES-CTR":return this.encryptAesCTR(e,t,Buffer.from(r));case"AES-GCM":return this.encryptAesGCM(e,t,Buffer.from(r));case"AES-KW":return this.encryptAesKW(e,t,Buffer.from(r));case"AES-ECB":return this.encryptAesECB(e,t,Buffer.from(r));default:throw new tD("algorithm: Is not recognized")}}static async decrypt(e,t,r){if(!(t instanceof rZ))throw Error("key: Is not AesCryptoKey");switch(e.name.toUpperCase()){case"AES-CBC":return this.decryptAesCBC(e,t,Buffer.from(r));case"AES-CTR":return this.decryptAesCTR(e,t,Buffer.from(r));case"AES-GCM":return this.decryptAesGCM(e,t,Buffer.from(r));case"AES-KW":return this.decryptAesKW(e,t,Buffer.from(r));case"AES-ECB":return this.decryptAesECB(e,t,Buffer.from(r));default:throw new tD("algorithm: Is not recognized")}}static async encryptAesCBC(e,t,r){let i=rW().createCipheriv(`aes-${t.algorithm.length}-cbc`,t.data,new Uint8Array(e.iv)),n=i.update(r);return n=Buffer.concat([n,i.final()]),new Uint8Array(n).buffer}static async decryptAesCBC(e,t,r){let i=rW().createDecipheriv(`aes-${t.algorithm.length}-cbc`,t.data,new Uint8Array(e.iv)),n=i.update(r);return n=Buffer.concat([n,i.final()]),new Uint8Array(n).buffer}static async encryptAesCTR(e,t,r){let i=rW().createCipheriv(`aes-${t.algorithm.length}-ctr`,t.data,Buffer.from(e.counter)),n=i.update(r);return n=Buffer.concat([n,i.final()]),new Uint8Array(n).buffer}static async decryptAesCTR(e,t,r){let i=rW().createDecipheriv(`aes-${t.algorithm.length}-ctr`,t.data,new Uint8Array(e.counter)),n=i.update(r);return n=Buffer.concat([n,i.final()]),new Uint8Array(n).buffer}static async encryptAesGCM(e,t,r){let i=rW().createCipheriv(`aes-${t.algorithm.length}-gcm`,t.data,Buffer.from(e.iv),{authTagLength:(e.tagLength||128)>>3});e.additionalData&&i.setAAD(Buffer.from(e.additionalData));let n=i.update(r);return n=Buffer.concat([n,i.final(),i.getAuthTag()]),new Uint8Array(n).buffer}static async decryptAesGCM(e,t,r){let i=rW().createDecipheriv(`aes-${t.algorithm.length}-gcm`,t.data,new Uint8Array(e.iv)),n=(e.tagLength||128)>>3,s=r.slice(0,r.length-n),o=r.slice(r.length-n);e.additionalData&&i.setAAD(Buffer.from(e.additionalData)),i.setAuthTag(o);let a=i.update(s);return a=Buffer.concat([a,i.final()]),new Uint8Array(a).buffer}static async encryptAesKW(e,t,r){let i=rW().createCipheriv(`id-aes${t.algorithm.length}-wrap`,t.data,this.AES_KW_IV),n=i.update(r);return n=Buffer.concat([n,i.final()]),new Uint8Array(n).buffer}static async decryptAesKW(e,t,r){let i=rW().createDecipheriv(`id-aes${t.algorithm.length}-wrap`,t.data,this.AES_KW_IV),n=i.update(r);return n=Buffer.concat([n,i.final()]),new Uint8Array(n).buffer}static async encryptAesECB(e,t,r){let i=rW().createCipheriv(`aes-${t.algorithm.length}-ecb`,t.data,new Uint8Array(0)),n=i.update(r);return n=Buffer.concat([n,i.final()]),new Uint8Array(n).buffer}static async decryptAesECB(e,t,r){let i=rW().createDecipheriv(`aes-${t.algorithm.length}-ecb`,t.data,new Uint8Array(0)),n=i.update(r);return n=Buffer.concat([n,i.final()]),new Uint8Array(n).buffer}}r8.AES_KW_IV=Buffer.from("A6A6A6A6A6A6A6A6","hex");class r3 extends tH{async onGenerateKey(e,t,r){return r2(await r8.generateKey({name:this.name,length:e.length},t,r))}async onEncrypt(e,t,r){return r8.encrypt(e,r1(t),new Uint8Array(r))}async onDecrypt(e,t,r){return r8.decrypt(e,r1(t),new Uint8Array(r))}async onExportKey(e,t){return r8.exportKey(e,r1(t))}async onImportKey(e,t,r,i,n){return r2(await r8.importKey(e,t,{name:r.name},i,n))}checkCryptoKey(e,t){if(super.checkCryptoKey(e,t),!(r1(e) instanceof rZ))throw TypeError("key: Is not a AesCryptoKey")}}let r4=Buffer.from([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),r5=Buffer.from([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,135]);function r6(e){let t=Buffer.alloc(e.length),r=e.length-1;for(let i=0;i<r;i++)t[i]=e[i]<<1,128&e[i+1]&&(t[i]+=1);return t[r]=e[r]<<1,t}function r7(e,t){let r=Math.min(e.length,t.length),i=Buffer.alloc(r);for(let n=0;n<r;n++)i[n]=e[n]^t[n];return i}function r9(e,t){let r=rV.createCipheriv(`aes${e.length<<3}`,e,r4),i=r.update(t);return r.final(),i}function ie(e,t){let r=Buffer.alloc(16),i=16*t;return e.copy(r,0,i,i+16),r}class it extends tz{async onGenerateKey(e,t,r){return r2(await r8.generateKey({name:this.name,length:e.length},t,r))}async onSign(e,t,r){let i=function(e,t){let r,i;let n=function(e){let t=r9(e,r4),r=r6(t);128&t[0]&&(r=r7(r,r5));let i=r6(r);return 128&r[0]&&(i=r7(i,r5)),{subkey1:r,subkey2:i}}(e),s=Math.ceil(t.length/16);0===s?(s=1,r=!1):r=t.length%16==0;let o=s-1;i=r?r7(ie(t,o),n.subkey1):r7(function(e,t){let r=Buffer.alloc(16),i=16*t,n=e.length;return r.fill(0),e.copy(r,0,i,n),r[n-i]=128,r}(t,o),n.subkey2);let a=r4;for(let r=0;r<o;r++)a=r9(e,r7(a,ie(t,r)));return r9(e,r7(i,a))}(r1(t).data,Buffer.from(r));return new Uint8Array(i).buffer}async onVerify(e,t,r,i){let n=await this.sign(e,t,i);return 0===Buffer.from(r).compare(Buffer.from(n))}async onExportKey(e,t){return r8.exportKey(e,r1(t))}async onImportKey(e,t,r,i,n){return r2(await r8.importKey(e,t,{name:r.name},i,n))}checkCryptoKey(e,t){if(super.checkCryptoKey(e,t),!(r1(e) instanceof rZ))throw TypeError("key: Is not a AesCryptoKey")}}class ir extends tF{async onGenerateKey(e,t,r){return r2(await r8.generateKey({name:this.name,length:e.length},t,r))}async onEncrypt(e,t,r){return r8.encrypt(e,r1(t),new Uint8Array(r))}async onDecrypt(e,t,r){return r8.decrypt(e,r1(t),new Uint8Array(r))}async onExportKey(e,t){return r8.exportKey(e,r1(t))}async onImportKey(e,t,r,i,n){return r2(await r8.importKey(e,t,{name:r.name},i,n))}checkCryptoKey(e,t){if(super.checkCryptoKey(e,t),!(r1(e) instanceof rZ))throw TypeError("key: Is not a AesCryptoKey")}}class ii extends tW{async onGenerateKey(e,t,r){return r2(await r8.generateKey({name:this.name,length:e.length},t,r))}async onEncrypt(e,t,r){return r8.encrypt(e,r1(t),new Uint8Array(r))}async onDecrypt(e,t,r){return r8.decrypt(e,r1(t),new Uint8Array(r))}async onExportKey(e,t){return r8.exportKey(e,r1(t))}async onImportKey(e,t,r,i,n){return r2(await r8.importKey(e,t,{name:r.name},i,n))}checkCryptoKey(e,t){if(super.checkCryptoKey(e,t),!(r1(e) instanceof rZ))throw TypeError("key: Is not a AesCryptoKey")}}class is extends tJ{async onGenerateKey(e,t,r){return r2(await r8.generateKey({name:this.name,length:e.length},t,r))}async onExportKey(e,t){return r8.exportKey(e,r1(t))}async onImportKey(e,t,r,i,n){return r2(await r8.importKey(e,t,{name:r.name},i,n))}async onEncrypt(e,t,r){return r8.encrypt(e,r1(t),new Uint8Array(r))}async onDecrypt(e,t,r){return r8.decrypt(e,r1(t),new Uint8Array(r))}checkCryptoKey(e,t){if(super.checkCryptoKey(e,t),!(r1(e) instanceof rZ))throw TypeError("key: Is not a AesCryptoKey")}}class io extends tV{async onGenerateKey(e,t,r){return r2(await r8.generateKey({name:this.name,length:e.length},t,r))}async onEncrypt(e,t,r){return r8.encrypt(e,r1(t),new Uint8Array(r))}async onDecrypt(e,t,r){return r8.decrypt(e,r1(t),new Uint8Array(r))}async onExportKey(e,t){return r8.exportKey(e,r1(t))}async onImportKey(e,t,r,i,n){return r2(await r8.importKey(e,t,{name:r.name},i,n))}checkCryptoKey(e,t){if(super.checkCryptoKey(e,t),!(r1(e) instanceof rZ))throw TypeError("key: Is not a AesCryptoKey")}}class ia extends rX{get alg(){switch(this.algorithm.name.toUpperCase()){case"DES-CBC":return"DES-CBC";case"DES-EDE3-CBC":return"3DES-CBC";default:throw new tj("Unsupported algorithm name")}}set alg(e){}}(0,tm.gn)([tU({name:"k",converter:rG})],ia.prototype,"data",void 0);class il{static async generateKey(e,t,r){let i=new ia;return i.algorithm=e,i.extractable=t,i.usages=r,i.data=rW().randomBytes(e.length>>3),i}static async exportKey(e,t){switch(e.toLowerCase()){case"jwk":return tI.toJSON(t);case"raw":return new Uint8Array(t.data).buffer;default:throw new tD("format: Must be 'jwk' or 'raw'")}}static async importKey(e,t,r,i,n){let s;switch(e.toLowerCase()){case"jwk":s=tN.fromJSON(t,{targetSchema:ia});break;case"raw":(s=new ia).data=Buffer.from(t);break;default:throw new tD("format: Must be 'jwk' or 'raw'")}return s.algorithm=r,s.extractable=i,s.usages=n,s}static async encrypt(e,t,r){switch(e.name.toUpperCase()){case"DES-CBC":return this.encryptDesCBC(e,t,Buffer.from(r));case"DES-EDE3-CBC":return this.encryptDesEDE3CBC(e,t,Buffer.from(r));default:throw new tD("algorithm: Is not recognized")}}static async decrypt(e,t,r){if(!(t instanceof ia))throw Error("key: Is not DesCryptoKey");switch(e.name.toUpperCase()){case"DES-CBC":return this.decryptDesCBC(e,t,Buffer.from(r));case"DES-EDE3-CBC":return this.decryptDesEDE3CBC(e,t,Buffer.from(r));default:throw new tD("algorithm: Is not recognized")}}static async encryptDesCBC(e,t,r){let i=rW().createCipheriv("des-cbc",t.data,new Uint8Array(e.iv)),n=i.update(r);return n=Buffer.concat([n,i.final()]),new Uint8Array(n).buffer}static async decryptDesCBC(e,t,r){let i=rW().createDecipheriv("des-cbc",t.data,new Uint8Array(e.iv)),n=i.update(r);return n=Buffer.concat([n,i.final()]),new Uint8Array(n).buffer}static async encryptDesEDE3CBC(e,t,r){let i=rW().createCipheriv("des-ede3-cbc",t.data,Buffer.from(e.iv)),n=i.update(r);return n=Buffer.concat([n,i.final()]),new Uint8Array(n).buffer}static async decryptDesEDE3CBC(e,t,r){let i=rW().createDecipheriv("des-ede3-cbc",t.data,new Uint8Array(e.iv)),n=i.update(r);return n=Buffer.concat([n,i.final()]),new Uint8Array(n).buffer}}class iu extends tG{constructor(){super(...arguments),this.keySizeBits=64,this.ivSize=8,this.name="DES-CBC"}async onGenerateKey(e,t,r){return r2(await il.generateKey({name:this.name,length:this.keySizeBits},t,r))}async onEncrypt(e,t,r){return il.encrypt(e,r1(t),new Uint8Array(r))}async onDecrypt(e,t,r){return il.decrypt(e,r1(t),new Uint8Array(r))}async onExportKey(e,t){return il.exportKey(e,r1(t))}async onImportKey(e,t,r,i,n){let s=await il.importKey(e,t,{name:this.name,length:this.keySizeBits},i,n);if(s.data.length!==this.keySizeBits>>3)throw new tD("keyData: Wrong key size");return r2(s)}checkCryptoKey(e,t){if(super.checkCryptoKey(e,t),!(r1(e) instanceof ia))throw TypeError("key: Is not a DesCryptoKey")}}class ic extends tG{constructor(){super(...arguments),this.keySizeBits=192,this.ivSize=8,this.name="DES-EDE3-CBC"}async onGenerateKey(e,t,r){return r2(await il.generateKey({name:this.name,length:this.keySizeBits},t,r))}async onEncrypt(e,t,r){return il.encrypt(e,r1(t),new Uint8Array(r))}async onDecrypt(e,t,r){return il.decrypt(e,r1(t),new Uint8Array(r))}async onExportKey(e,t){return il.exportKey(e,r1(t))}async onImportKey(e,t,r,i,n){let s=await il.importKey(e,t,{name:this.name,length:this.keySizeBits},i,n);if(s.data.length!==this.keySizeBits>>3)throw new tD("keyData: Wrong key size");return r2(s)}checkCryptoKey(e,t){if(super.checkCryptoKey(e,t),!(r1(e) instanceof ia))throw TypeError("key: Is not a DesCryptoKey")}}function ih(e){switch(e.name.toUpperCase()){case"RSA-OAEP":{let t=/(\d+)$/.exec(e.hash.name)[1];return`RSA-OAEP${"1"!==t?`-${t}`:""}`}case"RSASSA-PKCS1-V1_5":return`RS${/(\d+)$/.exec(e.hash.name)[1]}`;case"RSA-PSS":return`PS${/(\d+)$/.exec(e.hash.name)[1]}`;case"RSA-PKCS1":return"RS1";default:throw new tD("algorithm: Is not recognized")}}class id extends rQ{constructor(){super(...arguments),this.type="private"}getKey(){let e=td.parse(this.data,rU.PrivateKeyInfo);return td.parse(e.privateKey,rU.RsaPrivateKey)}toJSON(){let e=this.getKey();return Object.assign({kty:"RSA",alg:ih(this.algorithm),key_ops:this.usages,ext:this.extractable},tI.toJSON(e))}fromJSON(e){let t=tN.fromJSON(e,{targetSchema:rU.RsaPrivateKey}),r=new rU.PrivateKeyInfo;r.privateKeyAlgorithm.algorithm="1.2.840.113549.1.1.1",r.privateKeyAlgorithm.parameters=null,r.privateKey=tf.serialize(t),this.data=Buffer.from(tf.serialize(r))}}class ip extends rQ{constructor(){super(...arguments),this.type="public"}getKey(){let e=td.parse(this.data,rU.PublicKeyInfo);return td.parse(e.publicKey,rU.RsaPublicKey)}toJSON(){let e=this.getKey();return Object.assign({kty:"RSA",alg:ih(this.algorithm),key_ops:this.usages,ext:this.extractable},tI.toJSON(e))}fromJSON(e){let t=tN.fromJSON(e,{targetSchema:rU.RsaPublicKey}),r=new rU.PublicKeyInfo;r.publicKeyAlgorithm.algorithm="1.2.840.113549.1.1.1",r.publicKeyAlgorithm.parameters=null,r.publicKey=tf.serialize(t),this.data=Buffer.from(tf.serialize(r))}}class im{static async generateKey(e,t,r){let i=new id;i.algorithm=e,i.extractable=t,i.usages=r.filter(e=>-1!==this.privateKeyUsages.indexOf(e));let n=new ip;n.algorithm=e,n.extractable=!0,n.usages=r.filter(e=>-1!==this.publicKeyUsages.indexOf(e));let s=Buffer.concat([Buffer.alloc(4-e.publicExponent.byteLength,0),Buffer.from(e.publicExponent)]).readInt32BE(0),o=rW().generateKeyPairSync("rsa",{modulusLength:e.modulusLength,publicExponent:s,publicKeyEncoding:{format:"der",type:"spki"},privateKeyEncoding:{format:"der",type:"pkcs8"}});return i.data=o.privateKey,n.data=o.publicKey,{privateKey:i,publicKey:n}}static async exportKey(e,t){switch(e.toLowerCase()){case"jwk":return tI.toJSON(t);case"pkcs8":case"spki":return new Uint8Array(t.data).buffer;default:throw new tD("format: Must be 'jwk', 'pkcs8' or 'spki'")}}static async importKey(e,t,r,i,n){switch(e.toLowerCase()){case"jwk":if(t.d){let e=tN.fromJSON(t,{targetSchema:rU.RsaPrivateKey});return this.importPrivateKey(e,r,i,n)}{let e=tN.fromJSON(t,{targetSchema:rU.RsaPublicKey});return this.importPublicKey(e,r,i,n)}case"spki":{let e=td.parse(new Uint8Array(t),rU.PublicKeyInfo),s=td.parse(e.publicKey,rU.RsaPublicKey);return this.importPublicKey(s,r,i,n)}case"pkcs8":{let e=td.parse(new Uint8Array(t),rU.PrivateKeyInfo),s=td.parse(e.privateKey,rU.RsaPrivateKey);return this.importPrivateKey(s,r,i,n)}default:throw new tD("format: Must be 'jwk', 'pkcs8' or 'spki'")}}static async sign(e,t,r){switch(e.name.toUpperCase()){case"RSA-PSS":case"RSASSA-PKCS1-V1_5":return this.signRsa(e,t,r);default:throw new tD("algorithm: Is not recognized")}}static async verify(e,t,r,i){switch(e.name.toUpperCase()){case"RSA-PSS":case"RSASSA-PKCS1-V1_5":return this.verifySSA(e,t,i,r);default:throw new tD("algorithm: Is not recognized")}}static async encrypt(e,t,r){if("RSA-OAEP"===e.name.toUpperCase())return this.encryptOAEP(e,t,r);throw new tD("algorithm: Is not recognized")}static async decrypt(e,t,r){if("RSA-OAEP"===e.name.toUpperCase())return this.decryptOAEP(e,t,r);throw new tD("algorithm: Is not recognized")}static importPrivateKey(e,t,r,i){let n=new rU.PrivateKeyInfo;n.privateKeyAlgorithm.algorithm="1.2.840.113549.1.1.1",n.privateKeyAlgorithm.parameters=null,n.privateKey=tf.serialize(e);let s=new id;return s.data=Buffer.from(tf.serialize(n)),s.algorithm=Object.assign({},t),s.algorithm.publicExponent=new Uint8Array(e.publicExponent),s.algorithm.modulusLength=e.modulus.byteLength<<3,s.extractable=r,s.usages=i,s}static importPublicKey(e,t,r,i){let n=new rU.PublicKeyInfo;n.publicKeyAlgorithm.algorithm="1.2.840.113549.1.1.1",n.publicKeyAlgorithm.parameters=null,n.publicKey=tf.serialize(e);let s=new ip;return s.data=Buffer.from(tf.serialize(n)),s.algorithm=Object.assign({},t),s.algorithm.publicExponent=new Uint8Array(e.publicExponent),s.algorithm.modulusLength=e.modulus.byteLength<<3,s.extractable=r,s.usages=i,s}static getCryptoAlgorithm(e){switch(e.hash.name.toUpperCase()){case"SHA-1":return"RSA-SHA1";case"SHA-256":return"RSA-SHA256";case"SHA-384":return"RSA-SHA384";case"SHA-512":return"RSA-SHA512";case"SHA3-256":return"RSA-SHA3-256";case"SHA3-384":return"RSA-SHA3-384";case"SHA3-512":return"RSA-SHA3-512";default:throw new tD("algorithm.hash: Is not recognized")}}static signRsa(e,t,r){let i=this.getCryptoAlgorithm(t.algorithm),n=rW().createSign(i);n.update(Buffer.from(r)),t.pem||(t.pem=`-----BEGIN PRIVATE KEY-----
${t.data.toString("base64")}
-----END PRIVATE KEY-----`);let s={key:t.pem};"RSA-PSS"===e.name.toUpperCase()&&(s.padding=rW().constants.RSA_PKCS1_PSS_PADDING,s.saltLength=e.saltLength);let o=n.sign(s);return new Uint8Array(o).buffer}static verifySSA(e,t,r,i){let n=this.getCryptoAlgorithm(t.algorithm),s=rW().createVerify(n);s.update(Buffer.from(r)),t.pem||(t.pem=`-----BEGIN PUBLIC KEY-----
${t.data.toString("base64")}
-----END PUBLIC KEY-----`);let o={key:t.pem};return"RSA-PSS"===e.name.toUpperCase()&&(o.padding=rW().constants.RSA_PKCS1_PSS_PADDING,o.saltLength=e.saltLength),s.verify(o,i)}static encryptOAEP(e,t,r){let i={key:`-----BEGIN PUBLIC KEY-----
${t.data.toString("base64")}
-----END PUBLIC KEY-----`,padding:rW().constants.RSA_PKCS1_OAEP_PADDING};return e.label,new Uint8Array(rW().publicEncrypt(i,r)).buffer}static decryptOAEP(e,t,r){let i={key:`-----BEGIN PRIVATE KEY-----
${t.data.toString("base64")}
-----END PRIVATE KEY-----`,padding:rW().constants.RSA_PKCS1_OAEP_PADDING};return e.label,new Uint8Array(rW().privateDecrypt(i,r)).buffer}}im.publicKeyUsages=["verify","encrypt","wrapKey"],im.privateKeyUsages=["sign","decrypt","unwrapKey"];class iy extends tX{constructor(){super(...arguments),this.hashAlgorithms=["SHA-1","SHA-256","SHA-384","SHA-512","shake128","shake256","SHA3-256","SHA3-384","SHA3-512"]}async onGenerateKey(e,t,r){let i=await im.generateKey({...e,name:this.name},t,r);return{privateKey:r2(i.privateKey),publicKey:r2(i.publicKey)}}async onSign(e,t,r){return im.sign(e,r1(t),new Uint8Array(r))}async onVerify(e,t,r,i){return im.verify(e,r1(t),new Uint8Array(r),new Uint8Array(i))}async onExportKey(e,t){return im.exportKey(e,r1(t))}async onImportKey(e,t,r,i,n){return r2(await im.importKey(e,t,{...r,name:this.name},i,n))}checkCryptoKey(e,t){super.checkCryptoKey(e,t);let r=r1(e);if(!(r instanceof id||r instanceof ip))throw TypeError("key: Is not RSA CryptoKey")}}class ig extends tQ{constructor(){super(...arguments),this.hashAlgorithms=["SHA-1","SHA-256","SHA-384","SHA-512","shake128","shake256","SHA3-256","SHA3-384","SHA3-512"]}async onGenerateKey(e,t,r){let i=await im.generateKey({...e,name:this.name},t,r);return{privateKey:r2(i.privateKey),publicKey:r2(i.publicKey)}}async onSign(e,t,r){return im.sign(e,r1(t),new Uint8Array(r))}async onVerify(e,t,r,i){return im.verify(e,r1(t),new Uint8Array(r),new Uint8Array(i))}async onExportKey(e,t){return im.exportKey(e,r1(t))}async onImportKey(e,t,r,i,n){return r2(await im.importKey(e,t,{...r,name:this.name},i,n))}checkCryptoKey(e,t){super.checkCryptoKey(e,t);let r=r1(e);if(!(r instanceof id||r instanceof ip))throw TypeError("key: Is not RSA CryptoKey")}}class ib{static size(e){switch(e.name.toUpperCase()){case"SHA-1":return 160;case"SHA-256":case"SHA3-256":return 256;case"SHA-384":case"SHA3-384":return 384;case"SHA-512":case"SHA3-512":return 512;default:throw Error("Unrecognized name")}}static getAlgorithmName(e){switch(e.name.toUpperCase()){case"SHA-1":return"sha1";case"SHA-256":return"sha256";case"SHA-384":return"sha384";case"SHA-512":return"sha512";case"SHA3-256":return"sha3-256";case"SHA3-384":return"sha3-384";case"SHA3-512":return"sha3-512";default:throw Error("Unrecognized name")}}static digest(e,t){let r=this.getAlgorithmName(e),i=rW().createHash(r).update(Buffer.from(t)).digest();return new Uint8Array(i).buffer}}class i_ extends tZ{async onGenerateKey(e,t,r){let i=await im.generateKey({...e,name:this.name},t,r);return{privateKey:r2(i.privateKey),publicKey:r2(i.publicKey)}}async onEncrypt(e,t,r){let i=r1(t),n=new Uint8Array(r),s=Math.ceil(i.algorithm.modulusLength>>3),o=ib.size(i.algorithm.hash)>>3,l=n.byteLength,u=s-l-2*o-2;if(l>s-2*o-2)throw Error("Data too large");let c=new Uint8Array(s),h=c.subarray(1,o+1),d=c.subarray(o+1);d.set(n,o+u+1);let f=rW().createHash(i.algorithm.hash.name.replace("-","")).update(a.toUint8Array(e.label||new Uint8Array(0))).digest();d.set(f,0),d[o+u]=1,rW().randomFillSync(h);let p=this.mgf1(i.algorithm.hash,h,d.length);for(let e=0;e<d.length;e++)d[e]^=p[e];let m=this.mgf1(i.algorithm.hash,d,h.length);for(let e=0;e<h.length;e++)h[e]^=m[e];i.pem||(i.pem=`-----BEGIN PUBLIC KEY-----
${i.data.toString("base64")}
-----END PUBLIC KEY-----`);let y=rW().publicEncrypt({key:i.pem,padding:rW().constants.RSA_NO_PADDING},Buffer.from(c));return new Uint8Array(y).buffer}async onDecrypt(e,t,r){let i=r1(t),n=Math.ceil(i.algorithm.modulusLength>>3),s=ib.size(i.algorithm.hash)>>3;if(r.byteLength!==n)throw Error("Bad data");i.pem||(i.pem=`-----BEGIN PRIVATE KEY-----
${i.data.toString("base64")}
-----END PRIVATE KEY-----`);let o=rW().privateDecrypt({key:i.pem,padding:rW().constants.RSA_NO_PADDING},Buffer.from(r)),l=o[0],u=o.subarray(1,s+1),c=o.subarray(s+1);if(0!==l)throw Error("Decryption failed");let h=this.mgf1(i.algorithm.hash,c,u.length);for(let e=0;e<u.length;e++)u[e]^=h[e];let d=this.mgf1(i.algorithm.hash,u,c.length);for(let e=0;e<c.length;e++)c[e]^=d[e];let f=rW().createHash(i.algorithm.hash.name.replace("-","")).update(a.toUint8Array(e.label||new Uint8Array(0))).digest();for(let e=0;e<s;e++)if(f[e]!==c[e])throw Error("Decryption failed");let p=s;for(;p<c.length;p++){let e=c[p];if(1===e)break;if(0!==e)throw Error("Decryption failed")}if(p===c.length)throw Error("Decryption failed");return o=c.subarray(p+1),new Uint8Array(o).buffer}async onExportKey(e,t){return im.exportKey(e,r1(t))}async onImportKey(e,t,r,i,n){return r2(await im.importKey(e,t,{...r,name:this.name},i,n))}checkCryptoKey(e,t){super.checkCryptoKey(e,t);let r=r1(e);if(!(r instanceof id||r instanceof ip))throw TypeError("key: Is not RSA CryptoKey")}mgf1(e,t,r=0){let i=ib.size(e)>>3,n=new Uint8Array(r),s=new Uint8Array(4),o=Math.ceil(r/i);for(let r=0;r<o;r++){s[0]=r>>>24,s[1]=r>>>16&255,s[2]=r>>>8&255,s[3]=255&r;let o=n.subarray(r*i),a=rW().createHash(e.name.replace("-","")).update(t).update(s).digest();a.length>o.length&&(a=a.subarray(0,o.length)),o.set(a)}return n}}class iv extends t${constructor(){super(...arguments),this.name="RSAES-PKCS1-v1_5",this.usages={publicKey:["encrypt","wrapKey"],privateKey:["decrypt","unwrapKey"]}}async onGenerateKey(e,t,r){let i=await im.generateKey({...e,name:this.name},t,r);return{privateKey:r2(i.privateKey),publicKey:r2(i.publicKey)}}checkGenerateKeyParams(e){if(this.checkRequiredProperty(e,"publicExponent"),!(e.publicExponent&&e.publicExponent instanceof Uint8Array))throw TypeError("publicExponent: Missing or not a Uint8Array");let t=p.ToBase64(e.publicExponent);if(!("Aw=="===t||"AQAB"===t))throw TypeError("publicExponent: Must be [3] or [1,0,1]");switch(this.checkRequiredProperty(e,"modulusLength"),e.modulusLength){case 1024:case 2048:case 4096:break;default:throw TypeError("modulusLength: Must be 1024, 2048, or 4096")}}async onEncrypt(e,t,r){let i=this.toCryptoOptions(t),n=rV.publicEncrypt(i,new Uint8Array(r));return new Uint8Array(n).buffer}async onDecrypt(e,t,r){let i=this.toCryptoOptions(t),n=rV.privateDecrypt(i,new Uint8Array(r));return new Uint8Array(n).buffer}async onExportKey(e,t){return im.exportKey(e,r1(t))}async onImportKey(e,t,r,i,n){return r2(await im.importKey(e,t,{...r,name:this.name},i,n))}checkCryptoKey(e,t){super.checkCryptoKey(e,t);let r=r1(e);if(!(r instanceof id||r instanceof ip))throw TypeError("key: Is not RSA CryptoKey")}toCryptoOptions(e){let t=e.type.toUpperCase();return{key:`-----BEGIN ${t} KEY-----
${r1(e).data.toString("base64")}
-----END ${t} KEY-----`,padding:rV.constants.RSA_PKCS1_PADDING}}}let iw={"1.2.840.10045.3.1.7":"P-256","P-256":"1.2.840.10045.3.1.7","1.3.132.0.34":"P-384","P-384":"1.3.132.0.34","1.3.132.0.35":"P-521","P-521":"1.3.132.0.35","1.3.132.0.10":"K-256","K-256":"1.3.132.0.10",brainpoolP160r1:"1.3.36.3.3.2.8.1.1.1","1.3.36.3.3.2.8.1.1.1":"brainpoolP160r1",brainpoolP160t1:"1.3.36.3.3.2.8.1.1.2","1.3.36.3.3.2.8.1.1.2":"brainpoolP160t1",brainpoolP192r1:"1.3.36.3.3.2.8.1.1.3","1.3.36.3.3.2.8.1.1.3":"brainpoolP192r1",brainpoolP192t1:"1.3.36.3.3.2.8.1.1.4","1.3.36.3.3.2.8.1.1.4":"brainpoolP192t1",brainpoolP224r1:"1.3.36.3.3.2.8.1.1.5","1.3.36.3.3.2.8.1.1.5":"brainpoolP224r1",brainpoolP224t1:"1.3.36.3.3.2.8.1.1.6","1.3.36.3.3.2.8.1.1.6":"brainpoolP224t1",brainpoolP256r1:"1.3.36.3.3.2.8.1.1.7","1.3.36.3.3.2.8.1.1.7":"brainpoolP256r1",brainpoolP256t1:"1.3.36.3.3.2.8.1.1.8","1.3.36.3.3.2.8.1.1.8":"brainpoolP256t1",brainpoolP320r1:"1.3.36.3.3.2.8.1.1.9","1.3.36.3.3.2.8.1.1.9":"brainpoolP320r1",brainpoolP320t1:"1.3.36.3.3.2.8.1.1.10","1.3.36.3.3.2.8.1.1.10":"brainpoolP320t1",brainpoolP384r1:"1.3.36.3.3.2.8.1.1.11","1.3.36.3.3.2.8.1.1.11":"brainpoolP384r1",brainpoolP384t1:"1.3.36.3.3.2.8.1.1.12","1.3.36.3.3.2.8.1.1.12":"brainpoolP384t1",brainpoolP512r1:"1.3.36.3.3.2.8.1.1.13","1.3.36.3.3.2.8.1.1.13":"brainpoolP512r1",brainpoolP512t1:"1.3.36.3.3.2.8.1.1.14","1.3.36.3.3.2.8.1.1.14":"brainpoolP512t1"};function iS(e){let t=iw[e];if(!t)throw new tD(`Cannot convert WebCrypto named curve '${e}' to OID`);return t}class iA extends rQ{constructor(){super(...arguments),this.type="private"}getKey(){let e=td.parse(this.data,rU.PrivateKeyInfo);return td.parse(e.privateKey,rU.EcPrivateKey)}toJSON(){let e=this.getKey();return Object.assign({kty:"EC",crv:this.algorithm.namedCurve,key_ops:this.usages,ext:this.extractable},tI.toJSON(e))}fromJSON(e){if(!e.crv)throw new tD("Cannot get named curve from JWK. Property 'crv' is required");let t=new rU.PrivateKeyInfo;t.privateKeyAlgorithm.algorithm="1.2.840.10045.2.1",t.privateKeyAlgorithm.parameters=tf.serialize(new rU.ObjectIdentifier(iS(e.crv)));let r=tN.fromJSON(e,{targetSchema:rU.EcPrivateKey});return t.privateKey=tf.serialize(r),this.data=Buffer.from(tf.serialize(t)),this}}class ik extends rQ{constructor(){super(...arguments),this.type="public"}getKey(){let e=td.parse(this.data,rU.PublicKeyInfo);return new rU.EcPublicKey(e.publicKey)}toJSON(){let e=this.getKey();return Object.assign({kty:"EC",crv:this.algorithm.namedCurve,key_ops:this.usages,ext:this.extractable},tI.toJSON(e))}fromJSON(e){if(!e.crv)throw new tD("Cannot get named curve from JWK. Property 'crv' is required");let t=tN.fromJSON(e,{targetSchema:rU.EcPublicKey}),r=new rU.PublicKeyInfo;return r.publicKeyAlgorithm.algorithm="1.2.840.10045.2.1",r.publicKeyAlgorithm.parameters=tf.serialize(new rU.ObjectIdentifier(iS(e.crv))),r.publicKey=tf.toASN(t).valueHex,this.data=Buffer.from(tf.serialize(r)),this}}class iE extends t${constructor(){super(...arguments),this.name="SHA-1",this.usages=[]}async onDigest(e,t){return ib.digest(e,t)}}class ix extends t${constructor(){super(...arguments),this.name="SHA-256",this.usages=[]}async onDigest(e,t){return ib.digest(e,t)}}class iC extends t${constructor(){super(...arguments),this.name="SHA-384",this.usages=[]}async onDigest(e,t){return ib.digest(e,t)}}class iP extends t${constructor(){super(...arguments),this.name="SHA-512",this.usages=[]}async onDigest(e,t){return ib.digest(e,t)}}class iT extends t${constructor(){super(...arguments),this.name="SHA3-256",this.usages=[]}async onDigest(e,t){return ib.digest(e,t)}}class iO extends t${constructor(){super(...arguments),this.name="SHA3-384",this.usages=[]}async onDigest(e,t){return ib.digest(e,t)}}class iB extends t${constructor(){super(...arguments),this.name="SHA3-512",this.usages=[]}async onDigest(e,t){return ib.digest(e,t)}}class iR{static async generateKey(e,t,r){let i=new iA;i.algorithm=e,i.extractable=t,i.usages=r.filter(e=>-1!==this.privateKeyUsages.indexOf(e));let n=new ik;n.algorithm=e,n.extractable=!0,n.usages=r.filter(e=>-1!==this.publicKeyUsages.indexOf(e));let s=rW().generateKeyPairSync("ec",{namedCurve:this.getOpenSSLNamedCurve(e.namedCurve),publicKeyEncoding:{format:"der",type:"spki"},privateKeyEncoding:{format:"der",type:"pkcs8"}});return i.data=s.privateKey,n.data=s.publicKey,{privateKey:i,publicKey:n}}static async sign(e,t,r){let i=ib.getAlgorithmName(e.hash),n=rW().createSign(i);n.update(Buffer.from(r)),t.pem||(t.pem=`-----BEGIN PRIVATE KEY-----
${t.data.toString("base64")}
-----END PRIVATE KEY-----`);let s={key:t.pem},o=n.sign(s),a=td.parse(o,rU.EcDsaSignature);return ru.encodeSignature(a,rL.get(t.algorithm.namedCurve).size).buffer}static async verify(e,t,r,i){let n=ib.getAlgorithmName(e.hash),s=rW().createVerify(n);s.update(Buffer.from(i)),t.pem||(t.pem=`-----BEGIN PUBLIC KEY-----
${t.data.toString("base64")}
-----END PUBLIC KEY-----`);let o={key:t.pem},l=new rU.EcDsaSignature,u=rL.get(t.algorithm.namedCurve),c=ru.decodeSignature(r,u.size);l.r=a.toArrayBuffer(c.r),l.s=a.toArrayBuffer(c.s);let h=Buffer.from(tf.serialize(l));return s.verify(o,h)}static async deriveBits(e,t,r){let i=this.getOpenSSLNamedCurve(t.algorithm.namedCurve),n=rW().createECDH(i),s=td.parse(t.data,rU.PrivateKeyInfo),o=td.parse(s.privateKey,rU.EcPrivateKey);n.setPrivateKey(Buffer.from(o.privateKey));let a=td.parse(e.public.data,rU.PublicKeyInfo),l=n.computeSecret(Buffer.from(a.publicKey));return null===r?l:new Uint8Array(l).buffer.slice(0,r>>3)}static async exportKey(e,t){switch(e.toLowerCase()){case"jwk":return tI.toJSON(t);case"pkcs8":case"spki":return new Uint8Array(t.data).buffer;case"raw":return td.parse(t.data,rU.PublicKeyInfo).publicKey;default:throw new tD("format: Must be 'jwk', 'raw', pkcs8' or 'spki'")}}static async importKey(e,t,r,i,n){switch(e.toLowerCase()){case"jwk":if(t.d){let e=tN.fromJSON(t,{targetSchema:rU.EcPrivateKey});return this.importPrivateKey(e,r,i,n)}{let e=tN.fromJSON(t,{targetSchema:rU.EcPublicKey});return this.importPublicKey(e,r,i,n)}case"raw":{let e=new rU.EcPublicKey(t);return this.importPublicKey(e,r,i,n)}case"spki":{let e=td.parse(new Uint8Array(t),rU.PublicKeyInfo),s=new rU.EcPublicKey(e.publicKey);return this.assertKeyParameters(e.publicKeyAlgorithm.parameters,r.namedCurve),this.importPublicKey(s,r,i,n)}case"pkcs8":{let e=td.parse(new Uint8Array(t),rU.PrivateKeyInfo),s=td.parse(e.privateKey,rU.EcPrivateKey);return this.assertKeyParameters(e.privateKeyAlgorithm.parameters,r.namedCurve),this.importPrivateKey(s,r,i,n)}default:throw new tD("format: Must be 'jwk', 'raw', 'pkcs8' or 'spki'")}}static assertKeyParameters(e,t){if(!e)throw new tL("Key info doesn't have required parameters");let r="";try{r=td.parse(e,rU.ObjectIdentifier).value}catch(e){throw new tL("Cannot read key info parameters")}if(iS(t)!==r)throw new tL("Key info parameter doesn't match to named curve")}static async importPrivateKey(e,t,r,i){let n=new rU.PrivateKeyInfo;n.privateKeyAlgorithm.algorithm="1.2.840.10045.2.1",n.privateKeyAlgorithm.parameters=tf.serialize(new rU.ObjectIdentifier(iS(t.namedCurve))),n.privateKey=tf.serialize(e);let s=new iA;return s.data=Buffer.from(tf.serialize(n)),s.algorithm=Object.assign({},t),s.extractable=r,s.usages=i,s}static async importPublicKey(e,t,r,i){let n=new rU.PublicKeyInfo;n.publicKeyAlgorithm.algorithm="1.2.840.10045.2.1";let s=iS(t.namedCurve);n.publicKeyAlgorithm.parameters=tf.serialize(new rU.ObjectIdentifier(s)),n.publicKey=e.value;let o=new ik;return o.data=Buffer.from(tf.serialize(n)),o.algorithm=Object.assign({},t),o.extractable=r,o.usages=i,o}static getOpenSSLNamedCurve(e){switch(e.toUpperCase()){case"P-256":return"prime256v1";case"K-256":return"secp256k1";case"P-384":return"secp384r1";case"P-521":return"secp521r1";default:return e}}}iR.publicKeyUsages=["verify"],iR.privateKeyUsages=["sign","deriveKey","deriveBits"];class iI extends t1{constructor(){super(...arguments),this.namedCurves=rL.names,this.hashAlgorithms=["SHA-1","SHA-256","SHA-384","SHA-512","shake128","shake256","SHA3-256","SHA3-384","SHA3-512"]}async onGenerateKey(e,t,r){let i=await iR.generateKey({...e,name:this.name},t,r);return{privateKey:r2(i.privateKey),publicKey:r2(i.publicKey)}}async onSign(e,t,r){return iR.sign(e,r1(t),new Uint8Array(r))}async onVerify(e,t,r,i){return iR.verify(e,r1(t),new Uint8Array(r),new Uint8Array(i))}async onExportKey(e,t){return iR.exportKey(e,r1(t))}async onImportKey(e,t,r,i,n){return r2(await iR.importKey(e,t,{...r,name:this.name},i,n))}checkCryptoKey(e,t){super.checkCryptoKey(e,t);let r=r1(e);if(!(r instanceof iA||r instanceof ik))throw TypeError("key: Is not EC CryptoKey")}}class iN extends t3{constructor(){super(...arguments),this.namedCurves=rL.names}async onGenerateKey(e,t,r){let i=await iR.generateKey({...e,name:this.name},t,r);return{privateKey:r2(i.privateKey),publicKey:r2(i.publicKey)}}async onExportKey(e,t){return iR.exportKey(e,r1(t))}async onImportKey(e,t,r,i,n){return r2(await iR.importKey(e,t,{...r,name:this.name},i,n))}checkCryptoKey(e,t){super.checkCryptoKey(e,t);let r=r1(e);if(!(r instanceof iA||r instanceof ik))throw TypeError("key: Is not EC CryptoKey")}async onDeriveBits(e,t,r){return await iR.deriveBits({...e,public:r1(e.public)},r1(t),r)}}let iU={[rU.idEd448]:"Ed448",ed448:rU.idEd448,[rU.idX448]:"X448",x448:rU.idX448,[rU.idEd25519]:"Ed25519",ed25519:rU.idEd25519,[rU.idX25519]:"X25519",x25519:rU.idX25519};function iL(e){let t=iU[e.toLowerCase()];if(!t)throw new tD(`Cannot convert WebCrypto named curve '${e}' to OID`);return t}class ij extends rQ{constructor(){super(...arguments),this.type="private"}getKey(){let e=td.parse(this.data,rU.PrivateKeyInfo);return td.parse(e.privateKey,rU.CurvePrivateKey)}toJSON(){let e=this.getKey();return Object.assign({kty:"OKP",crv:this.algorithm.namedCurve,key_ops:this.usages,ext:this.extractable},tI.toJSON(e))}fromJSON(e){if(!e.crv)throw new tD("Cannot get named curve from JWK. Property 'crv' is required");let t=new rU.PrivateKeyInfo;t.privateKeyAlgorithm.algorithm=iL(e.crv);let r=tN.fromJSON(e,{targetSchema:rU.CurvePrivateKey});return t.privateKey=tf.serialize(r),this.data=Buffer.from(tf.serialize(t)),this}}class iK extends rQ{constructor(){super(...arguments),this.type="public"}getKey(){return td.parse(this.data,rU.PublicKeyInfo).publicKey}toJSON(){let e=this.getKey();return Object.assign({kty:"OKP",crv:this.algorithm.namedCurve,key_ops:this.usages,ext:this.extractable},{x:p.ToBase64Url(e)})}fromJSON(e){if(!e.crv)throw new tD("Cannot get named curve from JWK. Property 'crv' is required");if(!e.x)throw new tD("Cannot get property from JWK. Property 'x' is required");let t=new rU.PublicKeyInfo;return t.publicKeyAlgorithm.algorithm=iL(e.crv),t.publicKey=p.FromBase64Url(e.x),this.data=Buffer.from(tf.serialize(t)),this}}class iD{static async generateKey(e,t,r){let i=new ij;i.algorithm=e,i.extractable=t,i.usages=r.filter(e=>-1!==this.privateKeyUsages.indexOf(e));let n=new iK;n.algorithm=e,n.extractable=!0,n.usages=r.filter(e=>-1!==this.publicKeyUsages.indexOf(e));let s=e.namedCurve.toLowerCase(),o=rW().generateKeyPairSync(s,{publicKeyEncoding:{format:"der",type:"spki"},privateKeyEncoding:{format:"der",type:"pkcs8"}});return i.data=o.privateKey,n.data=o.publicKey,{privateKey:i,publicKey:n}}static async sign(e,t,r){t.pem||(t.pem=`-----BEGIN PRIVATE KEY-----
${t.data.toString("base64")}
-----END PRIVATE KEY-----`);let i={key:t.pem},n=rW().sign(null,Buffer.from(r),i);return a.toArrayBuffer(n)}static async verify(e,t,r,i){t.pem||(t.pem=`-----BEGIN PUBLIC KEY-----
${t.data.toString("base64")}
-----END PUBLIC KEY-----`);let n={key:t.pem};return rW().verify(null,Buffer.from(i),n,Buffer.from(r))}static async deriveBits(e,t,r){let i=rW().createPublicKey({key:e.public.data,format:"der",type:"spki"}),n=rW().createPrivateKey({key:t.data,format:"der",type:"pkcs8"}),s=rW().diffieHellman({publicKey:i,privateKey:n});return new Uint8Array(s).buffer.slice(0,r>>3)}static async exportKey(e,t){switch(e.toLowerCase()){case"jwk":return tI.toJSON(t);case"pkcs8":case"spki":return new Uint8Array(t.data).buffer;case"raw":return td.parse(t.data,rU.PublicKeyInfo).publicKey;default:throw new tD("format: Must be 'jwk', 'raw', pkcs8' or 'spki'")}}static async importKey(e,t,r,i,n){switch(e.toLowerCase()){case"jwk":if(t.d){let e=tN.fromJSON(t,{targetSchema:rU.CurvePrivateKey});return this.importPrivateKey(e,r,i,n)}if(!t.x)throw TypeError("keyData: Cannot get required 'x' filed");return this.importPublicKey(p.FromBase64Url(t.x),r,i,n);case"raw":return this.importPublicKey(t,r,i,n);case"spki":{let e=td.parse(new Uint8Array(t),rU.PublicKeyInfo);return this.importPublicKey(e.publicKey,r,i,n)}case"pkcs8":{let e=td.parse(new Uint8Array(t),rU.PrivateKeyInfo),s=td.parse(e.privateKey,rU.CurvePrivateKey);return this.importPrivateKey(s,r,i,n)}default:throw new tD("format: Must be 'jwk', 'raw', 'pkcs8' or 'spki'")}}static importPrivateKey(e,t,r,i){let n=new ij;return n.fromJSON({crv:t.namedCurve,d:p.ToBase64Url(e.d)}),n.algorithm=Object.assign({},t),n.extractable=r,n.usages=i,n}static async importPublicKey(e,t,r,i){let n=new iK;return n.fromJSON({crv:t.namedCurve,x:p.ToBase64Url(e)}),n.algorithm=Object.assign({},t),n.extractable=r,n.usages=i,n}}iD.publicKeyUsages=["verify"],iD.privateKeyUsages=["sign","deriveKey","deriveBits"];class iM extends t5{async onGenerateKey(e,t,r){let i=await iD.generateKey({name:this.name,namedCurve:e.namedCurve.replace(/^ed/i,"Ed")},t,r);return{privateKey:r2(i.privateKey),publicKey:r2(i.publicKey)}}async onSign(e,t,r){return iD.sign(e,r1(t),new Uint8Array(r))}async onVerify(e,t,r,i){return iD.verify(e,r1(t),new Uint8Array(r),new Uint8Array(i))}async onExportKey(e,t){return iD.exportKey(e,r1(t))}async onImportKey(e,t,r,i,n){return r2(await iD.importKey(e,t,{...r,name:this.name},i,n))}}class i$ extends t4{async onGenerateKey(e,t,r){let i=await iD.generateKey({name:this.name,namedCurve:e.namedCurve.toUpperCase()},t,r);return{privateKey:r2(i.privateKey),publicKey:r2(i.publicKey)}}async onDeriveBits(e,t,r){return await iD.deriveBits({...e,public:r1(e.public)},r1(t),r)}async onExportKey(e,t){return iD.exportKey(e,r1(t))}async onImportKey(e,t,r,i,n){return r2(await iD.importKey(e,t,{...r,name:this.name},i,n))}}class iq extends rY{}class iH extends rK{async onDeriveBits(e,t,r){return new Promise((i,n)=>{let s=a.toArrayBuffer(e.salt),o=e.hash.name.replace("-","");rW().pbkdf2(r1(t).data,Buffer.from(s),e.iterations,r>>3,o,(e,t)=>{e?n(e):i(new Uint8Array(t).buffer)})})}async onImportKey(e,t,r,i,n){if("raw"===e){let e=new iq;return e.data=Buffer.from(t),e.algorithm={name:this.name},e.extractable=!1,e.usages=n,r2(e)}throw new tD("format: Must be 'raw'")}checkCryptoKey(e,t){if(super.checkCryptoKey(e,t),!(r1(e) instanceof iq))throw TypeError("key: Is not PBKDF CryptoKey")}}class iz extends rY{get alg(){let e=this.algorithm.hash.name.toUpperCase();return`HS${e.replace("SHA-","")}`}set alg(e){}}(0,tm.gn)([tU({name:"k",converter:rG})],iz.prototype,"data",void 0);class iF extends rj{async onGenerateKey(e,t,r){let i=(e.length||this.getDefaultLength(e.hash.name))>>3<<3,n=new iz;return n.algorithm={...e,length:i,name:this.name},n.extractable=t,n.usages=r,n.data=rW().randomBytes(i>>3),r2(n)}async onSign(e,t,r){let i=ib.getAlgorithmName(t.algorithm.hash),n=rW().createHmac(i,r1(t).data).update(Buffer.from(r)).digest();return new Uint8Array(n).buffer}async onVerify(e,t,r,i){let n=ib.getAlgorithmName(t.algorithm.hash);return 0===rW().createHmac(n,r1(t).data).update(Buffer.from(i)).digest().compare(Buffer.from(r))}async onImportKey(e,t,r,i,n){let s;switch(e.toLowerCase()){case"jwk":s=tN.fromJSON(t,{targetSchema:iz});break;case"raw":(s=new iz).data=Buffer.from(t);break;default:throw new tD("format: Must be 'jwk' or 'raw'")}return s.algorithm={hash:{name:r.hash.name},name:this.name,length:s.data.length<<3},s.extractable=i,s.usages=n,r2(s)}async onExportKey(e,t){switch(e.toLowerCase()){case"jwk":return tI.toJSON(r1(t));case"raw":return new Uint8Array(r1(t).data).buffer;default:throw new tD("format: Must be 'jwk' or 'raw'")}}checkCryptoKey(e,t){if(super.checkCryptoKey(e,t),!(r1(e) instanceof iz))throw TypeError("key: Is not HMAC CryptoKey")}}class iV extends rY{}class iW extends rD{async onImportKey(e,t,r,i,n){if("raw"!==e.toLowerCase())throw new tD("Operation not supported");let s=new iV;return s.data=Buffer.from(t),s.algorithm={name:this.name},s.extractable=i,s.usages=n,r2(s)}async onDeriveBits(e,t,r){let i=e.hash.name.replace("-",""),n=rW().createHash(i).digest().length,s=r/8,o=a.toUint8Array(e.info),l=rW().createHmac(i,a.toUint8Array(e.salt)).update(a.toUint8Array(r1(t).data)).digest(),u=[Buffer.alloc(0)],c=Math.ceil(s/n)+1;for(let e=1;e<c;++e)u.push(rW().createHmac(i,l).update(Buffer.concat([u[e-1],o,Buffer.from([e])])).digest());return Buffer.concat(u).slice(0,s)}checkCryptoKey(e,t){if(super.checkCryptoKey(e,t),!(r1(e) instanceof iV))throw TypeError("key: Is not HKDF CryptoKey")}}class iJ{static digest(e,t){let r=rW().createHash(e.name.toLowerCase(),{outputLength:e.length}).update(Buffer.from(t)).digest();return new Uint8Array(r).buffer}}class iG extends r${async onDigest(e,t){return iJ.digest(e,t)}}class iY extends rq{async onDigest(e,t){return iJ.digest(e,t)}}class iX extends rF{constructor(){var e;super(),this.providers.set(new r3),this.providers.set(new ir),this.providers.set(new ii),this.providers.set(new it),this.providers.set(new is),this.providers.set(new io),this.providers.set(new iu),this.providers.set(new ic),this.providers.set(new iy),this.providers.set(new ig),this.providers.set(new i_),this.providers.set(new iv),this.providers.set(new iI),this.providers.set(new iN),this.providers.set(new iE),this.providers.set(new ix),this.providers.set(new iC),this.providers.set(new iP),this.providers.set(new iH),this.providers.set(new iF),this.providers.set(new iW);let t=null===(e=/^v(\d+)/.exec(rJ.version))||void 0===e?void 0:e[1];t&&parseInt(t,10)>=12&&(this.providers.set(new iG),this.providers.set(new iY));let r=rV.getHashes();r.includes("sha3-256")&&this.providers.set(new iT),r.includes("sha3-384")&&this.providers.set(new iO),r.includes("sha3-512")&&this.providers.set(new iB),t&&parseInt(t,10)>=14&&(this.providers.set(new iM),this.providers.set(new i$))}}class iQ extends rH{constructor(){super(...arguments),this.subtle=new iX}getRandomValues(e){if(!ArrayBuffer.isView(e))throw TypeError("Failed to execute 'getRandomValues' on 'Crypto': parameter 1 is not of type 'ArrayBufferView'");let t=Buffer.from(e.buffer,e.byteOffset,e.byteLength);return rW().randomFillSync(t),e}}},32979:(e,t)=>{var r=function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),i=function(){function e(e){void 0===e&&(e="="),this._paddingCharacter=e}return e.prototype.encodedLength=function(e){return this._paddingCharacter?(e+2)/3*4|0:(8*e+5)/6|0},e.prototype.encode=function(e){for(var t="",r=0;r<e.length-2;r+=3){var i=e[r]<<16|e[r+1]<<8|e[r+2];t+=this._encodeByte(i>>>18&63)+this._encodeByte(i>>>12&63)+this._encodeByte(i>>>6&63)+this._encodeByte(i>>>0&63)}var n=e.length-r;if(n>0){var i=e[r]<<16|(2===n?e[r+1]<<8:0);t+=this._encodeByte(i>>>18&63)+this._encodeByte(i>>>12&63),2===n?t+=this._encodeByte(i>>>6&63):t+=this._paddingCharacter||"",t+=this._paddingCharacter||""}return t},e.prototype.maxDecodedLength=function(e){return this._paddingCharacter?e/4*3|0:(6*e+7)/8|0},e.prototype.decodedLength=function(e){return this.maxDecodedLength(e.length-this._getPaddingLength(e))},e.prototype.decode=function(e){if(0===e.length)return new Uint8Array(0);for(var t=this._getPaddingLength(e),r=e.length-t,i=new Uint8Array(this.maxDecodedLength(r)),n=0,s=0,o=0,a=0,l=0,u=0,c=0;s<r-4;s+=4)a=this._decodeChar(e.charCodeAt(s+0)),l=this._decodeChar(e.charCodeAt(s+1)),u=this._decodeChar(e.charCodeAt(s+2)),c=this._decodeChar(e.charCodeAt(s+3)),i[n++]=a<<2|l>>>4,i[n++]=l<<4|u>>>2,i[n++]=u<<6|c,o|=256&a,o|=256&l,o|=256&u,o|=256&c;if(s<r-1&&(a=this._decodeChar(e.charCodeAt(s)),l=this._decodeChar(e.charCodeAt(s+1)),i[n++]=a<<2|l>>>4,o|=256&a,o|=256&l),s<r-2&&(u=this._decodeChar(e.charCodeAt(s+2)),i[n++]=l<<4|u>>>2,o|=256&u),s<r-3&&(c=this._decodeChar(e.charCodeAt(s+3)),i[n++]=u<<6|c,o|=256&c),0!==o)throw Error("Base64Coder: incorrect characters for decoding");return i},e.prototype._encodeByte=function(e){var t=e;return String.fromCharCode(t+=65+(25-e>>>8&6)+(51-e>>>8&-75)+(61-e>>>8&-15)+(62-e>>>8&3))},e.prototype._decodeChar=function(e){return 256+((42-e&e-44)>>>8&-256+e-43+62)+((46-e&e-48)>>>8&-256+e-47+63)+((47-e&e-58)>>>8&-256+e-48+52)+((64-e&e-91)>>>8&-256+e-65+0)+((96-e&e-123)>>>8&-256+e-97+26)},e.prototype._getPaddingLength=function(e){var t=0;if(this._paddingCharacter){for(var r=e.length-1;r>=0&&e[r]===this._paddingCharacter;r--)t++;if(e.length<4||t>2)throw Error("Base64Coder: incorrect padding")}return t},e}(),n=new i;t.cv=function(e){return n.encode(e)},new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype._encodeByte=function(e){var t=e;return String.fromCharCode(t+=65+(25-e>>>8&6)+(51-e>>>8&-75)+(61-e>>>8&-13)+(62-e>>>8&49))},t.prototype._decodeChar=function(e){return 256+((44-e&e-46)>>>8&-256+e-45+62)+((94-e&e-96)>>>8&-256+e-95+63)+((47-e&e-58)>>>8&-256+e-48+52)+((64-e&e-91)>>>8&-256+e-65+0)+((96-e&e-123)>>>8&-256+e-97+26)},t}(i))},83191:(e,t)=>{function r(e){return -1!==e.indexOf("%")?decodeURIComponent(e):e}/*!
 * cookie
 * Copyright(c) 2012-2014 Roman Shtylman
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */t.Q=function(e,t){if("string"!=typeof e)throw TypeError("argument str must be a string");for(var i={},n=(t||{}).decode||r,s=0;s<e.length;){var o=e.indexOf("=",s);if(-1===o)break;var a=e.indexOf(";",s);if(-1===a)a=e.length;else if(a<o){s=e.lastIndexOf(";",o-1)+1;continue}var l=e.slice(s,o).trim();if(void 0===i[l]){var u=e.slice(o+1,a).trim();34===u.charCodeAt(0)&&(u=u.slice(1,-1)),i[l]=function(e,t){try{return t(e)}catch(t){return e}}(u,n)}s=a+1}return i},Object.prototype.toString},14438:e=>{var t=function(e){var t;return!!e&&"object"==typeof e&&"[object RegExp]"!==(t=Object.prototype.toString.call(e))&&"[object Date]"!==t&&e.$$typeof!==r},r="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function i(e,t){return!1!==t.clone&&t.isMergeableObject(e)?a(Array.isArray(e)?[]:{},e,t):e}function n(e,t,r){return e.concat(t).map(function(e){return i(e,r)})}function s(e){return Object.keys(e).concat(Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter(function(t){return e.propertyIsEnumerable(t)}):[])}function o(e,t){try{return t in e}catch(e){return!1}}function a(e,r,l){(l=l||{}).arrayMerge=l.arrayMerge||n,l.isMergeableObject=l.isMergeableObject||t,l.cloneUnlessOtherwiseSpecified=i;var u,c,h=Array.isArray(r);return h!==Array.isArray(e)?i(r,l):h?l.arrayMerge(e,r,l):(c={},(u=l).isMergeableObject(e)&&s(e).forEach(function(t){c[t]=i(e[t],u)}),s(r).forEach(function(t){(!o(e,t)||Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))&&(o(e,t)&&u.isMergeableObject(r[t])?c[t]=(function(e,t){if(!t.customMerge)return a;var r=t.customMerge(e);return"function"==typeof r?r:a})(t,u)(e[t],r[t],u):c[t]=i(r[t],u))}),c)}a.all=function(e,t){if(!Array.isArray(e))throw Error("first argument should be an array");return e.reduce(function(e,r){return a(e,r,t)},{})},e.exports=a},40799:(e,t,r)=>{var i;!function(t,n){var s={};n(s);var o=s.default;for(var a in s)o[a]=s[a];"object"==typeof e.exports?e.exports=o:void 0!==(i=(function(){return o}).call(s,r,s,e))&&(e.exports=i)}(0,function(e){e.__esModule=!0,e.digestLength=32,e.blockSize=64;var t=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function r(e,r,i,n,s){for(var o,a,l,u,c,h,d,f,p,m,y,g,b;s>=64;){for(m=0,o=r[0],a=r[1],l=r[2],u=r[3],c=r[4],h=r[5],d=r[6],f=r[7];m<16;m++)y=n+4*m,e[m]=(255&i[y])<<24|(255&i[y+1])<<16|(255&i[y+2])<<8|255&i[y+3];for(m=16;m<64;m++)g=((p=e[m-2])>>>17|p<<15)^(p>>>19|p<<13)^p>>>10,b=((p=e[m-15])>>>7|p<<25)^(p>>>18|p<<14)^p>>>3,e[m]=(g+e[m-7]|0)+(b+e[m-16]|0);for(m=0;m<64;m++)g=(((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))+(c&h^~c&d)|0)+(f+(t[m]+e[m]|0)|0)|0,b=((o>>>2|o<<30)^(o>>>13|o<<19)^(o>>>22|o<<10))+(o&a^o&l^a&l)|0,f=d,d=h,h=c,c=u+g|0,u=l,l=a,a=o,o=g+b|0;r[0]+=o,r[1]+=a,r[2]+=l,r[3]+=u,r[4]+=c,r[5]+=h,r[6]+=d,r[7]+=f,n+=64,s-=64}return n}var i=function(){function t(){this.digestLength=e.digestLength,this.blockSize=e.blockSize,this.state=new Int32Array(8),this.temp=new Int32Array(64),this.buffer=new Uint8Array(128),this.bufferLength=0,this.bytesHashed=0,this.finished=!1,this.reset()}return t.prototype.reset=function(){return this.state[0]=1779033703,this.state[1]=3144134277,this.state[2]=1013904242,this.state[3]=2773480762,this.state[4]=1359893119,this.state[5]=2600822924,this.state[6]=528734635,this.state[7]=1541459225,this.bufferLength=0,this.bytesHashed=0,this.finished=!1,this},t.prototype.clean=function(){for(var e=0;e<this.buffer.length;e++)this.buffer[e]=0;for(var e=0;e<this.temp.length;e++)this.temp[e]=0;this.reset()},t.prototype.update=function(e,t){if(void 0===t&&(t=e.length),this.finished)throw Error("SHA256: can't update because hash was finished.");var i=0;if(this.bytesHashed+=t,this.bufferLength>0){for(;this.bufferLength<64&&t>0;)this.buffer[this.bufferLength++]=e[i++],t--;64===this.bufferLength&&(r(this.temp,this.state,this.buffer,0,64),this.bufferLength=0)}for(t>=64&&(i=r(this.temp,this.state,e,i,t),t%=64);t>0;)this.buffer[this.bufferLength++]=e[i++],t--;return this},t.prototype.finish=function(e){if(!this.finished){var t=this.bytesHashed,i=this.bufferLength,n=t/536870912|0,s=t<<3,o=t%64<56?64:128;this.buffer[i]=128;for(var a=i+1;a<o-8;a++)this.buffer[a]=0;this.buffer[o-8]=n>>>24&255,this.buffer[o-7]=n>>>16&255,this.buffer[o-6]=n>>>8&255,this.buffer[o-5]=n>>>0&255,this.buffer[o-4]=s>>>24&255,this.buffer[o-3]=s>>>16&255,this.buffer[o-2]=s>>>8&255,this.buffer[o-1]=s>>>0&255,r(this.temp,this.state,this.buffer,0,o),this.finished=!0}for(var a=0;a<8;a++)e[4*a+0]=this.state[a]>>>24&255,e[4*a+1]=this.state[a]>>>16&255,e[4*a+2]=this.state[a]>>>8&255,e[4*a+3]=this.state[a]>>>0&255;return this},t.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},t.prototype._saveState=function(e){for(var t=0;t<this.state.length;t++)e[t]=this.state[t]},t.prototype._restoreState=function(e,t){for(var r=0;r<this.state.length;r++)this.state[r]=e[r];this.bytesHashed=t,this.finished=!1,this.bufferLength=0},t}();e.Hash=i;var n=function(){function e(e){this.inner=new i,this.outer=new i,this.blockSize=this.inner.blockSize,this.digestLength=this.inner.digestLength;var t=new Uint8Array(this.blockSize);if(e.length>this.blockSize)new i().update(e).finish(t).clean();else for(var r=0;r<e.length;r++)t[r]=e[r];for(var r=0;r<t.length;r++)t[r]^=54;this.inner.update(t);for(var r=0;r<t.length;r++)t[r]^=106;this.outer.update(t),this.istate=new Uint32Array(8),this.ostate=new Uint32Array(8),this.inner._saveState(this.istate),this.outer._saveState(this.ostate);for(var r=0;r<t.length;r++)t[r]=0}return e.prototype.reset=function(){return this.inner._restoreState(this.istate,this.inner.blockSize),this.outer._restoreState(this.ostate,this.outer.blockSize),this},e.prototype.clean=function(){for(var e=0;e<this.istate.length;e++)this.ostate[e]=this.istate[e]=0;this.inner.clean(),this.outer.clean()},e.prototype.update=function(e){return this.inner.update(e),this},e.prototype.finish=function(e){return this.outer.finished?this.outer.finish(e):(this.inner.finish(e),this.outer.update(e,this.digestLength).finish(e)),this},e.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},e}();function s(e){var t=new i().update(e),r=t.digest();return t.clean(),r}function o(e,t){var r=new n(e).update(t),i=r.digest();return r.clean(),i}e.HMAC=n,e.hash=s,e.default=s,e.hmac=o;var a=new Uint8Array(e.digestLength);e.hkdf=function(e,t,r,i){void 0===t&&(t=a),void 0===i&&(i=32);for(var s=new Uint8Array([1]),l=new n(o(t,e)),u=new Uint8Array(l.digestLength),c=u.length,h=new Uint8Array(i),d=0;d<i;d++)c===u.length&&(function(e,t,r,i){var n=i[0];if(0===n)throw Error("hkdf: cannot expand more");t.reset(),n>1&&t.update(e),r&&t.update(r),t.update(i),t.finish(e),i[0]++}(u,l,r,s),c=0),h[d]=u[c++];return l.clean(),u.fill(0),s.fill(0),h},e.pbkdf2=function(e,t,r,i){for(var s=new n(e),o=s.digestLength,a=new Uint8Array(4),l=new Uint8Array(o),u=new Uint8Array(o),c=new Uint8Array(i),h=0;h*o<i;h++){var d=h+1;a[0]=d>>>24&255,a[1]=d>>>16&255,a[2]=d>>>8&255,a[3]=d>>>0&255,s.reset(),s.update(t),s.update(a),s.finish(u);for(var f=0;f<o;f++)l[f]=u[f];for(var f=2;f<=r;f++){s.reset(),s.update(u).finish(u);for(var p=0;p<o;p++)l[p]^=u[p]}for(var f=0;f<o&&h*o+f<i;f++)c[h*o+f]=l[f]}for(var h=0;h<o;h++)l[h]=u[h]=0;for(var h=0;h<4;h++)a[h]=0;return s.clean(),c}})},10573:e=>{let t=e=>"object"==typeof e&&null!==e,r=Symbol("skip"),i=e=>t(e)&&!(e instanceof RegExp)&&!(e instanceof Error)&&!(e instanceof Date),n=(e,t,s,o=new WeakMap)=>{if(s={deep:!1,target:{},...s},o.has(e))return o.get(e);o.set(e,s.target);let{target:a}=s;delete s.target;let l=e=>e.map(e=>i(e)?n(e,t,s,o):e);if(Array.isArray(e))return l(e);for(let[u,c]of Object.entries(e)){let h=t(u,c,e);if(h===r)continue;let[d,f,{shouldRecurse:p=!0}={}]=h;"__proto__"!==d&&(s.deep&&p&&i(f)&&(f=Array.isArray(f)?l(f):n(f,t,s,o)),a[d]=f)}return a};e.exports=(e,r,i)=>{if(!t(e))throw TypeError(`Expected an object, got \`${e}\` (${typeof e})`);return n(e,r,i)},e.exports.mapObjectSkip=r},7439:(e,t,r)=>{r.r(t);var i=r(28290),n={};for(let e in i)"default"!==e&&(n[e]=()=>i[e]);r.d(t,n)},867:(e,t,r)=>{r.r(t);var i=r(19738),n={};for(let e in i)"default"!==e&&(n[e]=()=>i[e]);r.d(t,n)},86843:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"createProxy",{enumerable:!0,get:function(){return i}});let i=r(18195).createClientModuleProxy},34778:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"bailoutToClientRendering",{enumerable:!0,get:function(){return s}});let i=r(38675),n=r(45869);function s(e){let t=n.staticGenerationAsyncStorage.getStore();if((null==t||!t.forceStatic)&&(null==t?void 0:t.isStaticGeneration))throw new i.BailoutToCSRError(e)}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},84552:(e,t,r)=>{function i(e){}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"clientHookInServerComponentError",{enumerable:!0,get:function(){return i}}),r(46783),r(40002),("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},58284:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"DraftMode",{enumerable:!0,get:function(){return n}});let i=r(72973);class n{get isEnabled(){return this._provider.isEnabled}enable(){if(!(0,i.staticGenerationBailout)("draftMode().enable()"))return this._provider.enable()}disable(){if(!(0,i.staticGenerationBailout)("draftMode().disable()"))return this._provider.disable()}constructor(e){this._provider=e}}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},28290:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{headers:function(){return c},cookies:function(){return h},draftMode:function(){return d}});let i=r(97366),n=r(3022),s=r(63608),o=r(54580),a=r(72934),l=r(72973),u=r(58284);function c(){if((0,l.staticGenerationBailout)("headers",{link:"https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering"}))return n.HeadersAdapter.seal(new Headers({}));let e=o.requestAsyncStorage.getStore();if(!e)throw Error("Invariant: headers() expects to have requestAsyncStorage, none available.");return e.headers}function h(){if((0,l.staticGenerationBailout)("cookies",{link:"https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering"}))return i.RequestCookiesAdapter.seal(new s.RequestCookies(new Headers({})));let e=o.requestAsyncStorage.getStore();if(!e)throw Error("Invariant: cookies() expects to have requestAsyncStorage, none available.");let t=a.actionAsyncStorage.getStore();return t&&(t.isAction||t.isAppRoute)?e.mutableCookies:e.cookies}function d(){let e=o.requestAsyncStorage.getStore();if(!e)throw Error("Invariant: draftMode() expects to have requestAsyncStorage, none available.");return new u.DraftMode(e.draftMode)}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},48096:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{DynamicServerError:function(){return i},isDynamicServerError:function(){return n}});let r="DYNAMIC_SERVER_USAGE";class i extends Error{constructor(e){super("Dynamic server usage: "+e),this.description=e,this.digest=r}}function n(e){return"object"==typeof e&&null!==e&&"digest"in e&&"string"==typeof e.digest&&e.digest===r}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},19738:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{ReadonlyURLSearchParams:function(){return p},useSearchParams:function(){return m},usePathname:function(){return y},ServerInsertedHTMLContext:function(){return u.ServerInsertedHTMLContext},useServerInsertedHTML:function(){return u.useServerInsertedHTML},useRouter:function(){return g},useParams:function(){return b},useSelectedLayoutSegments:function(){return _},useSelectedLayoutSegment:function(){return v},redirect:function(){return c.redirect},permanentRedirect:function(){return c.permanentRedirect},RedirectType:function(){return c.RedirectType},notFound:function(){return h.notFound}});let i=r(40002),n=r(78726),s=r(57210),o=r(84552),a=r(83092),l=r(65458),u=r(80545),c=r(8010),h=r(1988),d=Symbol("internal for urlsearchparams readonly");function f(){return Error("ReadonlyURLSearchParams cannot be modified")}class p{[Symbol.iterator](){return this[d][Symbol.iterator]()}append(){throw f()}delete(){throw f()}set(){throw f()}sort(){throw f()}constructor(e){this[d]=e,this.entries=e.entries.bind(e),this.forEach=e.forEach.bind(e),this.get=e.get.bind(e),this.getAll=e.getAll.bind(e),this.has=e.has.bind(e),this.keys=e.keys.bind(e),this.values=e.values.bind(e),this.toString=e.toString.bind(e),this.size=e.size}}function m(){(0,o.clientHookInServerComponentError)("useSearchParams");let e=(0,i.useContext)(s.SearchParamsContext),t=(0,i.useMemo)(()=>e?new p(e):null,[e]);{let{bailoutToClientRendering:e}=r(34778);e("useSearchParams()")}return t}function y(){return(0,o.clientHookInServerComponentError)("usePathname"),(0,i.useContext)(s.PathnameContext)}function g(){(0,o.clientHookInServerComponentError)("useRouter");let e=(0,i.useContext)(n.AppRouterContext);if(null===e)throw Error("invariant expected app router to be mounted");return e}function b(){(0,o.clientHookInServerComponentError)("useParams");let e=(0,i.useContext)(n.GlobalLayoutRouterContext),t=(0,i.useContext)(s.PathParamsContext);return(0,i.useMemo)(()=>(null==e?void 0:e.tree)?function e(t,r){for(let i of(void 0===r&&(r={}),Object.values(t[1]))){let t=i[0],n=Array.isArray(t),s=n?t[1]:t;!s||s.startsWith(l.PAGE_SEGMENT_KEY)||(n&&("c"===t[2]||"oc"===t[2])?r[t[0]]=t[1].split("/"):n&&(r[t[0]]=t[1]),r=e(i,r))}return r}(e.tree):t,[null==e?void 0:e.tree,t])}function _(e){void 0===e&&(e="children"),(0,o.clientHookInServerComponentError)("useSelectedLayoutSegments");let{tree:t}=(0,i.useContext)(n.LayoutRouterContext);return function e(t,r,i,n){let s;if(void 0===i&&(i=!0),void 0===n&&(n=[]),i)s=t[1][r];else{var o;let e=t[1];s=null!=(o=e.children)?o:Object.values(e)[0]}if(!s)return n;let u=s[0],c=(0,a.getSegmentValue)(u);return!c||c.startsWith(l.PAGE_SEGMENT_KEY)?n:(n.push(c),e(s,r,!1,n))}(t,e)}function v(e){void 0===e&&(e="children"),(0,o.clientHookInServerComponentError)("useSelectedLayoutSegment");let t=_(e);return 0===t.length?null:t[0]}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},1988:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{notFound:function(){return i},isNotFoundError:function(){return n}});let r="NEXT_NOT_FOUND";function i(){let e=Error(r);throw e.digest=r,e}function n(e){return"object"==typeof e&&null!==e&&"digest"in e&&e.digest===r}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},45858:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"RedirectStatusCode",{enumerable:!0,get:function(){return r}}),function(e){e[e.SeeOther=303]="SeeOther",e[e.TemporaryRedirect=307]="TemporaryRedirect",e[e.PermanentRedirect=308]="PermanentRedirect"}(r||(r={})),("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},8010:(e,t,r)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{RedirectType:function(){return i},getRedirectError:function(){return l},redirect:function(){return u},permanentRedirect:function(){return c},isRedirectError:function(){return h},getURLFromRedirectError:function(){return d},getRedirectTypeFromError:function(){return f},getRedirectStatusCodeFromError:function(){return p}});let n=r(54580),s=r(72934),o=r(45858),a="NEXT_REDIRECT";function l(e,t,r){void 0===r&&(r=o.RedirectStatusCode.TemporaryRedirect);let i=Error(a);i.digest=a+";"+t+";"+e+";"+r+";";let s=n.requestAsyncStorage.getStore();return s&&(i.mutableCookies=s.mutableCookies),i}function u(e,t){void 0===t&&(t="replace");let r=s.actionAsyncStorage.getStore();throw l(e,t,(null==r?void 0:r.isAction)?o.RedirectStatusCode.SeeOther:o.RedirectStatusCode.TemporaryRedirect)}function c(e,t){void 0===t&&(t="replace");let r=s.actionAsyncStorage.getStore();throw l(e,t,(null==r?void 0:r.isAction)?o.RedirectStatusCode.SeeOther:o.RedirectStatusCode.PermanentRedirect)}function h(e){if("object"!=typeof e||null===e||!("digest"in e)||"string"!=typeof e.digest)return!1;let[t,r,i,n]=e.digest.split(";",4),s=Number(n);return t===a&&("replace"===r||"push"===r)&&"string"==typeof i&&!isNaN(s)&&s in o.RedirectStatusCode}function d(e){return h(e)?e.digest.split(";",3)[2]:null}function f(e){if(!h(e))throw Error("Not a redirect error");return e.digest.split(";",2)[1]}function p(e){if(!h(e))throw Error("Not a redirect error");return Number(e.digest.split(";",4)[3])}(function(e){e.push="push",e.replace="replace"})(i||(i={})),("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},83092:(e,t)=>{function r(e){return Array.isArray(e)?e[1]:e}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getSegmentValue",{enumerable:!0,get:function(){return r}}),("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},72973:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{isStaticGenBailoutError:function(){return a},staticGenerationBailout:function(){return u}});let i=r(48096),n=r(45869),s="NEXT_STATIC_GEN_BAILOUT";class o extends Error{constructor(...e){super(...e),this.code=s}}function a(e){return"object"==typeof e&&null!==e&&"code"in e&&e.code===s}function l(e,t){let{dynamic:r,link:i}=t||{};return"Page"+(r?' with `dynamic = "'+r+'"`':"")+" couldn't be rendered statically because it used `"+e+"`."+(i?" See more info here: "+i:"")}let u=(e,t)=>{let{dynamic:r,link:s}=void 0===t?{}:t,a=n.staticGenerationAsyncStorage.getStore();if(!a)return!1;if(a.forceStatic)return!0;if(a.dynamicShouldError)throw new o(l(e,{link:s,dynamic:null!=r?r:"error"}));let u=l(e,{dynamic:r,link:"https://nextjs.org/docs/messages/dynamic-server-error"});if(null==a.postpone||a.postpone.call(a,e),a.revalidate=0,a.isStaticGeneration){let t=new i.DynamicServerError(u);throw a.dynamicUsageDescription=e,a.dynamicUsageStack=t.stack,t}return!1};("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},97347:e=>{var t=Object.defineProperty,r=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,n=Object.prototype.hasOwnProperty,s={};function o(e){var t;let r=["path"in e&&e.path&&`Path=${e.path}`,"expires"in e&&(e.expires||0===e.expires)&&`Expires=${("number"==typeof e.expires?new Date(e.expires):e.expires).toUTCString()}`,"maxAge"in e&&"number"==typeof e.maxAge&&`Max-Age=${e.maxAge}`,"domain"in e&&e.domain&&`Domain=${e.domain}`,"secure"in e&&e.secure&&"Secure","httpOnly"in e&&e.httpOnly&&"HttpOnly","sameSite"in e&&e.sameSite&&`SameSite=${e.sameSite}`,"priority"in e&&e.priority&&`Priority=${e.priority}`].filter(Boolean);return`${e.name}=${encodeURIComponent(null!=(t=e.value)?t:"")}; ${r.join("; ")}`}function a(e){let t=new Map;for(let r of e.split(/; */)){if(!r)continue;let e=r.indexOf("=");if(-1===e){t.set(r,"true");continue}let[i,n]=[r.slice(0,e),r.slice(e+1)];try{t.set(i,decodeURIComponent(null!=n?n:"true"))}catch{}}return t}function l(e){var t,r;if(!e)return;let[[i,n],...s]=a(e),{domain:o,expires:l,httponly:h,maxage:d,path:f,samesite:p,secure:m,priority:y}=Object.fromEntries(s.map(([e,t])=>[e.toLowerCase(),t]));return function(e){let t={};for(let r in e)e[r]&&(t[r]=e[r]);return t}({name:i,value:decodeURIComponent(n),domain:o,...l&&{expires:new Date(l)},...h&&{httpOnly:!0},..."string"==typeof d&&{maxAge:Number(d)},path:f,...p&&{sameSite:u.includes(t=(t=p).toLowerCase())?t:void 0},...m&&{secure:!0},...y&&{priority:c.includes(r=(r=y).toLowerCase())?r:void 0}})}((e,r)=>{for(var i in r)t(e,i,{get:r[i],enumerable:!0})})(s,{RequestCookies:()=>h,ResponseCookies:()=>d,parseCookie:()=>a,parseSetCookie:()=>l,stringifyCookie:()=>o}),e.exports=((e,s,o,a)=>{if(s&&"object"==typeof s||"function"==typeof s)for(let o of i(s))n.call(e,o)||void 0===o||t(e,o,{get:()=>s[o],enumerable:!(a=r(s,o))||a.enumerable});return e})(t({},"__esModule",{value:!0}),s);var u=["strict","lax","none"],c=["low","medium","high"],h=class{constructor(e){this._parsed=new Map,this._headers=e;let t=e.get("cookie");if(t)for(let[e,r]of a(t))this._parsed.set(e,{name:e,value:r})}[Symbol.iterator](){return this._parsed[Symbol.iterator]()}get size(){return this._parsed.size}get(...e){let t="string"==typeof e[0]?e[0]:e[0].name;return this._parsed.get(t)}getAll(...e){var t;let r=Array.from(this._parsed);if(!e.length)return r.map(([e,t])=>t);let i="string"==typeof e[0]?e[0]:null==(t=e[0])?void 0:t.name;return r.filter(([e])=>e===i).map(([e,t])=>t)}has(e){return this._parsed.has(e)}set(...e){let[t,r]=1===e.length?[e[0].name,e[0].value]:e,i=this._parsed;return i.set(t,{name:t,value:r}),this._headers.set("cookie",Array.from(i).map(([e,t])=>o(t)).join("; ")),this}delete(e){let t=this._parsed,r=Array.isArray(e)?e.map(e=>t.delete(e)):t.delete(e);return this._headers.set("cookie",Array.from(t).map(([e,t])=>o(t)).join("; ")),r}clear(){return this.delete(Array.from(this._parsed.keys())),this}[Symbol.for("edge-runtime.inspect.custom")](){return`RequestCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`}toString(){return[...this._parsed.values()].map(e=>`${e.name}=${encodeURIComponent(e.value)}`).join("; ")}},d=class{constructor(e){var t,r,i;this._parsed=new Map,this._headers=e;let n=null!=(i=null!=(r=null==(t=e.getSetCookie)?void 0:t.call(e))?r:e.get("set-cookie"))?i:[];for(let e of Array.isArray(n)?n:function(e){if(!e)return[];var t,r,i,n,s,o=[],a=0;function l(){for(;a<e.length&&/\s/.test(e.charAt(a));)a+=1;return a<e.length}for(;a<e.length;){for(t=a,s=!1;l();)if(","===(r=e.charAt(a))){for(i=a,a+=1,l(),n=a;a<e.length&&"="!==(r=e.charAt(a))&&";"!==r&&","!==r;)a+=1;a<e.length&&"="===e.charAt(a)?(s=!0,a=n,o.push(e.substring(t,i)),t=a):a=i+1}else a+=1;(!s||a>=e.length)&&o.push(e.substring(t,e.length))}return o}(n)){let t=l(e);t&&this._parsed.set(t.name,t)}}get(...e){let t="string"==typeof e[0]?e[0]:e[0].name;return this._parsed.get(t)}getAll(...e){var t;let r=Array.from(this._parsed.values());if(!e.length)return r;let i="string"==typeof e[0]?e[0]:null==(t=e[0])?void 0:t.name;return r.filter(e=>e.name===i)}has(e){return this._parsed.has(e)}set(...e){let[t,r,i]=1===e.length?[e[0].name,e[0].value,e[0]]:e,n=this._parsed;return n.set(t,function(e={name:"",value:""}){return"number"==typeof e.expires&&(e.expires=new Date(e.expires)),e.maxAge&&(e.expires=new Date(Date.now()+1e3*e.maxAge)),(null===e.path||void 0===e.path)&&(e.path="/"),e}({name:t,value:r,...i})),function(e,t){for(let[,r]of(t.delete("set-cookie"),e)){let e=o(r);t.append("set-cookie",e)}}(n,this._headers),this}delete(...e){let[t,r,i]="string"==typeof e[0]?[e[0]]:[e[0].name,e[0].path,e[0].domain];return this.set({name:t,path:r,domain:i,value:"",expires:new Date(0)})}[Symbol.for("edge-runtime.inspect.custom")](){return`ResponseCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`}toString(){return[...this._parsed.values()].map(o).join("; ")}}},50482:(e,t,r)=>{e.exports=r(20399)},78726:(e,t,r)=>{e.exports=r(50482).vendored.contexts.AppRouterContext},57210:(e,t,r)=>{e.exports=r(50482).vendored.contexts.HooksClientContext},80545:(e,t,r)=>{e.exports=r(50482).vendored.contexts.ServerInsertedHtml},18195:(e,t,r)=>{e.exports=r(50482).vendored["react-rsc"].ReactServerDOMWebpackServerEdge},40002:(e,t,r)=>{e.exports=r(50482).vendored["react-rsc"].React},95419:(e,t,r)=>{e.exports=r(30517)},8397:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{PageSignatureError:function(){return r},RemovedPageError:function(){return i},RemovedUAError:function(){return n}});class r extends Error{constructor({page:e}){super(`The middleware "${e}" accepts an async API directly with the form:
  
  export function middleware(request, event) {
    return NextResponse.redirect('/new-location')
  }
  
  Read more: https://nextjs.org/docs/messages/middleware-new-signature
  `)}}class i extends Error{constructor(){super(`The request.page has been deprecated in favour of \`URLPattern\`.
  Read more: https://nextjs.org/docs/messages/middleware-request-page
  `)}}class n extends Error{constructor(){super(`The request.ua has been removed in favour of \`userAgent\` function.
  Read more: https://nextjs.org/docs/messages/middleware-parse-user-agent
  `)}}},80424:(e,t,r)=>{Object.defineProperty(t,"Z",{enumerable:!0,get:function(){return i.NextRequest}});let i=r(71868)},78070:(e,t,r)=>{Object.defineProperty(t,"Z",{enumerable:!0,get:function(){return i.NextResponse}});let i=r(70457)},10514:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"NextURL",{enumerable:!0,get:function(){return c}});let i=r(737),n=r(65418),s=r(40283),o=r(23588),a=/(?!^https?:\/\/)(127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}|\[::1\]|localhost)/;function l(e,t){return new URL(String(e).replace(a,"localhost"),t&&String(t).replace(a,"localhost"))}let u=Symbol("NextURLInternal");class c{constructor(e,t,r){let i,n;"object"==typeof t&&"pathname"in t||"string"==typeof t?(i=t,n=r||{}):n=r||t||{},this[u]={url:l(e,i??n.base),options:n,basePath:""},this.analyze()}analyze(){var e,t,r,n,a;let l=(0,o.getNextPathnameInfo)(this[u].url.pathname,{nextConfig:this[u].options.nextConfig,parseData:!0,i18nProvider:this[u].options.i18nProvider}),c=(0,s.getHostname)(this[u].url,this[u].options.headers);this[u].domainLocale=this[u].options.i18nProvider?this[u].options.i18nProvider.detectDomainLocale(c):(0,i.detectDomainLocale)(null==(t=this[u].options.nextConfig)?void 0:null==(e=t.i18n)?void 0:e.domains,c);let h=(null==(r=this[u].domainLocale)?void 0:r.defaultLocale)||(null==(a=this[u].options.nextConfig)?void 0:null==(n=a.i18n)?void 0:n.defaultLocale);this[u].url.pathname=l.pathname,this[u].defaultLocale=h,this[u].basePath=l.basePath??"",this[u].buildId=l.buildId,this[u].locale=l.locale??h,this[u].trailingSlash=l.trailingSlash}formatPathname(){return(0,n.formatNextPathnameInfo)({basePath:this[u].basePath,buildId:this[u].buildId,defaultLocale:this[u].options.forceLocale?void 0:this[u].defaultLocale,locale:this[u].locale,pathname:this[u].url.pathname,trailingSlash:this[u].trailingSlash})}formatSearch(){return this[u].url.search}get buildId(){return this[u].buildId}set buildId(e){this[u].buildId=e}get locale(){return this[u].locale??""}set locale(e){var t,r;if(!this[u].locale||!(null==(r=this[u].options.nextConfig)?void 0:null==(t=r.i18n)?void 0:t.locales.includes(e)))throw TypeError(`The NextURL configuration includes no locale "${e}"`);this[u].locale=e}get defaultLocale(){return this[u].defaultLocale}get domainLocale(){return this[u].domainLocale}get searchParams(){return this[u].url.searchParams}get host(){return this[u].url.host}set host(e){this[u].url.host=e}get hostname(){return this[u].url.hostname}set hostname(e){this[u].url.hostname=e}get port(){return this[u].url.port}set port(e){this[u].url.port=e}get protocol(){return this[u].url.protocol}set protocol(e){this[u].url.protocol=e}get href(){let e=this.formatPathname(),t=this.formatSearch();return`${this.protocol}//${this.host}${e}${t}${this.hash}`}set href(e){this[u].url=l(e),this.analyze()}get origin(){return this[u].url.origin}get pathname(){return this[u].url.pathname}set pathname(e){this[u].url.pathname=e}get hash(){return this[u].url.hash}set hash(e){this[u].url.hash=e}get search(){return this[u].url.search}set search(e){this[u].url.search=e}get password(){return this[u].url.password}set password(e){this[u].url.password=e}get username(){return this[u].url.username}set username(e){this[u].url.username=e}get basePath(){return this[u].basePath}set basePath(e){this[u].basePath=e.startsWith("/")?e:`/${e}`}toString(){return this.href}toJSON(){return this.href}[Symbol.for("edge-runtime.inspect.custom")](){return{href:this.href,origin:this.origin,protocol:this.protocol,username:this.username,password:this.password,host:this.host,hostname:this.hostname,port:this.port,pathname:this.pathname,search:this.search,searchParams:this.searchParams,hash:this.hash}}clone(){return new c(String(this),this[u].options)}}},3022:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{ReadonlyHeadersError:function(){return n},HeadersAdapter:function(){return s}});let i=r(6250);class n extends Error{constructor(){super("Headers cannot be modified. Read more: https://nextjs.org/docs/app/api-reference/functions/headers")}static callable(){throw new n}}class s extends Headers{constructor(e){super(),this.headers=new Proxy(e,{get(t,r,n){if("symbol"==typeof r)return i.ReflectAdapter.get(t,r,n);let s=r.toLowerCase(),o=Object.keys(e).find(e=>e.toLowerCase()===s);if(void 0!==o)return i.ReflectAdapter.get(t,o,n)},set(t,r,n,s){if("symbol"==typeof r)return i.ReflectAdapter.set(t,r,n,s);let o=r.toLowerCase(),a=Object.keys(e).find(e=>e.toLowerCase()===o);return i.ReflectAdapter.set(t,a??r,n,s)},has(t,r){if("symbol"==typeof r)return i.ReflectAdapter.has(t,r);let n=r.toLowerCase(),s=Object.keys(e).find(e=>e.toLowerCase()===n);return void 0!==s&&i.ReflectAdapter.has(t,s)},deleteProperty(t,r){if("symbol"==typeof r)return i.ReflectAdapter.deleteProperty(t,r);let n=r.toLowerCase(),s=Object.keys(e).find(e=>e.toLowerCase()===n);return void 0===s||i.ReflectAdapter.deleteProperty(t,s)}})}static seal(e){return new Proxy(e,{get(e,t,r){switch(t){case"append":case"delete":case"set":return n.callable;default:return i.ReflectAdapter.get(e,t,r)}}})}merge(e){return Array.isArray(e)?e.join(", "):e}static from(e){return e instanceof Headers?e:new s(e)}append(e,t){let r=this.headers[e];"string"==typeof r?this.headers[e]=[r,t]:Array.isArray(r)?r.push(t):this.headers[e]=t}delete(e){delete this.headers[e]}get(e){let t=this.headers[e];return void 0!==t?this.merge(t):null}has(e){return void 0!==this.headers[e]}set(e,t){this.headers[e]=t}forEach(e,t){for(let[r,i]of this.entries())e.call(t,i,r,this)}*entries(){for(let e of Object.keys(this.headers)){let t=e.toLowerCase(),r=this.get(t);yield[t,r]}}*keys(){for(let e of Object.keys(this.headers)){let t=e.toLowerCase();yield t}}*values(){for(let e of Object.keys(this.headers)){let t=this.get(e);yield t}}[Symbol.iterator](){return this.entries()}}},6250:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ReflectAdapter",{enumerable:!0,get:function(){return r}});class r{static get(e,t,r){let i=Reflect.get(e,t,r);return"function"==typeof i?i.bind(e):i}static set(e,t,r,i){return Reflect.set(e,t,r,i)}static has(e,t){return Reflect.has(e,t)}static deleteProperty(e,t){return Reflect.deleteProperty(e,t)}}},97366:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{ReadonlyRequestCookiesError:function(){return s},RequestCookiesAdapter:function(){return o},getModifiedCookieValues:function(){return l},appendMutableCookies:function(){return u},MutableRequestCookiesAdapter:function(){return c}});let i=r(63608),n=r(6250);class s extends Error{constructor(){super("Cookies can only be modified in a Server Action or Route Handler. Read more: https://nextjs.org/docs/app/api-reference/functions/cookies#cookiessetname-value-options")}static callable(){throw new s}}class o{static seal(e){return new Proxy(e,{get(e,t,r){switch(t){case"clear":case"delete":case"set":return s.callable;default:return n.ReflectAdapter.get(e,t,r)}}})}}let a=Symbol.for("next.mutated.cookies");function l(e){let t=e[a];return t&&Array.isArray(t)&&0!==t.length?t:[]}function u(e,t){let r=l(t);if(0===r.length)return!1;let n=new i.ResponseCookies(e),s=n.getAll();for(let e of r)n.set(e);for(let e of s)n.set(e);return!0}class c{static wrap(e,t){let r=new i.ResponseCookies(new Headers);for(let t of e.getAll())r.set(t);let s=[],o=new Set,l=()=>{var e;let n=null==fetch.__nextGetStaticStore?void 0:null==(e=fetch.__nextGetStaticStore.call(fetch))?void 0:e.getStore();if(n&&(n.pathWasRevalidated=!0),s=r.getAll().filter(e=>o.has(e.name)),t){let e=[];for(let t of s){let r=new i.ResponseCookies(new Headers);r.set(t),e.push(r.toString())}t(e)}};return new Proxy(r,{get(e,t,r){switch(t){case a:return s;case"delete":return function(...t){o.add("string"==typeof t[0]?t[0]:t[0].name);try{e.delete(...t)}finally{l()}};case"set":return function(...t){o.add("string"==typeof t[0]?t[0]:t[0].name);try{return e.set(...t)}finally{l()}};default:return n.ReflectAdapter.get(e,t,r)}}})}}},63608:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{RequestCookies:function(){return i.RequestCookies},ResponseCookies:function(){return i.ResponseCookies}});let i=r(97347)},71868:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{INTERNALS:function(){return a},NextRequest:function(){return l}});let i=r(10514),n=r(68670),s=r(8397),o=r(63608),a=Symbol("internal request");class l extends Request{constructor(e,t={}){let r="string"!=typeof e&&"url"in e?e.url:String(e);(0,n.validateURL)(r),e instanceof Request?super(e,t):super(r,t);let s=new i.NextURL(r,{headers:(0,n.toNodeOutgoingHttpHeaders)(this.headers),nextConfig:t.nextConfig});this[a]={cookies:new o.RequestCookies(this.headers),geo:t.geo||{},ip:t.ip,nextUrl:s,url:s.toString()}}[Symbol.for("edge-runtime.inspect.custom")](){return{cookies:this.cookies,geo:this.geo,ip:this.ip,nextUrl:this.nextUrl,url:this.url,bodyUsed:this.bodyUsed,cache:this.cache,credentials:this.credentials,destination:this.destination,headers:Object.fromEntries(this.headers),integrity:this.integrity,keepalive:this.keepalive,method:this.method,mode:this.mode,redirect:this.redirect,referrer:this.referrer,referrerPolicy:this.referrerPolicy,signal:this.signal}}get cookies(){return this[a].cookies}get geo(){return this[a].geo}get ip(){return this[a].ip}get nextUrl(){return this[a].nextUrl}get page(){throw new s.RemovedPageError}get ua(){throw new s.RemovedUAError}get url(){return this[a].url}}},70457:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"NextResponse",{enumerable:!0,get:function(){return u}});let i=r(10514),n=r(68670),s=r(63608),o=Symbol("internal response"),a=new Set([301,302,303,307,308]);function l(e,t){var r;if(null==e?void 0:null==(r=e.request)?void 0:r.headers){if(!(e.request.headers instanceof Headers))throw Error("request.headers must be an instance of Headers");let r=[];for(let[i,n]of e.request.headers)t.set("x-middleware-request-"+i,n),r.push(i);t.set("x-middleware-override-headers",r.join(","))}}class u extends Response{constructor(e,t={}){super(e,t),this[o]={cookies:new s.ResponseCookies(this.headers),url:t.url?new i.NextURL(t.url,{headers:(0,n.toNodeOutgoingHttpHeaders)(this.headers),nextConfig:t.nextConfig}):void 0}}[Symbol.for("edge-runtime.inspect.custom")](){return{cookies:this.cookies,url:this.url,body:this.body,bodyUsed:this.bodyUsed,headers:Object.fromEntries(this.headers),ok:this.ok,redirected:this.redirected,status:this.status,statusText:this.statusText,type:this.type}}get cookies(){return this[o].cookies}static json(e,t){let r=Response.json(e,t);return new u(r.body,r)}static redirect(e,t){let r="number"==typeof t?t:(null==t?void 0:t.status)??307;if(!a.has(r))throw RangeError('Failed to execute "redirect" on "response": Invalid status code');let i="object"==typeof t?t:{},s=new Headers(null==i?void 0:i.headers);return s.set("Location",(0,n.validateURL)(e)),new u(null,{...i,headers:s,status:r})}static rewrite(e,t){let r=new Headers(null==t?void 0:t.headers);return r.set("x-middleware-rewrite",(0,n.validateURL)(e)),l(t,r),new u(null,{...t,headers:r})}static next(e){let t=new Headers(null==e?void 0:e.headers);return t.set("x-middleware-next","1"),l(e,t),new u(null,{...e,headers:t})}}},68670:(e,t)=>{function r(e){let t=new Headers;for(let[r,i]of Object.entries(e))for(let e of Array.isArray(i)?i:[i])void 0!==e&&("number"==typeof e&&(e=e.toString()),t.append(r,e));return t}function i(e){var t,r,i,n,s,o=[],a=0;function l(){for(;a<e.length&&/\s/.test(e.charAt(a));)a+=1;return a<e.length}for(;a<e.length;){for(t=a,s=!1;l();)if(","===(r=e.charAt(a))){for(i=a,a+=1,l(),n=a;a<e.length&&"="!==(r=e.charAt(a))&&";"!==r&&","!==r;)a+=1;a<e.length&&"="===e.charAt(a)?(s=!0,a=n,o.push(e.substring(t,i)),t=a):a=i+1}else a+=1;(!s||a>=e.length)&&o.push(e.substring(t,e.length))}return o}function n(e){let t={},r=[];if(e)for(let[n,s]of e.entries())"set-cookie"===n.toLowerCase()?(r.push(...i(s)),t[n]=1===r.length?r[0]:r):t[n]=s;return t}function s(e){try{return String(new URL(String(e)))}catch(t){throw Error(`URL is malformed "${String(e)}". Please use only absolute URLs - https://nextjs.org/docs/messages/middleware-relative-urls`,{cause:t})}}Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{fromNodeOutgoingHttpHeaders:function(){return r},splitCookiesString:function(){return i},toNodeOutgoingHttpHeaders:function(){return n},validateURL:function(){return s}})},40283:(e,t)=>{function r(e,t){let r;if((null==t?void 0:t.host)&&!Array.isArray(t.host))r=t.host.toString().split(":",1)[0];else{if(!e.hostname)return;r=e.hostname}return r.toLowerCase()}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getHostname",{enumerable:!0,get:function(){return r}})},737:(e,t)=>{function r(e,t,r){if(e)for(let s of(r&&(r=r.toLowerCase()),e)){var i,n;if(t===(null==(i=s.domain)?void 0:i.split(":",1)[0].toLowerCase())||r===s.defaultLocale.toLowerCase()||(null==(n=s.locales)?void 0:n.some(e=>e.toLowerCase()===r)))return s}}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"detectDomainLocale",{enumerable:!0,get:function(){return r}})},73935:(e,t)=>{function r(e,t){let r;let i=e.split("/");return(t||[]).some(t=>!!i[1]&&i[1].toLowerCase()===t.toLowerCase()&&(r=t,i.splice(1,1),e=i.join("/")||"/",!0)),{pathname:e,detectedLocale:r}}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"normalizeLocalePath",{enumerable:!0,get:function(){return r}})},38675:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{BailoutToCSRError:function(){return i},isBailoutToCSRError:function(){return n}});let r="BAILOUT_TO_CLIENT_SIDE_RENDERING";class i extends Error{constructor(e){super("Bail out to client-side rendering: "+e),this.reason=e,this.digest=r}}function n(e){return"object"==typeof e&&null!==e&&"digest"in e&&e.digest===r}},28030:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"addLocale",{enumerable:!0,get:function(){return s}});let i=r(23495),n=r(67211);function s(e,t,r,s){if(!t||t===r)return e;let o=e.toLowerCase();return!s&&((0,n.pathHasPrefix)(o,"/api")||(0,n.pathHasPrefix)(o,"/"+t.toLowerCase()))?e:(0,i.addPathPrefix)(e,"/"+t)}},23495:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"addPathPrefix",{enumerable:!0,get:function(){return n}});let i=r(81955);function n(e,t){if(!e.startsWith("/")||!t)return e;let{pathname:r,query:n,hash:s}=(0,i.parsePath)(e);return""+t+r+n+s}},2348:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"addPathSuffix",{enumerable:!0,get:function(){return n}});let i=r(81955);function n(e,t){if(!e.startsWith("/")||!t)return e;let{pathname:r,query:n,hash:s}=(0,i.parsePath)(e);return""+r+t+n+s}},65418:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"formatNextPathnameInfo",{enumerable:!0,get:function(){return a}});let i=r(5545),n=r(23495),s=r(2348),o=r(28030);function a(e){let t=(0,o.addLocale)(e.pathname,e.locale,e.buildId?void 0:e.defaultLocale,e.ignorePrefix);return(e.buildId||!e.trailingSlash)&&(t=(0,i.removeTrailingSlash)(t)),e.buildId&&(t=(0,s.addPathSuffix)((0,n.addPathPrefix)(t,"/_next/data/"+e.buildId),"/"===e.pathname?"index.json":".json")),t=(0,n.addPathPrefix)(t,e.basePath),!e.buildId&&e.trailingSlash?t.endsWith("/")?t:(0,s.addPathSuffix)(t,"/"):(0,i.removeTrailingSlash)(t)}},23588:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getNextPathnameInfo",{enumerable:!0,get:function(){return o}});let i=r(73935),n=r(37188),s=r(67211);function o(e,t){var r,o;let{basePath:a,i18n:l,trailingSlash:u}=null!=(r=t.nextConfig)?r:{},c={pathname:e,trailingSlash:"/"!==e?e.endsWith("/"):u};a&&(0,s.pathHasPrefix)(c.pathname,a)&&(c.pathname=(0,n.removePathPrefix)(c.pathname,a),c.basePath=a);let h=c.pathname;if(c.pathname.startsWith("/_next/data/")&&c.pathname.endsWith(".json")){let e=c.pathname.replace(/^\/_next\/data\//,"").replace(/\.json$/,"").split("/"),r=e[0];c.buildId=r,h="index"!==e[1]?"/"+e.slice(1).join("/"):"/",!0===t.parseData&&(c.pathname=h)}if(l){let e=t.i18nProvider?t.i18nProvider.analyze(c.pathname):(0,i.normalizeLocalePath)(c.pathname,l.locales);c.locale=e.detectedLocale,c.pathname=null!=(o=e.pathname)?o:c.pathname,!e.detectedLocale&&c.buildId&&(e=t.i18nProvider?t.i18nProvider.analyze(h):(0,i.normalizeLocalePath)(h,l.locales)).detectedLocale&&(c.locale=e.detectedLocale)}return c}},81955:(e,t)=>{function r(e){let t=e.indexOf("#"),r=e.indexOf("?"),i=r>-1&&(t<0||r<t);return i||t>-1?{pathname:e.substring(0,i?r:t),query:i?e.substring(r,t>-1?t:void 0):"",hash:t>-1?e.slice(t):""}:{pathname:e,query:"",hash:""}}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"parsePath",{enumerable:!0,get:function(){return r}})},67211:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"pathHasPrefix",{enumerable:!0,get:function(){return n}});let i=r(81955);function n(e,t){if("string"!=typeof e)return!1;let{pathname:r}=(0,i.parsePath)(e);return r===t||r.startsWith(t+"/")}},37188:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"removePathPrefix",{enumerable:!0,get:function(){return n}});let i=r(67211);function n(e,t){if(!(0,i.pathHasPrefix)(e,t))return e;let r=e.slice(t.length);return r.startsWith("/")?r:"/"+r}},5545:(e,t)=>{function r(e){return e.replace(/\/$/,"")||"/"}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"removeTrailingSlash",{enumerable:!0,get:function(){return r}})},65458:(e,t)=>{function r(e){return"("===e[0]&&e.endsWith(")")}Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{isGroupSegment:function(){return r},PAGE_SEGMENT_KEY:function(){return i},DEFAULT_SEGMENT_KEY:function(){return n}});let i="__PAGE__",n="__DEFAULT__"},9314:(e,t,r)=>{r.r(t),r.d(t,{snakeCase:()=>l});var i=r(74533);function n(e){return e.toLowerCase()}var s=[/([a-z0-9])([A-Z])/g,/([A-Z])([A-Z][a-z])/g],o=/[^A-Z0-9]+/gi;function a(e,t,r){return t instanceof RegExp?e.replace(t,r):t.reduce(function(e,t){return e.replace(t,r)},e)}function l(e,t){var r;return void 0===t&&(t={}),void 0===(r=(0,i.pi)({delimiter:"_"},t))&&(r={}),function(e,t){void 0===t&&(t={});for(var r=t.splitRegexp,i=t.stripRegexp,l=t.transform,u=t.delimiter,c=a(a(e,void 0===r?s:r,"$1\x00$2"),void 0===i?o:i,"\x00"),h=0,d=c.length;"\x00"===c.charAt(h);)h++;for(;"\x00"===c.charAt(d-1);)d--;return c.slice(h,d).split("\x00").map(void 0===l?n:l).join(void 0===u?" ":u)}(e,(0,i.pi)({delimiter:"."},r))}},78591:(e,t,r)=>{let i=r(10573),{snakeCase:n}=r(9314);e.exports=function(e,t){return i(e,function(e,r){return[t.exclude.some(function(t){return"string"==typeof t?t===e:t.test(e)})?e:n(e,t.parsingOptions),r]},t=Object.assign({deep:!0,exclude:[],parsingOptions:{}},t))}},10680:(e,t,r)=>{r(87561),r(49411);let i=r(39306);r(88849),r(22286),r(65628),r(84492),r(72254),r(47261),r(41041),r(87503);let n=0,s={START_BOUNDARY:n++,HEADER_FIELD_START:n++,HEADER_FIELD:n++,HEADER_VALUE_START:n++,HEADER_VALUE:n++,HEADER_VALUE_ALMOST_DONE:n++,HEADERS_ALMOST_DONE:n++,PART_DATA_START:n++,PART_DATA:n++,END:n++},o={PART_BOUNDARY:1,LAST_BOUNDARY:2},a=e=>32|e,l=()=>{};class u{constructor(e){this.index=0,this.flags=0,this.onHeaderEnd=l,this.onHeaderField=l,this.onHeadersEnd=l,this.onHeaderValue=l,this.onPartBegin=l,this.onPartData=l,this.onPartEnd=l,this.boundaryChars={},e="\r\n--"+e;let t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r),this.boundaryChars[t[r]]=!0;this.boundary=t,this.lookbehind=new Uint8Array(this.boundary.length+8),this.state=s.START_BOUNDARY}write(e){let t,r,i=0,n=e.length,l=this.index,{lookbehind:u,boundary:c,boundaryChars:h,index:d,state:f,flags:p}=this,m=this.boundary.length,y=m-1,g=e.length,b=e=>{this[e+"Mark"]=i},_=e=>{delete this[e+"Mark"]},v=(e,t,r,i)=>{(void 0===t||t!==r)&&this[e](i&&i.subarray(t,r))},w=(t,r)=>{let n=t+"Mark";n in this&&(r?(v(t,this[n],i,e),delete this[n]):(v(t,this[n],e.length,e),this[n]=0))};for(i=0;i<n;i++)switch(t=e[i],f){case s.START_BOUNDARY:if(d===c.length-2){if(45===t)p|=o.LAST_BOUNDARY;else if(13!==t)return;d++;break}if(d-1==c.length-2){if(p&o.LAST_BOUNDARY&&45===t)f=s.END,p=0;else{if(p&o.LAST_BOUNDARY||10!==t)return;d=0,v("onPartBegin"),f=s.HEADER_FIELD_START}break}t!==c[d+2]&&(d=-2),t===c[d+2]&&d++;break;case s.HEADER_FIELD_START:f=s.HEADER_FIELD,b("onHeaderField"),d=0;case s.HEADER_FIELD:if(13===t){_("onHeaderField"),f=s.HEADERS_ALMOST_DONE;break}if(d++,45===t)break;if(58===t){if(1===d)return;w("onHeaderField",!0),f=s.HEADER_VALUE_START;break}if((r=a(t))<97||r>122)return;break;case s.HEADER_VALUE_START:if(32===t)break;b("onHeaderValue"),f=s.HEADER_VALUE;case s.HEADER_VALUE:13===t&&(w("onHeaderValue",!0),v("onHeaderEnd"),f=s.HEADER_VALUE_ALMOST_DONE);break;case s.HEADER_VALUE_ALMOST_DONE:if(10!==t)return;f=s.HEADER_FIELD_START;break;case s.HEADERS_ALMOST_DONE:if(10!==t)return;v("onHeadersEnd"),f=s.PART_DATA_START;break;case s.PART_DATA_START:f=s.PART_DATA,b("onPartData");case s.PART_DATA:if(l=d,0===d){for(i+=y;i<g&&!(e[i]in h);)i+=m;i-=y,t=e[i]}if(d<c.length)c[d]===t?(0===d&&w("onPartData",!0),d++):d=0;else if(d===c.length)d++,13===t?p|=o.PART_BOUNDARY:45===t?p|=o.LAST_BOUNDARY:d=0;else if(d-1===c.length){if(p&o.PART_BOUNDARY){if(d=0,10===t){p&=~o.PART_BOUNDARY,v("onPartEnd"),v("onPartBegin"),f=s.HEADER_FIELD_START;break}}else p&o.LAST_BOUNDARY&&45===t?(v("onPartEnd"),f=s.END,p=0):d=0}d>0?u[d-1]=t:l>0&&(v("onPartData",0,l,new Uint8Array(u.buffer,u.byteOffset,u.byteLength)),l=0,b("onPartData"),i--);break;case s.END:break;default:throw Error(`Unexpected state entered: ${f}`)}w("onHeaderField"),w("onHeaderValue"),w("onPartData"),this.index=d,this.state=f,this.flags=p}end(){if(this.state===s.HEADER_FIELD_START&&0===this.index||this.state===s.PART_DATA&&this.index===this.boundary.length)this.onPartEnd();else if(this.state!==s.END)throw Error("MultipartParser.end(): stream ended unexpectedly")}}async function c(e,t){let r,n,s,o,a,l;if(!/multipart/i.test(t))throw TypeError("Failed to fetch");let c=t.match(/boundary=(?:"([^"]+)"|([^;]+))/i);if(!c)throw TypeError("no or bad content-type header, no multipart boundary");let h=new u(c[1]||c[2]),d=[],f=new i.FormData,p=e=>{s+=b.decode(e,{stream:!0})},m=e=>{d.push(e)},y=()=>{let e=new i.File(d,l,{type:a});f.append(o,e)},g=()=>{f.append(o,s)},b=new TextDecoder("utf-8");for await(let t of(b.decode(),h.onPartBegin=function(){h.onPartData=p,h.onPartEnd=g,r="",n="",s="",o="",a="",l=null,d.length=0},h.onHeaderField=function(e){r+=b.decode(e,{stream:!0})},h.onHeaderValue=function(e){n+=b.decode(e,{stream:!0})},h.onHeaderEnd=function(){if(n+=b.decode(),"content-disposition"===(r=r.toLowerCase())){let e=n.match(/\bname=("([^"]*)"|([^()<>@,;:\\"/[\]?={}\s\t]+))/i);e&&(o=e[2]||e[3]||""),(l=function(e){let t=e.match(/\bfilename=("(.*?)"|([^()<>@,;:\\"/[\]?={}\s\t]+))($|;\s)/i);if(!t)return;let r=t[2]||t[3]||"",i=r.slice(r.lastIndexOf("\\")+1);return(i=i.replace(/%22/g,'"')).replace(/&#(\d{4});/g,(e,t)=>String.fromCharCode(t))}(n))&&(h.onPartData=m,h.onPartEnd=y)}else"content-type"===r&&(a=n);n="",r=""},e))h.write(t);return h.end(),f}t.toFormData=c},2218:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let i=r(39306),n=r(87561),s=r(49411);r(88849),r(22286),r(65628),r(84492),r(72254),r(47261),r(41041),r(87503);let{stat:o}=n.promises,a=(e,t,r="")=>new i._Blob([new u({path:t,size:e.size,lastModified:e.mtimeMs,start:0})],{type:r}),l=(e,t,r="")=>new i.File([new u({path:t,size:e.size,lastModified:e.mtimeMs,start:0})],s.basename(t),{type:r,lastModified:e.mtimeMs});class u{#e;#t;constructor(e){this.#e=e.path,this.#t=e.start,this.size=e.size,this.lastModified=e.lastModified,this.originalSize=void 0===e.originalSize?e.size:e.originalSize}slice(e,t){return new u({path:this.#e,lastModified:this.lastModified,originalSize:this.originalSize,size:t-e,start:this.#t+e})}async *stream(){let{mtimeMs:e,size:t}=await o(this.#e);if(e>this.lastModified||this.originalSize!==t)throw new i.nodeDomexception("The requested file could not be read, typically due to permission problems that have occurred after a reference to a file was acquired.","NotReadableError");yield*n.createReadStream(this.#e,{start:this.#t,end:this.#t+this.size-1})}get[Symbol.toStringTag](){return"Blob"}}let c=globalThis.fetch||i.fetch,h=globalThis.Blob||i._Blob,d=globalThis.File||i.File,f=globalThis.FormData||i.FormData,p=globalThis.Headers||i.Headers,m=globalThis.Request||i.Request,y=globalThis.Response||i.Response,g=globalThis.AbortController||i.AbortController;t.AbortError=i.AbortError,t.FetchError=i.FetchError,t.isRedirect=i.isRedirect,t.AbortController=g,t.Blob=h,t.File=d,t.FormData=f,t.Headers=p,t.Request=m,t.Response=y,t.blobFrom=(e,t)=>o(e).then(r=>a(r,e,t)),t.blobFromSync=(e,t)=>a(n.statSync(e),e,t),t.default=c,t.fetch=c,t.fileFrom=(e,t)=>o(e).then(r=>l(r,e,t)),t.fileFromSync=(e,t)=>l(n.statSync(e),e,t)},39306:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let i=r(57519),n=r(88849),s=r(22286),o=r(65628),a=r(84492),l=r(72254),u=r(47261),c=r(41041),h=r(87503);r(87561),r(49411);var d,f="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},p={exports:{}};if(!globalThis.ReadableStream)try{let e=r(97742),{emitWarning:t}=e;try{e.emitWarning=()=>{},Object.assign(globalThis,r(72477)),e.emitWarning=t}catch(r){throw e.emitWarning=t,r}}catch(e){Object.assign(globalThis,(d||(d=1,function(e){let t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol:e=>`Symbol(${e})`;function r(){}let i="undefined"!=typeof self?self:void 0!==f?f:void 0;function n(e){return"object"==typeof e&&null!==e||"function"==typeof e}let s=Promise,o=Promise.prototype.then,a=Promise.resolve.bind(s),l=Promise.reject.bind(s);function u(e){return new s(e)}function c(e,t,r){return o.call(e,t,r)}function h(e,t,i){c(c(e,t,i),void 0,r)}function d(e,t){h(e,void 0,t)}function p(e){c(e,void 0,r)}let m=(()=>{let e=i&&i.queueMicrotask;if("function"==typeof e)return e;let t=a(void 0);return e=>c(t,e)})();function y(e,t,r){if("function"!=typeof e)throw TypeError("Argument is not a function");return Function.prototype.apply.call(e,t,r)}function g(e,t,r){try{var i;return i=y(e,t,r),a(i)}catch(e){return l(e)}}class b{constructor(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}get length(){return this._size}push(e){let t=this._back,r=t;16383===t._elements.length&&(r={_elements:[],_next:void 0}),t._elements.push(e),r!==t&&(this._back=r,t._next=r),++this._size}shift(){let e=this._front,t=e,r=this._cursor,i=r+1,n=e._elements,s=n[r];return 16384===i&&(t=e._next,i=0),--this._size,this._cursor=i,e!==t&&(this._front=t),n[r]=void 0,s}forEach(e){let t=this._cursor,r=this._front,i=r._elements;for(;(t!==i.length||void 0!==r._next)&&(t!==i.length||(i=(r=r._next)._elements,t=0,0!==i.length));)e(i[t]),++t}peek(){let e=this._front,t=this._cursor;return e._elements[t]}}function _(e,t){var r;e._ownerReadableStream=t,t._reader=e,"readable"===t._state?A(e):"closed"===t._state?(A(e),E(e)):(r=t._storedError,A(e),k(e,r))}function v(e,t){return tH(e._ownerReadableStream,t)}function w(e){var t,r;"readable"===e._ownerReadableStream._state?k(e,TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):(t=e,r=TypeError("Reader was released and can no longer be used to monitor the stream's closedness"),A(t),k(t,r)),e._ownerReadableStream._reader=void 0,e._ownerReadableStream=void 0}function S(e){return TypeError("Cannot "+e+" a stream using a released reader")}function A(e){e._closedPromise=u((t,r)=>{e._closedPromise_resolve=t,e._closedPromise_reject=r})}function k(e,t){void 0!==e._closedPromise_reject&&(p(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}function E(e){void 0!==e._closedPromise_resolve&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}let x=t("[[AbortSteps]]"),C=t("[[ErrorSteps]]"),P=t("[[CancelSteps]]"),T=t("[[PullSteps]]"),O=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)},B=Math.trunc||function(e){return e<0?Math.ceil(e):Math.floor(e)};function R(e,t){if(void 0!==e&&!("object"==typeof e||"function"==typeof e))throw TypeError(`${t} is not an object.`)}function I(e,t){if("function"!=typeof e)throw TypeError(`${t} is not a function.`)}function N(e,t){if(!("object"==typeof e&&null!==e||"function"==typeof e))throw TypeError(`${t} is not an object.`)}function U(e,t,r){if(void 0===e)throw TypeError(`Parameter ${t} is required in '${r}'.`)}function L(e,t,r){if(void 0===e)throw TypeError(`${t} is required in '${r}'.`)}function j(e){return Number(e)}function K(e,t){var r,i;let n=Number.MAX_SAFE_INTEGER,s=Number(e);if(!O(s=0===(r=s)?0:r))throw TypeError(`${t} is not a finite number`);if((s=0===(i=B(s))?0:i)<0||s>n)throw TypeError(`${t} is outside the accepted range of 0 to ${n}, inclusive`);return O(s)&&0!==s?s:0}function D(e,t){if(!t$(e))throw TypeError(`${t} is not a ReadableStream.`)}function M(e){return new F(e)}function $(e,t){e._reader._readRequests.push(t)}function q(e,t,r){let i=e._reader._readRequests.shift();r?i._closeSteps():i._chunkSteps(t)}function H(e){return e._reader._readRequests.length}function z(e){let t=e._reader;return!!(void 0!==t&&V(t))}class F{constructor(e){if(U(e,1,"ReadableStreamDefaultReader"),D(e,"First parameter"),tq(e))throw TypeError("This stream has already been locked for exclusive reading by another reader");_(this,e),this._readRequests=new b}get closed(){return V(this)?this._closedPromise:l(J("closed"))}cancel(e){return V(this)?void 0===this._ownerReadableStream?l(S("cancel")):v(this,e):l(J("cancel"))}read(){let e,t;if(!V(this))return l(J("read"));if(void 0===this._ownerReadableStream)return l(S("read from"));let r=u((r,i)=>{e=r,t=i});return W(this,{_chunkSteps:t=>e({value:t,done:!1}),_closeSteps:()=>e({value:void 0,done:!0}),_errorSteps:e=>t(e)}),r}releaseLock(){if(!V(this))throw J("releaseLock");if(void 0!==this._ownerReadableStream){if(this._readRequests.length>0)throw TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");w(this)}}}function V(e){return!!(n(e)&&Object.prototype.hasOwnProperty.call(e,"_readRequests"))&&e instanceof F}function W(e,t){let r=e._ownerReadableStream;r._disturbed=!0,"closed"===r._state?t._closeSteps():"errored"===r._state?t._errorSteps(r._storedError):r._readableStreamController[T](t)}function J(e){return TypeError(`ReadableStreamDefaultReader.prototype.${e} can only be used on a ReadableStreamDefaultReader`)}Object.defineProperties(F.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(F.prototype,t.toStringTag,{value:"ReadableStreamDefaultReader",configurable:!0});let G=Object.getPrototypeOf(Object.getPrototypeOf(async function*(){}).prototype);class Y{constructor(e,t){this._ongoingPromise=void 0,this._isFinished=!1,this._reader=e,this._preventCancel=t}next(){let e=()=>this._nextSteps();return this._ongoingPromise=this._ongoingPromise?c(this._ongoingPromise,e,e):e(),this._ongoingPromise}return(e){let t=()=>this._returnSteps(e);return this._ongoingPromise?c(this._ongoingPromise,t,t):t()}_nextSteps(){let e,t;if(this._isFinished)return Promise.resolve({value:void 0,done:!0});let r=this._reader;if(void 0===r._ownerReadableStream)return l(S("iterate"));let i=u((r,i)=>{e=r,t=i});return W(r,{_chunkSteps:t=>{this._ongoingPromise=void 0,m(()=>e({value:t,done:!1}))},_closeSteps:()=>{this._ongoingPromise=void 0,this._isFinished=!0,w(r),e({value:void 0,done:!0})},_errorSteps:e=>{this._ongoingPromise=void 0,this._isFinished=!0,w(r),t(e)}}),i}_returnSteps(e){if(this._isFinished)return Promise.resolve({value:e,done:!0});this._isFinished=!0;let t=this._reader;if(void 0===t._ownerReadableStream)return l(S("finish iterating"));if(!this._preventCancel){let r=v(t,e);return w(t),c(r,()=>({value:e,done:!0}),void 0)}return w(t),a({value:e,done:!0})}}let X={next(){return Q(this)?this._asyncIteratorImpl.next():l(Z("next"))},return(e){return Q(this)?this._asyncIteratorImpl.return(e):l(Z("return"))}};function Q(e){if(!n(e)||!Object.prototype.hasOwnProperty.call(e,"_asyncIteratorImpl"))return!1;try{return e._asyncIteratorImpl instanceof Y}catch(e){return!1}}function Z(e){return TypeError(`ReadableStreamAsyncIterator.${e} can only be used on a ReadableSteamAsyncIterator`)}void 0!==G&&Object.setPrototypeOf(X,G);let ee=Number.isNaN||function(e){return e!=e};function et(e){return e.slice()}function er(e,t,r,i,n){new Uint8Array(e).set(new Uint8Array(r,i,n),t)}function ei(e,t,r){if(e.slice)return e.slice(t,r);let i=r-t,n=new ArrayBuffer(i);return er(n,0,e,t,i),n}function en(e){let t=ei(e.buffer,e.byteOffset,e.byteOffset+e.byteLength);return new Uint8Array(t)}function es(e){let t=e._queue.shift();return e._queueTotalSize-=t.size,e._queueTotalSize<0&&(e._queueTotalSize=0),t.value}function eo(e,t,r){if(!(!("number"!=typeof r||ee(r))&&!(r<0))||r===1/0)throw RangeError("Size must be a finite, non-NaN, non-negative number.");e._queue.push({value:t,size:r}),e._queueTotalSize+=r}function ea(e){e._queue=new b,e._queueTotalSize=0}class el{constructor(){throw TypeError("Illegal constructor")}get view(){if(!eh(this))throw eI("view");return this._view}respond(e){if(!eh(this))throw eI("respond");if(U(e,1,"respond"),e=K(e,"First parameter"),void 0===this._associatedReadableByteStreamController)throw TypeError("This BYOB request has been invalidated");this._view.buffer,eO(this._associatedReadableByteStreamController,e)}respondWithNewView(e){if(!eh(this))throw eI("respondWithNewView");if(U(e,1,"respondWithNewView"),!ArrayBuffer.isView(e))throw TypeError("You can only respond with array buffer views");if(void 0===this._associatedReadableByteStreamController)throw TypeError("This BYOB request has been invalidated");e.buffer,eB(this._associatedReadableByteStreamController,e)}}Object.defineProperties(el.prototype,{respond:{enumerable:!0},respondWithNewView:{enumerable:!0},view:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(el.prototype,t.toStringTag,{value:"ReadableStreamBYOBRequest",configurable:!0});class eu{constructor(){throw TypeError("Illegal constructor")}get byobRequest(){if(!ec(this))throw eN("byobRequest");return eP(this)}get desiredSize(){if(!ec(this))throw eN("desiredSize");return eT(this)}close(){if(!ec(this))throw eN("close");if(this._closeRequested)throw TypeError("The stream has already been closed; do not close it again!");let e=this._controlledReadableByteStream._state;if("readable"!==e)throw TypeError(`The stream (in ${e} state) is not in the readable state and cannot be closed`);eE(this)}enqueue(e){if(!ec(this))throw eN("enqueue");if(U(e,1,"enqueue"),!ArrayBuffer.isView(e))throw TypeError("chunk must be an array buffer view");if(0===e.byteLength)throw TypeError("chunk must have non-zero byteLength");if(0===e.buffer.byteLength)throw TypeError("chunk's buffer must have non-zero byteLength");if(this._closeRequested)throw TypeError("stream is closed or draining");let t=this._controlledReadableByteStream._state;if("readable"!==t)throw TypeError(`The stream (in ${t} state) is not in the readable state and cannot be enqueued to`);ex(this,e)}error(e){if(!ec(this))throw eN("error");eC(this,e)}[P](e){ef(this),ea(this);let t=this._cancelAlgorithm(e);return ek(this),t}[T](e){let t=this._controlledReadableByteStream;if(this._queueTotalSize>0){let t=this._queue.shift();this._queueTotalSize-=t.byteLength,e_(this);let r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);e._chunkSteps(r);return}let r=this._autoAllocateChunkSize;if(void 0!==r){let t;try{t=new ArrayBuffer(r)}catch(t){e._errorSteps(t);return}let i={buffer:t,bufferByteLength:r,byteOffset:0,byteLength:r,bytesFilled:0,elementSize:1,viewConstructor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(i)}$(t,e),ed(this)}}function ec(e){return!!(n(e)&&Object.prototype.hasOwnProperty.call(e,"_controlledReadableByteStream"))&&e instanceof eu}function eh(e){return!!(n(e)&&Object.prototype.hasOwnProperty.call(e,"_associatedReadableByteStreamController"))&&e instanceof el}function ed(e){if(function(e){let t=e._controlledReadableByteStream;return"readable"===t._state&&!e._closeRequested&&!!e._started&&!!(z(t)&&H(t)>0||ej(t)&&eL(t)>0||eT(e)>0)}(e)){if(e._pulling){e._pullAgain=!0;return}e._pulling=!0,h(e._pullAlgorithm(),()=>{e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,ed(e))},t=>{eC(e,t)})}}function ef(e){ev(e),e._pendingPullIntos=new b}function ep(e,t){let r=!1;"closed"===e._state&&(r=!0);let i=em(t);"default"===t.readerType?q(e,i,r):function(e,t,r){let i=e._reader._readIntoRequests.shift();r?i._closeSteps(t):i._chunkSteps(t)}(e,i,r)}function em(e){let t=e.bytesFilled,r=e.elementSize;return new e.viewConstructor(e.buffer,e.byteOffset,t/r)}function ey(e,t,r,i){e._queue.push({buffer:t,byteOffset:r,byteLength:i}),e._queueTotalSize+=i}function eg(e,t){let r=t.elementSize,i=t.bytesFilled-t.bytesFilled%r,n=Math.min(e._queueTotalSize,t.byteLength-t.bytesFilled),s=t.bytesFilled+n,o=s-s%r,a=n,l=!1;o>i&&(a=o-t.bytesFilled,l=!0);let u=e._queue;for(;a>0;){let r=u.peek(),i=Math.min(a,r.byteLength),n=t.byteOffset+t.bytesFilled;er(t.buffer,n,r.buffer,r.byteOffset,i),r.byteLength===i?u.shift():(r.byteOffset+=i,r.byteLength-=i),e._queueTotalSize-=i,eb(e,i,t),a-=i}return l}function eb(e,t,r){r.bytesFilled+=t}function e_(e){0===e._queueTotalSize&&e._closeRequested?(ek(e),tz(e._controlledReadableByteStream)):ed(e)}function ev(e){null!==e._byobRequest&&(e._byobRequest._associatedReadableByteStreamController=void 0,e._byobRequest._view=null,e._byobRequest=null)}function ew(e){for(;e._pendingPullIntos.length>0;){if(0===e._queueTotalSize)return;let t=e._pendingPullIntos.peek();eg(e,t)&&(eA(e),ep(e._controlledReadableByteStream,t))}}function eS(e,t){let r=e._pendingPullIntos.peek();ev(e),"closed"===e._controlledReadableByteStream._state?function(e,t){let r=e._controlledReadableByteStream;if(ej(r))for(;eL(r)>0;)ep(r,eA(e))}(e):function(e,t,r){if(eb(e,t,r),r.bytesFilled<r.elementSize)return;eA(e);let i=r.bytesFilled%r.elementSize;if(i>0){let t=r.byteOffset+r.bytesFilled,n=ei(r.buffer,t-i,t);ey(e,n,0,n.byteLength)}r.bytesFilled-=i,ep(e._controlledReadableByteStream,r),ew(e)}(e,t,r),ed(e)}function eA(e){return e._pendingPullIntos.shift()}function ek(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0}function eE(e){let t=e._controlledReadableByteStream;if(!e._closeRequested&&"readable"===t._state){if(e._queueTotalSize>0){e._closeRequested=!0;return}if(e._pendingPullIntos.length>0&&e._pendingPullIntos.peek().bytesFilled>0){let t=TypeError("Insufficient bytes to fill elements in the given buffer");throw eC(e,t),t}ek(e),tz(t)}}function ex(e,t){let r=e._controlledReadableByteStream;if(e._closeRequested||"readable"!==r._state)return;let i=t.buffer,n=t.byteOffset,s=t.byteLength;if(e._pendingPullIntos.length>0){let t=e._pendingPullIntos.peek();t.buffer,t.buffer=t.buffer}ev(e),z(r)?0===H(r)?ey(e,i,n,s):(e._pendingPullIntos.length>0&&eA(e),q(r,new Uint8Array(i,n,s),!1)):ej(r)?(ey(e,i,n,s),ew(e)):ey(e,i,n,s),ed(e)}function eC(e,t){let r=e._controlledReadableByteStream;"readable"===r._state&&(ef(e),ea(e),ek(e),tF(r,t))}function eP(e){if(null===e._byobRequest&&e._pendingPullIntos.length>0){let t=e._pendingPullIntos.peek(),r=new Uint8Array(t.buffer,t.byteOffset+t.bytesFilled,t.byteLength-t.bytesFilled),i=Object.create(el.prototype);i._associatedReadableByteStreamController=e,i._view=r,e._byobRequest=i}return e._byobRequest}function eT(e){let t=e._controlledReadableByteStream._state;return"errored"===t?null:"closed"===t?0:e._strategyHWM-e._queueTotalSize}function eO(e,t){let r=e._pendingPullIntos.peek();if("closed"===e._controlledReadableByteStream._state){if(0!==t)throw TypeError("bytesWritten must be 0 when calling respond() on a closed stream")}else{if(0===t)throw TypeError("bytesWritten must be greater than 0 when calling respond() on a readable stream");if(r.bytesFilled+t>r.byteLength)throw RangeError("bytesWritten out of range")}r.buffer=r.buffer,eS(e,t)}function eB(e,t){let r=e._pendingPullIntos.peek();if("closed"===e._controlledReadableByteStream._state){if(0!==t.byteLength)throw TypeError("The view's length must be 0 when calling respondWithNewView() on a closed stream")}else if(0===t.byteLength)throw TypeError("The view's length must be greater than 0 when calling respondWithNewView() on a readable stream");if(r.byteOffset+r.bytesFilled!==t.byteOffset)throw RangeError("The region specified by view does not match byobRequest");if(r.bufferByteLength!==t.buffer.byteLength)throw RangeError("The buffer of view has different capacity than byobRequest");if(r.bytesFilled+t.byteLength>r.byteLength)throw RangeError("The region specified by view is larger than byobRequest");let i=t.byteLength;r.buffer=t.buffer,eS(e,i)}function eR(e,t,r,i,n,s,o){t._controlledReadableByteStream=e,t._pullAgain=!1,t._pulling=!1,t._byobRequest=null,t._queue=t._queueTotalSize=void 0,ea(t),t._closeRequested=!1,t._started=!1,t._strategyHWM=s,t._pullAlgorithm=i,t._cancelAlgorithm=n,t._autoAllocateChunkSize=o,t._pendingPullIntos=new b,e._readableStreamController=t,h(a(r()),()=>{t._started=!0,ed(t)},e=>{eC(t,e)})}function eI(e){return TypeError(`ReadableStreamBYOBRequest.prototype.${e} can only be used on a ReadableStreamBYOBRequest`)}function eN(e){return TypeError(`ReadableByteStreamController.prototype.${e} can only be used on a ReadableByteStreamController`)}function eU(e,t){e._reader._readIntoRequests.push(t)}function eL(e){return e._reader._readIntoRequests.length}function ej(e){let t=e._reader;return!!(void 0!==t&&eD(t))}Object.defineProperties(eu.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},byobRequest:{enumerable:!0},desiredSize:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(eu.prototype,t.toStringTag,{value:"ReadableByteStreamController",configurable:!0});class eK{constructor(e){if(U(e,1,"ReadableStreamBYOBReader"),D(e,"First parameter"),tq(e))throw TypeError("This stream has already been locked for exclusive reading by another reader");if(!ec(e._readableStreamController))throw TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");_(this,e),this._readIntoRequests=new b}get closed(){return eD(this)?this._closedPromise:l(e$("closed"))}cancel(e){return eD(this)?void 0===this._ownerReadableStream?l(S("cancel")):v(this,e):l(e$("cancel"))}read(e){let t,r;if(!eD(this))return l(e$("read"));if(!ArrayBuffer.isView(e))return l(TypeError("view must be an array buffer view"));if(0===e.byteLength)return l(TypeError("view must have non-zero byteLength"));if(0===e.buffer.byteLength)return l(TypeError("view's buffer must have non-zero byteLength"));if(e.buffer,void 0===this._ownerReadableStream)return l(S("read from"));let i=u((e,i)=>{t=e,r=i});return eM(this,e,{_chunkSteps:e=>t({value:e,done:!1}),_closeSteps:e=>t({value:e,done:!0}),_errorSteps:e=>r(e)}),i}releaseLock(){if(!eD(this))throw e$("releaseLock");if(void 0!==this._ownerReadableStream){if(this._readIntoRequests.length>0)throw TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");w(this)}}}function eD(e){return!!(n(e)&&Object.prototype.hasOwnProperty.call(e,"_readIntoRequests"))&&e instanceof eK}function eM(e,t,r){let i=e._ownerReadableStream;i._disturbed=!0,"errored"===i._state?r._errorSteps(i._storedError):function(e,t,r){let i=e._controlledReadableByteStream,n=1;t.constructor!==DataView&&(n=t.constructor.BYTES_PER_ELEMENT);let s=t.constructor,o=t.buffer,a={buffer:o,bufferByteLength:o.byteLength,byteOffset:t.byteOffset,byteLength:t.byteLength,bytesFilled:0,elementSize:n,viewConstructor:s,readerType:"byob"};if(e._pendingPullIntos.length>0){e._pendingPullIntos.push(a),eU(i,r);return}if("closed"===i._state){let e=new s(a.buffer,a.byteOffset,0);r._closeSteps(e);return}if(e._queueTotalSize>0){if(eg(e,a)){let t=em(a);e_(e),r._chunkSteps(t);return}if(e._closeRequested){let t=TypeError("Insufficient bytes to fill elements in the given buffer");eC(e,t),r._errorSteps(t);return}}e._pendingPullIntos.push(a),eU(i,r),ed(e)}(i._readableStreamController,t,r)}function e$(e){return TypeError(`ReadableStreamBYOBReader.prototype.${e} can only be used on a ReadableStreamBYOBReader`)}function eq(e,t){let{highWaterMark:r}=e;if(void 0===r)return t;if(ee(r)||r<0)throw RangeError("Invalid highWaterMark");return r}function eH(e){let{size:t}=e;return t||(()=>1)}function ez(e,t){R(e,t);let r=null==e?void 0:e.highWaterMark,i=null==e?void 0:e.size;return{highWaterMark:void 0===r?void 0:j(r),size:void 0===i?void 0:(I(i,`${t} has member 'size' that`),e=>j(i(e)))}}function eF(e,t){if(!eG(e))throw TypeError(`${t} is not a WritableStream.`)}Object.defineProperties(eK.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(eK.prototype,t.toStringTag,{value:"ReadableStreamBYOBReader",configurable:!0});let eV="function"==typeof AbortController;class eW{constructor(e={},t={}){void 0===e?e=null:N(e,"First parameter");let r=ez(t,"Second parameter"),i=function(e,t){R(e,t);let r=null==e?void 0:e.abort,i=null==e?void 0:e.close,n=null==e?void 0:e.start,s=null==e?void 0:e.type,o=null==e?void 0:e.write;return{abort:void 0===r?void 0:(I(r,`${t} has member 'abort' that`),t=>g(r,e,[t])),close:void 0===i?void 0:(I(i,`${t} has member 'close' that`),()=>g(i,e,[])),start:void 0===n?void 0:(I(n,`${t} has member 'start' that`),t=>y(n,e,[t])),write:void 0===o?void 0:(I(o,`${t} has member 'write' that`),(t,r)=>g(o,e,[t,r])),type:s}}(e,"First parameter");if(eJ(this),void 0!==i.type)throw RangeError("Invalid type is specified");let n=eH(r);(function(e,t,r,i){let n=Object.create(tr.prototype),s=()=>void 0,o=()=>a(void 0),l=()=>a(void 0),u=()=>a(void 0);void 0!==t.start&&(s=()=>t.start(n)),void 0!==t.write&&(o=e=>t.write(e,n)),void 0!==t.close&&(l=()=>t.close()),void 0!==t.abort&&(u=e=>t.abort(e)),tn(e,n,s,o,l,u,r,i)})(this,i,eq(r,1),n)}get locked(){if(!eG(this))throw tc("locked");return eY(this)}abort(e){return eG(this)?eY(this)?l(TypeError("Cannot abort a stream that already has a writer")):eX(this,e):l(tc("abort"))}close(){return eG(this)?eY(this)?l(TypeError("Cannot close a stream that already has a writer")):e2(this)?l(TypeError("Cannot close an already-closing stream")):eQ(this):l(tc("close"))}getWriter(){if(!eG(this))throw tc("getWriter");return new e4(this)}}function eJ(e){e._state="writable",e._storedError=void 0,e._writer=void 0,e._writableStreamController=void 0,e._writeRequests=new b,e._inFlightWriteRequest=void 0,e._closeRequest=void 0,e._inFlightCloseRequest=void 0,e._pendingAbortRequest=void 0,e._backpressure=!1}function eG(e){return!!(n(e)&&Object.prototype.hasOwnProperty.call(e,"_writableStreamController"))&&e instanceof eW}function eY(e){return void 0!==e._writer}function eX(e,t){var r;if("closed"===e._state||"errored"===e._state)return a(void 0);e._writableStreamController._abortReason=t,null===(r=e._writableStreamController._abortController)||void 0===r||r.abort();let i=e._state;if("closed"===i||"errored"===i)return a(void 0);if(void 0!==e._pendingAbortRequest)return e._pendingAbortRequest._promise;let n=!1;"erroring"===i&&(n=!0,t=void 0);let s=u((r,i)=>{e._pendingAbortRequest={_promise:void 0,_resolve:r,_reject:i,_reason:t,_wasAlreadyErroring:n}});return e._pendingAbortRequest._promise=s,n||e0(e,t),s}function eQ(e){var t;let r=e._state;if("closed"===r||"errored"===r)return l(TypeError(`The stream (in ${r} state) is not in the writable state and cannot be closed`));let i=u((t,r)=>{e._closeRequest={_resolve:t,_reject:r}}),n=e._writer;return void 0!==n&&e._backpressure&&"writable"===r&&tv(n),eo(t=e._writableStreamController,tt,0),ta(t),i}function eZ(e,t){if("writable"===e._state){e0(e,t);return}e1(e)}function e0(e,t){let r=e._writableStreamController;e._state="erroring",e._storedError=t;let i=e._writer;void 0!==i&&e7(i,t),!(void 0!==e._inFlightWriteRequest||void 0!==e._inFlightCloseRequest)&&r._started&&e1(e)}function e1(e){e._state="errored",e._writableStreamController[C]();let t=e._storedError;if(e._writeRequests.forEach(e=>{e._reject(t)}),e._writeRequests=new b,void 0===e._pendingAbortRequest){e8(e);return}let r=e._pendingAbortRequest;if(e._pendingAbortRequest=void 0,r._wasAlreadyErroring){r._reject(t),e8(e);return}h(e._writableStreamController[x](r._reason),()=>{r._resolve(),e8(e)},t=>{r._reject(t),e8(e)})}function e2(e){return void 0!==e._closeRequest||void 0!==e._inFlightCloseRequest}function e8(e){void 0!==e._closeRequest&&(e._closeRequest._reject(e._storedError),e._closeRequest=void 0);let t=e._writer;void 0!==t&&tm(t,e._storedError)}function e3(e,t){let r=e._writer;void 0!==r&&t!==e._backpressure&&(t?tg(r):tv(r)),e._backpressure=t}Object.defineProperties(eW.prototype,{abort:{enumerable:!0},close:{enumerable:!0},getWriter:{enumerable:!0},locked:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(eW.prototype,t.toStringTag,{value:"WritableStream",configurable:!0});class e4{constructor(e){if(U(e,1,"WritableStreamDefaultWriter"),eF(e,"First parameter"),eY(e))throw TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=e,e._writer=this;let t=e._state;if("writable"===t)!e2(e)&&e._backpressure?tg(this):(tg(this),tv(this)),tp(this);else if("erroring"===t)tb(this,e._storedError),tp(this);else if("closed"===t)tg(this),tv(this),tp(this),ty(this);else{let t=e._storedError;tb(this,t),tp(this),tm(this,t)}}get closed(){return e5(this)?this._closedPromise:l(td("closed"))}get desiredSize(){if(!e5(this))throw td("desiredSize");if(void 0===this._ownerWritableStream)throw tf("desiredSize");return function(e){let t=e._ownerWritableStream,r=t._state;return"errored"===r||"erroring"===r?null:"closed"===r?0:to(t._writableStreamController)}(this)}get ready(){return e5(this)?this._readyPromise:l(td("ready"))}abort(e){return e5(this)?void 0===this._ownerWritableStream?l(tf("abort")):eX(this._ownerWritableStream,e):l(td("abort"))}close(){if(!e5(this))return l(td("close"));let e=this._ownerWritableStream;return void 0===e?l(tf("close")):e2(e)?l(TypeError("Cannot close an already-closing stream")):e6(this)}releaseLock(){if(!e5(this))throw td("releaseLock");void 0!==this._ownerWritableStream&&e9(this)}write(e){return e5(this)?void 0===this._ownerWritableStream?l(tf("write to")):te(this,e):l(td("write"))}}function e5(e){return!!(n(e)&&Object.prototype.hasOwnProperty.call(e,"_ownerWritableStream"))&&e instanceof e4}function e6(e){return eQ(e._ownerWritableStream)}function e7(e,t){"pending"===e._readyPromiseState?t_(e,t):tb(e,t)}function e9(e){var t,r;let i=e._ownerWritableStream,n=TypeError("Writer was released and can no longer be used to monitor the stream's closedness");e7(e,n),"pending"===e._closedPromiseState?tm(e,n):(t=e,r=n,tp(t),tm(t,r)),i._writer=void 0,e._ownerWritableStream=void 0}function te(e,t){let r=e._ownerWritableStream,i=r._writableStreamController,n=function(e,t){try{return e._strategySizeAlgorithm(t)}catch(t){return tl(e,t),1}}(i,t);if(r!==e._ownerWritableStream)return l(tf("write to"));let s=r._state;if("errored"===s)return l(r._storedError);if(e2(r)||"closed"===s)return l(TypeError("The stream is closing or closed and cannot be written to"));if("erroring"===s)return l(r._storedError);let o=u((e,t)=>{r._writeRequests.push({_resolve:e,_reject:t})});return function(e,t,r){try{eo(e,t,r)}catch(t){tl(e,t);return}let i=e._controlledWritableStream;e2(i)||"writable"!==i._state||e3(i,0>=to(e)),ta(e)}(i,t,n),o}Object.defineProperties(e4.prototype,{abort:{enumerable:!0},close:{enumerable:!0},releaseLock:{enumerable:!0},write:{enumerable:!0},closed:{enumerable:!0},desiredSize:{enumerable:!0},ready:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(e4.prototype,t.toStringTag,{value:"WritableStreamDefaultWriter",configurable:!0});let tt={};class tr{constructor(){throw TypeError("Illegal constructor")}get abortReason(){if(!ti(this))throw th("abortReason");return this._abortReason}get signal(){if(!ti(this))throw th("signal");if(void 0===this._abortController)throw TypeError("WritableStreamDefaultController.prototype.signal is not supported");return this._abortController.signal}error(e){if(!ti(this))throw th("error");"writable"===this._controlledWritableStream._state&&tu(this,e)}[x](e){let t=this._abortAlgorithm(e);return ts(this),t}[C](){ea(this)}}function ti(e){return!!(n(e)&&Object.prototype.hasOwnProperty.call(e,"_controlledWritableStream"))&&e instanceof tr}function tn(e,t,r,i,n,s,o,l){t._controlledWritableStream=e,e._writableStreamController=t,t._queue=void 0,t._queueTotalSize=void 0,ea(t),t._abortReason=void 0,t._abortController=function(){if(eV)return new AbortController}(),t._started=!1,t._strategySizeAlgorithm=l,t._strategyHWM=o,t._writeAlgorithm=i,t._closeAlgorithm=n,t._abortAlgorithm=s,e3(e,0>=to(t)),h(a(r()),()=>{t._started=!0,ta(t)},r=>{t._started=!0,eZ(e,r)})}function ts(e){e._writeAlgorithm=void 0,e._closeAlgorithm=void 0,e._abortAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function to(e){return e._strategyHWM-e._queueTotalSize}function ta(e){let t=e._controlledWritableStream;if(!e._started||void 0!==t._inFlightWriteRequest)return;if("erroring"===t._state){e1(t);return}if(0===e._queue.length)return;let r=e._queue.peek().value;r===tt?function(e){let t=e._controlledWritableStream;t._inFlightCloseRequest=t._closeRequest,t._closeRequest=void 0,es(e);let r=e._closeAlgorithm();ts(e),h(r,()=>{!function(e){e._inFlightCloseRequest._resolve(void 0),e._inFlightCloseRequest=void 0,"erroring"===e._state&&(e._storedError=void 0,void 0!==e._pendingAbortRequest&&(e._pendingAbortRequest._resolve(),e._pendingAbortRequest=void 0)),e._state="closed";let t=e._writer;void 0!==t&&ty(t)}(t)},e=>{t._inFlightCloseRequest._reject(e),t._inFlightCloseRequest=void 0,void 0!==t._pendingAbortRequest&&(t._pendingAbortRequest._reject(e),t._pendingAbortRequest=void 0),eZ(t,e)})}(e):function(e,t){let r=e._controlledWritableStream;r._inFlightWriteRequest=r._writeRequests.shift(),h(e._writeAlgorithm(t),()=>{r._inFlightWriteRequest._resolve(void 0),r._inFlightWriteRequest=void 0;let t=r._state;es(e),e2(r)||"writable"!==t||e3(r,0>=to(e)),ta(e)},t=>{"writable"===r._state&&ts(e),r._inFlightWriteRequest._reject(t),r._inFlightWriteRequest=void 0,eZ(r,t)})}(e,r)}function tl(e,t){"writable"===e._controlledWritableStream._state&&tu(e,t)}function tu(e,t){let r=e._controlledWritableStream;ts(e),e0(r,t)}function tc(e){return TypeError(`WritableStream.prototype.${e} can only be used on a WritableStream`)}function th(e){return TypeError(`WritableStreamDefaultController.prototype.${e} can only be used on a WritableStreamDefaultController`)}function td(e){return TypeError(`WritableStreamDefaultWriter.prototype.${e} can only be used on a WritableStreamDefaultWriter`)}function tf(e){return TypeError("Cannot "+e+" a stream using a released writer")}function tp(e){e._closedPromise=u((t,r)=>{e._closedPromise_resolve=t,e._closedPromise_reject=r,e._closedPromiseState="pending"})}function tm(e,t){void 0!==e._closedPromise_reject&&(p(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="rejected")}function ty(e){void 0!==e._closedPromise_resolve&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="resolved")}function tg(e){e._readyPromise=u((t,r)=>{e._readyPromise_resolve=t,e._readyPromise_reject=r}),e._readyPromiseState="pending"}function tb(e,t){tg(e),t_(e,t)}function t_(e,t){void 0!==e._readyPromise_reject&&(p(e._readyPromise),e._readyPromise_reject(t),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="rejected")}function tv(e){void 0!==e._readyPromise_resolve&&(e._readyPromise_resolve(void 0),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="fulfilled")}Object.defineProperties(tr.prototype,{abortReason:{enumerable:!0},signal:{enumerable:!0},error:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(tr.prototype,t.toStringTag,{value:"WritableStreamDefaultController",configurable:!0});let tw="undefined"!=typeof DOMException?DOMException:void 0,tS=!function(e){if(!("function"==typeof e||"object"==typeof e))return!1;try{return new e,!0}catch(e){return!1}}(tw)?function(){let e=function(e,t){this.message=e||"",this.name=t||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)};return e.prototype=Object.create(Error.prototype),Object.defineProperty(e.prototype,"constructor",{value:e,writable:!0,configurable:!0}),e}():tw;function tA(e,t,i,n,s,o){let f=M(e),m=new e4(t);e._disturbed=!0;let y=!1,g=a(void 0);return u((b,_)=>{var v,S;let A;if(void 0!==o){if(A=()=>{let r=new tS("Aborted","AbortError"),i=[];n||i.push(()=>"writable"===t._state?eX(t,r):a(void 0)),s||i.push(()=>"readable"===e._state?tH(e,r):a(void 0)),x(()=>Promise.all(i.map(e=>e())),!0,r)},o.aborted){A();return}o.addEventListener("abort",A)}if(E(e,f._closedPromise,e=>{n?C(!0,e):x(()=>eX(t,e),!0,e)}),E(t,m._closedPromise,t=>{s?C(!0,t):x(()=>tH(e,t),!0,t)}),v=f._closedPromise,S=()=>{i?C():x(()=>(function(e){let t=e._ownerWritableStream,r=t._state;return e2(t)||"closed"===r?a(void 0):"errored"===r?l(t._storedError):e6(e)})(m))},"closed"===e._state?S():h(v,S),e2(t)||"closed"===t._state){let t=TypeError("the destination writable stream closed before all data could be piped to it");s?C(!0,t):x(()=>tH(e,t),!0,t)}function k(){let e=g;return c(g,()=>e!==g?k():void 0)}function E(e,t,r){"errored"===e._state?r(e._storedError):d(t,r)}function x(e,r,i){!y&&((y=!0,"writable"!==t._state||e2(t))?n():h(k(),n));function n(){h(e(),()=>P(r,i),e=>P(!0,e))}}function C(e,r){!y&&((y=!0,"writable"!==t._state||e2(t))?P(e,r):h(k(),()=>P(e,r)))}function P(e,t){e9(m),w(f),void 0!==o&&o.removeEventListener("abort",A),e?_(t):b(void 0)}p(u((e,t)=>{!function i(n){n?e():c(y?a(!0):c(m._readyPromise,()=>u((e,t)=>{W(f,{_chunkSteps:t=>{g=c(te(m,t),void 0,r),e(!1)},_closeSteps:()=>e(!0),_errorSteps:t})})),i,t)}(!1)}))})}class tk{constructor(){throw TypeError("Illegal constructor")}get desiredSize(){if(!tE(this))throw tU("desiredSize");return tR(this)}close(){if(!tE(this))throw tU("close");if(!tI(this))throw TypeError("The stream is not in a state that permits close");tT(this)}enqueue(e){if(!tE(this))throw tU("enqueue");if(!tI(this))throw TypeError("The stream is not in a state that permits enqueue");return tO(this,e)}error(e){if(!tE(this))throw tU("error");tB(this,e)}[P](e){ea(this);let t=this._cancelAlgorithm(e);return tP(this),t}[T](e){let t=this._controlledReadableStream;if(this._queue.length>0){let r=es(this);this._closeRequested&&0===this._queue.length?(tP(this),tz(t)):tx(this),e._chunkSteps(r)}else $(t,e),tx(this)}}function tE(e){return!!(n(e)&&Object.prototype.hasOwnProperty.call(e,"_controlledReadableStream"))&&e instanceof tk}function tx(e){if(tC(e)){if(e._pulling){e._pullAgain=!0;return}e._pulling=!0,h(e._pullAlgorithm(),()=>{e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,tx(e))},t=>{tB(e,t)})}}function tC(e){let t=e._controlledReadableStream;return!!tI(e)&&!!e._started&&!!(tq(t)&&H(t)>0||tR(e)>0)}function tP(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function tT(e){if(!tI(e))return;let t=e._controlledReadableStream;e._closeRequested=!0,0===e._queue.length&&(tP(e),tz(t))}function tO(e,t){if(!tI(e))return;let r=e._controlledReadableStream;if(tq(r)&&H(r)>0)q(r,t,!1);else{let r;try{r=e._strategySizeAlgorithm(t)}catch(t){throw tB(e,t),t}try{eo(e,t,r)}catch(t){throw tB(e,t),t}}tx(e)}function tB(e,t){let r=e._controlledReadableStream;"readable"===r._state&&(ea(e),tP(e),tF(r,t))}function tR(e){let t=e._controlledReadableStream._state;return"errored"===t?null:"closed"===t?0:e._strategyHWM-e._queueTotalSize}function tI(e){let t=e._controlledReadableStream._state;return!e._closeRequested&&"readable"===t}function tN(e,t,r,i,n,s,o){t._controlledReadableStream=e,t._queue=void 0,t._queueTotalSize=void 0,ea(t),t._started=!1,t._closeRequested=!1,t._pullAgain=!1,t._pulling=!1,t._strategySizeAlgorithm=o,t._strategyHWM=s,t._pullAlgorithm=i,t._cancelAlgorithm=n,e._readableStreamController=t,h(a(r()),()=>{t._started=!0,tx(t)},e=>{tB(t,e)})}function tU(e){return TypeError(`ReadableStreamDefaultController.prototype.${e} can only be used on a ReadableStreamDefaultController`)}function tL(e,t){R(e,t);let r=null==e?void 0:e.preventAbort,i=null==e?void 0:e.preventCancel,n=null==e?void 0:e.preventClose,s=null==e?void 0:e.signal;return void 0!==s&&function(e,t){if(!function(e){if("object"!=typeof e||null===e)return!1;try{return"boolean"==typeof e.aborted}catch(e){return!1}}(e))throw TypeError(`${t} is not an AbortSignal.`)}(s,`${t} has member 'signal' that`),{preventAbort:!!r,preventCancel:!!i,preventClose:!!n,signal:s}}Object.defineProperties(tk.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},desiredSize:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(tk.prototype,t.toStringTag,{value:"ReadableStreamDefaultController",configurable:!0});class tj{constructor(e={},t={}){void 0===e?e=null:N(e,"First parameter");let r=ez(t,"Second parameter"),i=function(e,t){R(e,t);let r=null==e?void 0:e.autoAllocateChunkSize,i=null==e?void 0:e.cancel,n=null==e?void 0:e.pull,s=null==e?void 0:e.start,o=null==e?void 0:e.type;return{autoAllocateChunkSize:void 0===r?void 0:K(r,`${t} has member 'autoAllocateChunkSize' that`),cancel:void 0===i?void 0:(I(i,`${t} has member 'cancel' that`),t=>g(i,e,[t])),pull:void 0===n?void 0:(I(n,`${t} has member 'pull' that`),t=>g(n,e,[t])),start:void 0===s?void 0:(I(s,`${t} has member 'start' that`),t=>y(s,e,[t])),type:void 0===o?void 0:function(e,t){if("bytes"!=(e=`${e}`))throw TypeError(`${t} '${e}' is not a valid enumeration value for ReadableStreamType`);return e}(o,`${t} has member 'type' that`)}}(e,"First parameter");if(tM(this),"bytes"===i.type){if(void 0!==r.size)throw RangeError("The strategy for a byte stream cannot have a size function");!function(e,t,r){let i=Object.create(eu.prototype),n=()=>void 0,s=()=>a(void 0),o=()=>a(void 0);void 0!==t.start&&(n=()=>t.start(i)),void 0!==t.pull&&(s=()=>t.pull(i)),void 0!==t.cancel&&(o=e=>t.cancel(e));let l=t.autoAllocateChunkSize;if(0===l)throw TypeError("autoAllocateChunkSize must be greater than 0");eR(e,i,n,s,o,r,l)}(this,i,eq(r,0))}else{let e=eH(r);!function(e,t,r,i){let n=Object.create(tk.prototype),s=()=>void 0,o=()=>a(void 0),l=()=>a(void 0);void 0!==t.start&&(s=()=>t.start(n)),void 0!==t.pull&&(o=()=>t.pull(n)),void 0!==t.cancel&&(l=e=>t.cancel(e)),tN(e,n,s,o,l,r,i)}(this,i,eq(r,1),e)}}get locked(){if(!t$(this))throw tV("locked");return tq(this)}cancel(e){return t$(this)?tq(this)?l(TypeError("Cannot cancel a stream that already has a reader")):tH(this,e):l(tV("cancel"))}getReader(e){if(!t$(this))throw tV("getReader");return void 0===function(e,t){R(e,t);let r=null==e?void 0:e.mode;return{mode:void 0===r?void 0:function(e,t){if("byob"!=(e=`${e}`))throw TypeError(`${t} '${e}' is not a valid enumeration value for ReadableStreamReaderMode`);return e}(r,`${t} has member 'mode' that`)}}(e,"First parameter").mode?M(this):new eK(this)}pipeThrough(e,t={}){if(!t$(this))throw tV("pipeThrough");U(e,1,"pipeThrough");let r=function(e,t){R(e,t);let r=null==e?void 0:e.readable;L(r,"readable","ReadableWritablePair"),D(r,`${t} has member 'readable' that`);let i=null==e?void 0:e.writable;return L(i,"writable","ReadableWritablePair"),eF(i,`${t} has member 'writable' that`),{readable:r,writable:i}}(e,"First parameter"),i=tL(t,"Second parameter");if(tq(this))throw TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(eY(r.writable))throw TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");return p(tA(this,r.writable,i.preventClose,i.preventAbort,i.preventCancel,i.signal)),r.readable}pipeTo(e,t={}){let r;if(!t$(this))return l(tV("pipeTo"));if(void 0===e)return l("Parameter 1 is required in 'pipeTo'.");if(!eG(e))return l(TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));try{r=tL(t,"Second parameter")}catch(e){return l(e)}return tq(this)?l(TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):eY(e)?l(TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):tA(this,e,r.preventClose,r.preventAbort,r.preventCancel,r.signal)}tee(){if(!t$(this))throw tV("tee");let e=ec(this._readableStreamController)?function(e){let t,r,i,n,s,o=M(e),l=!1,c=!1,h=!1,f=!1,p=!1,y=u(e=>{s=e});function g(e){d(e._closedPromise,t=>{e===o&&(eC(i._readableStreamController,t),eC(n._readableStreamController,t),f&&p||s(void 0))})}function b(){eD(o)&&(w(o),g(o=M(e))),W(o,{_chunkSteps:t=>{m(()=>{c=!1,h=!1;let r=t;if(!f&&!p)try{r=en(t)}catch(t){eC(i._readableStreamController,t),eC(n._readableStreamController,t),s(tH(e,t));return}f||ex(i._readableStreamController,t),p||ex(n._readableStreamController,r),l=!1,c?v():h&&S()})},_closeSteps:()=>{l=!1,f||eE(i._readableStreamController),p||eE(n._readableStreamController),i._readableStreamController._pendingPullIntos.length>0&&eO(i._readableStreamController,0),n._readableStreamController._pendingPullIntos.length>0&&eO(n._readableStreamController,0),f&&p||s(void 0)},_errorSteps:()=>{l=!1}})}function _(t,r){V(o)&&(w(o),g(o=new eK(e)));let a=r?n:i,u=r?i:n;eM(o,t,{_chunkSteps:t=>{m(()=>{c=!1,h=!1;let i=r?p:f;if(r?f:p)i||eB(a._readableStreamController,t);else{let r;try{r=en(t)}catch(t){eC(a._readableStreamController,t),eC(u._readableStreamController,t),s(tH(e,t));return}i||eB(a._readableStreamController,t),ex(u._readableStreamController,r)}l=!1,c?v():h&&S()})},_closeSteps:e=>{l=!1;let t=r?p:f,i=r?f:p;t||eE(a._readableStreamController),i||eE(u._readableStreamController),void 0!==e&&(t||eB(a._readableStreamController,e),!i&&u._readableStreamController._pendingPullIntos.length>0&&eO(u._readableStreamController,0)),t&&i||s(void 0)},_errorSteps:()=>{l=!1}})}function v(){if(l)return c=!0,a(void 0);l=!0;let e=eP(i._readableStreamController);return null===e?b():_(e._view,!1),a(void 0)}function S(){if(l)return h=!0,a(void 0);l=!0;let e=eP(n._readableStreamController);return null===e?b():_(e._view,!0),a(void 0)}function A(){}return i=tD(A,v,function(i){if(f=!0,t=i,p){let i=tH(e,et([t,r]));s(i)}return y}),n=tD(A,S,function(i){if(p=!0,r=i,f){let i=tH(e,et([t,r]));s(i)}return y}),g(o),[i,n]}(this):function(e,t){let r,i,n,s,o;let l=M(e),c=!1,h=!1,f=!1,p=!1,y=u(e=>{o=e});function g(){return c?h=!0:(c=!0,W(l,{_chunkSteps:e=>{m(()=>{h=!1,f||tO(n._readableStreamController,e),p||tO(s._readableStreamController,e),c=!1,h&&g()})},_closeSteps:()=>{c=!1,f||tT(n._readableStreamController),p||tT(s._readableStreamController),f&&p||o(void 0)},_errorSteps:()=>{c=!1}})),a(void 0)}function b(){}return n=tK(b,g,function(t){if(f=!0,r=t,p){let t=tH(e,et([r,i]));o(t)}return y}),s=tK(b,g,function(t){if(p=!0,i=t,f){let t=tH(e,et([r,i]));o(t)}return y}),d(l._closedPromise,e=>{tB(n._readableStreamController,e),tB(s._readableStreamController,e),f&&p||o(void 0)}),[n,s]}(this);return et(e)}values(e){if(!t$(this))throw tV("values");return function(e,t){let r=new Y(M(e),t),i=Object.create(X);return i._asyncIteratorImpl=r,i}(this,(R(e,"First parameter"),{preventCancel:!!(null==e?void 0:e.preventCancel)}).preventCancel)}}function tK(e,t,r,i=1,n=()=>1){let s=Object.create(tj.prototype);return tM(s),tN(s,Object.create(tk.prototype),e,t,r,i,n),s}function tD(e,t,r){let i=Object.create(tj.prototype);return tM(i),eR(i,Object.create(eu.prototype),e,t,r,0,void 0),i}function tM(e){e._state="readable",e._reader=void 0,e._storedError=void 0,e._disturbed=!1}function t$(e){return!!(n(e)&&Object.prototype.hasOwnProperty.call(e,"_readableStreamController"))&&e instanceof tj}function tq(e){return void 0!==e._reader}function tH(e,t){if(e._disturbed=!0,"closed"===e._state)return a(void 0);if("errored"===e._state)return l(e._storedError);tz(e);let i=e._reader;return void 0!==i&&eD(i)&&(i._readIntoRequests.forEach(e=>{e._closeSteps(void 0)}),i._readIntoRequests=new b),c(e._readableStreamController[P](t),r,void 0)}function tz(e){e._state="closed";let t=e._reader;void 0!==t&&(E(t),V(t)&&(t._readRequests.forEach(e=>{e._closeSteps()}),t._readRequests=new b))}function tF(e,t){e._state="errored",e._storedError=t;let r=e._reader;void 0!==r&&(k(r,t),V(r)?(r._readRequests.forEach(e=>{e._errorSteps(t)}),r._readRequests=new b):(r._readIntoRequests.forEach(e=>{e._errorSteps(t)}),r._readIntoRequests=new b))}function tV(e){return TypeError(`ReadableStream.prototype.${e} can only be used on a ReadableStream`)}function tW(e,t){R(e,t);let r=null==e?void 0:e.highWaterMark;return L(r,"highWaterMark","QueuingStrategyInit"),{highWaterMark:j(r)}}Object.defineProperties(tj.prototype,{cancel:{enumerable:!0},getReader:{enumerable:!0},pipeThrough:{enumerable:!0},pipeTo:{enumerable:!0},tee:{enumerable:!0},values:{enumerable:!0},locked:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(tj.prototype,t.toStringTag,{value:"ReadableStream",configurable:!0}),"symbol"==typeof t.asyncIterator&&Object.defineProperty(tj.prototype,t.asyncIterator,{value:tj.prototype.values,writable:!0,configurable:!0});let tJ=e=>e.byteLength;try{Object.defineProperty(tJ,"name",{value:"size",configurable:!0})}catch(e){}class tG{constructor(e){U(e,1,"ByteLengthQueuingStrategy"),e=tW(e,"First parameter"),this._byteLengthQueuingStrategyHighWaterMark=e.highWaterMark}get highWaterMark(){if(!tX(this))throw tY("highWaterMark");return this._byteLengthQueuingStrategyHighWaterMark}get size(){if(!tX(this))throw tY("size");return tJ}}function tY(e){return TypeError(`ByteLengthQueuingStrategy.prototype.${e} can only be used on a ByteLengthQueuingStrategy`)}function tX(e){return!!(n(e)&&Object.prototype.hasOwnProperty.call(e,"_byteLengthQueuingStrategyHighWaterMark"))&&e instanceof tG}Object.defineProperties(tG.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(tG.prototype,t.toStringTag,{value:"ByteLengthQueuingStrategy",configurable:!0});let tQ=()=>1;try{Object.defineProperty(tQ,"name",{value:"size",configurable:!0})}catch(e){}class tZ{constructor(e){U(e,1,"CountQueuingStrategy"),e=tW(e,"First parameter"),this._countQueuingStrategyHighWaterMark=e.highWaterMark}get highWaterMark(){if(!t1(this))throw t0("highWaterMark");return this._countQueuingStrategyHighWaterMark}get size(){if(!t1(this))throw t0("size");return tQ}}function t0(e){return TypeError(`CountQueuingStrategy.prototype.${e} can only be used on a CountQueuingStrategy`)}function t1(e){return!!(n(e)&&Object.prototype.hasOwnProperty.call(e,"_countQueuingStrategyHighWaterMark"))&&e instanceof tZ}Object.defineProperties(tZ.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(tZ.prototype,t.toStringTag,{value:"CountQueuingStrategy",configurable:!0});class t2{constructor(e={},t={},r={}){let i;void 0===e&&(e=null);let n=ez(t,"Second parameter"),s=ez(r,"Third parameter"),o=function(e,t){R(e,t);let r=null==e?void 0:e.flush,i=null==e?void 0:e.readableType,n=null==e?void 0:e.start,s=null==e?void 0:e.transform,o=null==e?void 0:e.writableType;return{flush:void 0===r?void 0:(I(r,`${t} has member 'flush' that`),t=>g(r,e,[t])),readableType:i,start:void 0===n?void 0:(I(n,`${t} has member 'start' that`),t=>y(n,e,[t])),transform:void 0===s?void 0:(I(s,`${t} has member 'transform' that`),(t,r)=>g(s,e,[t,r])),writableType:o}}(e,"First parameter");if(void 0!==o.readableType)throw RangeError("Invalid readableType specified");if(void 0!==o.writableType)throw RangeError("Invalid writableType specified");let h=eq(s,0),d=eH(s),f=eq(n,1),p=eH(n);(function(e,t,r,i,n,s){function o(){return t}e._writable=function(e,t,r,i,n=1,s=()=>1){let o=Object.create(eW.prototype);return eJ(o),tn(o,Object.create(tr.prototype),e,t,r,i,n,s),o}(o,function(t){return function(e,t){let r=e._transformStreamController;return e._backpressure?c(e._backpressureChangePromise,()=>{let i=e._writable;if("erroring"===i._state)throw i._storedError;return rt(r,t)},void 0):rt(r,t)}(e,t)},function(){return function(e){let t=e._readable,r=e._transformStreamController,i=r._flushAlgorithm();return t9(r),c(i,()=>{if("errored"===t._state)throw t._storedError;tT(t._readableStreamController)},r=>{throw t3(e,r),t._storedError})}(e)},function(t){return t3(e,t),a(void 0)},r,i),e._readable=tK(o,function(){return t5(e,!1),e._backpressureChangePromise},function(t){return t4(e,t),a(void 0)},n,s),e._backpressure=void 0,e._backpressureChangePromise=void 0,e._backpressureChangePromise_resolve=void 0,t5(e,!0),e._transformStreamController=void 0})(this,u(e=>{i=e}),f,p,h,d),function(e,t){var r,i;let n=Object.create(t6.prototype),s=e=>{try{return re(n,e),a(void 0)}catch(e){return l(e)}},o=()=>a(void 0);void 0!==t.transform&&(s=e=>t.transform(e,n)),void 0!==t.flush&&(o=()=>t.flush(n)),r=s,i=o,n._controlledTransformStream=e,e._transformStreamController=n,n._transformAlgorithm=r,n._flushAlgorithm=i}(this,o),void 0!==o.start?i(o.start(this._transformStreamController)):i(void 0)}get readable(){if(!t8(this))throw ri("readable");return this._readable}get writable(){if(!t8(this))throw ri("writable");return this._writable}}function t8(e){return!!(n(e)&&Object.prototype.hasOwnProperty.call(e,"_transformStreamController"))&&e instanceof t2}function t3(e,t){tB(e._readable._readableStreamController,t),t4(e,t)}function t4(e,t){t9(e._transformStreamController),tl(e._writable._writableStreamController,t),e._backpressure&&t5(e,!1)}function t5(e,t){void 0!==e._backpressureChangePromise&&e._backpressureChangePromise_resolve(),e._backpressureChangePromise=u(t=>{e._backpressureChangePromise_resolve=t}),e._backpressure=t}Object.defineProperties(t2.prototype,{readable:{enumerable:!0},writable:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(t2.prototype,t.toStringTag,{value:"TransformStream",configurable:!0});class t6{constructor(){throw TypeError("Illegal constructor")}get desiredSize(){if(!t7(this))throw rr("desiredSize");return tR(this._controlledTransformStream._readable._readableStreamController)}enqueue(e){if(!t7(this))throw rr("enqueue");re(this,e)}error(e){if(!t7(this))throw rr("error");t3(this._controlledTransformStream,e)}terminate(){if(!t7(this))throw rr("terminate");(function(e){let t=e._controlledTransformStream;tT(t._readable._readableStreamController),t4(t,TypeError("TransformStream terminated"))})(this)}}function t7(e){return!!(n(e)&&Object.prototype.hasOwnProperty.call(e,"_controlledTransformStream"))&&e instanceof t6}function t9(e){e._transformAlgorithm=void 0,e._flushAlgorithm=void 0}function re(e,t){let r=e._controlledTransformStream,i=r._readable._readableStreamController;if(!tI(i))throw TypeError("Readable side is not in a state that permits enqueue");try{tO(i,t)}catch(e){throw t4(r,e),r._readable._storedError}!tC(i)!==r._backpressure&&t5(r,!0)}function rt(e,t){return c(e._transformAlgorithm(t),void 0,t=>{throw t3(e._controlledTransformStream,t),t})}function rr(e){return TypeError(`TransformStreamDefaultController.prototype.${e} can only be used on a TransformStreamDefaultController`)}function ri(e){return TypeError(`TransformStream.prototype.${e} can only be used on a TransformStream`)}Object.defineProperties(t6.prototype,{enqueue:{enumerable:!0},error:{enumerable:!0},terminate:{enumerable:!0},desiredSize:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(t6.prototype,t.toStringTag,{value:"TransformStreamDefaultController",configurable:!0}),e.ByteLengthQueuingStrategy=tG,e.CountQueuingStrategy=tZ,e.ReadableByteStreamController=eu,e.ReadableStream=tj,e.ReadableStreamBYOBReader=eK,e.ReadableStreamBYOBRequest=el,e.ReadableStreamDefaultController=tk,e.ReadableStreamDefaultReader=F,e.TransformStream=t2,e.TransformStreamDefaultController=t6,e.WritableStream=eW,e.WritableStreamDefaultController=tr,e.WritableStreamDefaultWriter=e4,Object.defineProperty(e,"__esModule",{value:!0})}(p.exports)),p.exports))}try{let{Blob:e}=r(14300);e&&!e.prototype.stream&&(e.prototype.stream=function(e){let t=0,r=this;return new ReadableStream({type:"bytes",async pull(e){let i=r.slice(t,Math.min(r.size,t+65536)),n=await i.arrayBuffer();t+=n.byteLength,e.enqueue(new Uint8Array(n)),t===r.size&&e.close()}})})}catch(e){}async function*m(e,t=!0){for(let r of e)if("stream"in r)yield*r.stream();else if(ArrayBuffer.isView(r)){if(t){let e=r.byteOffset,t=r.byteOffset+r.byteLength;for(;e!==t;){let i=Math.min(t-e,65536),n=r.buffer.slice(e,e+i);e+=n.byteLength,yield new Uint8Array(n)}}else yield r}else{let e=0;for(;e!==r.size;){let t=r.slice(e,Math.min(r.size,e+65536)),i=await t.arrayBuffer();e+=i.byteLength,yield new Uint8Array(i)}}}let y=class e{#r;#i;#n;#s;constructor(t=[],r={}){if(this.#r=[],this.#i="",this.#n=0,this.#s="transparent","object"!=typeof t||null===t)throw TypeError("Failed to construct 'Blob': The provided value cannot be converted to a sequence.");if("function"!=typeof t[Symbol.iterator])throw TypeError("Failed to construct 'Blob': The object must have a callable @@iterator property.");if("object"!=typeof r&&"function"!=typeof r)throw TypeError("Failed to construct 'Blob': parameter 2 cannot convert to dictionary.");null===r&&(r={});let i=new TextEncoder;for(let r of t){let t;t=ArrayBuffer.isView(r)?new Uint8Array(r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)):r instanceof ArrayBuffer?new Uint8Array(r.slice(0)):r instanceof e?r:i.encode(`${r}`);let n=ArrayBuffer.isView(t)?t.byteLength:t.size;n&&(this.#n+=n,this.#r.push(t))}this.#s=`${void 0===r.endings?"transparent":r.endings}`;let n=void 0===r.type?"":String(r.type);this.#i=/^[\x20-\x7E]*$/.test(n)?n:""}get size(){return this.#n}get type(){return this.#i}async text(){let e=new TextDecoder,t="";for await(let r of m(this.#r,!1))t+=e.decode(r,{stream:!0});return t+e.decode()}async arrayBuffer(){let e=new Uint8Array(this.size),t=0;for await(let r of m(this.#r,!1))e.set(r,t),t+=r.length;return e.buffer}stream(){let e=m(this.#r,!0);return new globalThis.ReadableStream({type:"bytes",async pull(t){let r=await e.next();r.done?t.close():t.enqueue(r.value)},async cancel(){await e.return()}})}slice(t=0,r=this.size,i=""){let{size:n}=this,s=t<0?Math.max(n+t,0):Math.min(t,n),o=r<0?Math.max(n+r,0):Math.min(r,n),a=Math.max(o-s,0),l=this.#r,u=[],c=0;for(let e of l){if(c>=a)break;let t=ArrayBuffer.isView(e)?e.byteLength:e.size;if(s&&t<=s)s-=t,o-=t;else{let r;ArrayBuffer.isView(e)?c+=(r=e.subarray(s,Math.min(t,o))).byteLength:c+=(r=e.slice(s,Math.min(t,o))).size,o-=t,u.push(r),s=0}}let h=new e([],{type:String(i).toLowerCase()});return h.#n=a,h.#r=u,h}get[Symbol.toStringTag](){return"Blob"}static[Symbol.hasInstance](e){return e&&"object"==typeof e&&"function"==typeof e.constructor&&("function"==typeof e.stream||"function"==typeof e.arrayBuffer)&&/^(Blob|File)$/.test(e[Symbol.toStringTag])}};Object.defineProperties(y.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}});let g=y,b=class extends g{#o;#a;constructor(e,t,r={}){if(arguments.length<2)throw TypeError(`Failed to construct 'File': 2 arguments required, but only ${arguments.length} present.`);super(e,r),this.#o=0,this.#a="",null===r&&(r={});let i=void 0===r.lastModified?Date.now():Number(r.lastModified);Number.isNaN(i)||(this.#o=i),this.#a=String(t)}get name(){return this.#a}get lastModified(){return this.#o}get[Symbol.toStringTag](){return"File"}static[Symbol.hasInstance](e){return!!e&&e instanceof g&&/^(File)$/.test(e[Symbol.toStringTag])}};/*! formdata-polyfill. MIT License. Jimmy Wrting <https://jimmy.warting.se/opensource> */var{toStringTag:_,iterator:v,hasInstance:w}=Symbol,S=Math.random,A="append,set,get,getAll,delete,keys,values,entries,forEach,constructor".split(","),k=(e,t,r)=>(e+="",/^(Blob|File)$/.test(t&&t[_])?[(r=void 0!==r?r+"":"File"==t[_]?t.name:"blob",e),t.name!==r||"blob"==t[_]?new b([t],r,t):t]:[e,t+""]),E=(e,t)=>(t?e:e.replace(/\r?\n|\r/g,"\r\n")).replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22"),x=(e,t,r)=>{if(t.length<r)throw TypeError(`Failed to execute '${e}' on 'FormData': ${r} arguments required, but only ${t.length} present.`)};let C=class{#l;constructor(...e){if(this.#l=[],e.length)throw TypeError("Failed to construct 'FormData': parameter 1 is not of type 'HTMLFormElement'.")}get[_](){return"FormData"}[v](){return this.entries()}static[w](e){return e&&"object"==typeof e&&"FormData"===e[_]&&!A.some(t=>"function"!=typeof e[t])}append(...e){x("append",arguments,2),this.#l.push(k(...e))}delete(e){x("delete",arguments,1),e+="",this.#l=this.#l.filter(([t])=>t!==e)}get(e){x("get",arguments,1),e+="";for(var t=this.#l,r=t.length,i=0;i<r;i++)if(t[i][0]===e)return t[i][1];return null}getAll(e,t){return x("getAll",arguments,1),t=[],e+="",this.#l.forEach(r=>r[0]===e&&t.push(r[1])),t}has(e){return x("has",arguments,1),e+="",this.#l.some(t=>t[0]===e)}forEach(e,t){for(var[r,i]of(x("forEach",arguments,1),this))e.call(t,i,r,this)}set(...e){x("set",arguments,2);var t=[],r=!0;e=k(...e),this.#l.forEach(i=>{i[0]===e[0]?r&&(r=!t.push(e)):t.push(i)}),r&&t.push(e),this.#l=t}*entries(){yield*this.#l}*keys(){for(var[e]of this)yield e}*values(){for(var[,e]of this)yield e}};class P extends Error{constructor(e,t){super(e),Error.captureStackTrace(this,this.constructor),this.type=t}get name(){return this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}}class T extends P{constructor(e,t,r){super(e,t),r&&(this.code=this.errno=r.code,this.erroredSysCall=r.syscall)}}let O=Symbol.toStringTag,B=e=>"object"==typeof e&&"function"==typeof e.append&&"function"==typeof e.delete&&"function"==typeof e.get&&"function"==typeof e.getAll&&"function"==typeof e.has&&"function"==typeof e.set&&"function"==typeof e.sort&&"URLSearchParams"===e[O],R=e=>e&&"object"==typeof e&&"function"==typeof e.arrayBuffer&&"string"==typeof e.type&&"function"==typeof e.stream&&"function"==typeof e.constructor&&/^(Blob|File)$/.test(e[O]),I=e=>"object"==typeof e&&("AbortSignal"===e[O]||"EventTarget"===e[O]),N=(e,t)=>{let r=new URL(t).hostname,i=new URL(e).hostname;return r===i||r.endsWith(`.${i}`)},U=(e,t)=>new URL(t).protocol===new URL(e).protocol,L=u.promisify(a.pipeline),j=Symbol("Body internals");class K{constructor(e,{size:t=0}={}){let r=null;null===e?e=null:B(e)?e=l.Buffer.from(e.toString()):R(e)||l.Buffer.isBuffer(e)||(u.types.isAnyArrayBuffer(e)?e=l.Buffer.from(e):ArrayBuffer.isView(e)?e=l.Buffer.from(e.buffer,e.byteOffset,e.byteLength):e instanceof a||(e instanceof C?r=(e=function(e,t=g){var r=`${S()}${S()}`.replace(/\./g,"").slice(-28).padStart(32,"-"),i=[],n=`--${r}\r
Content-Disposition: form-data; name="`;return e.forEach((e,t)=>"string"==typeof e?i.push(n+E(t)+`"\r
\r
${e.replace(/\r(?!\n)|(?<!\r)\n/g,"\r\n")}\r
`):i.push(n+E(t)+`"; filename="${E(e.name,1)}"\r
Content-Type: ${e.type||"application/octet-stream"}\r
\r
`,e,"\r\n")),i.push(`--${r}--`),new t(i,{type:"multipart/form-data; boundary="+r})}(e)).type.split("=")[1]:e=l.Buffer.from(String(e))));let i=e;l.Buffer.isBuffer(e)?i=a.Readable.from(e):R(e)&&(i=a.Readable.from(e.stream())),this[j]={body:e,stream:i,boundary:r,disturbed:!1,error:null},this.size=t,e instanceof a&&e.on("error",e=>{let t=e instanceof P?e:new T(`Invalid response body while trying to fetch ${this.url}: ${e.message}`,"system",e);this[j].error=t})}get body(){return this[j].stream}get bodyUsed(){return this[j].disturbed}async arrayBuffer(){let{buffer:e,byteOffset:t,byteLength:r}=await D(this);return e.slice(t,t+r)}async formData(){let e=this.headers.get("content-type");if(e.startsWith("application/x-www-form-urlencoded")){let e=new C;for(let[t,r]of new URLSearchParams(await this.text()))e.append(t,r);return e}let{toFormData:t}=await Promise.resolve().then(()=>i._(r(10680)));return t(this.body,e)}async blob(){let e=this.headers&&this.headers.get("content-type")||this[j].body&&this[j].body.type||"";return new g([await this.arrayBuffer()],{type:e})}async json(){return JSON.parse(await this.text())}async text(){let e=await D(this);return new TextDecoder().decode(e)}buffer(){return D(this)}}async function D(e){if(e[j].disturbed)throw TypeError(`body used already for: ${e.url}`);if(e[j].disturbed=!0,e[j].error)throw e[j].error;let{body:t}=e;if(null===t||!(t instanceof a))return l.Buffer.alloc(0);let r=[],i=0;try{for await(let n of t){if(e.size>0&&i+n.length>e.size){let r=new T(`content size at ${e.url} over limit: ${e.size}`,"max-size");throw t.destroy(r),r}i+=n.length,r.push(n)}}catch(t){throw t instanceof P?t:new T(`Invalid response body while trying to fetch ${e.url}: ${t.message}`,"system",t)}if(!0===t.readableEnded||!0===t._readableState.ended)try{if(r.every(e=>"string"==typeof e))return l.Buffer.from(r.join(""));return l.Buffer.concat(r,i)}catch(t){throw new T(`Could not create Buffer from response body for ${e.url}: ${t.message}`,"system",t)}else throw new T(`Premature close of server response while trying to fetch ${e.url}`)}K.prototype.buffer=u.deprecate(K.prototype.buffer,"Please use 'response.arrayBuffer()' instead of 'response.buffer()'","node-fetch#buffer"),Object.defineProperties(K.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0},data:{get:u.deprecate(()=>{},"data doesn't exist, use json(), text(), arrayBuffer(), or body instead","https://github.com/node-fetch/node-fetch/issues/1000 (response)")}});let M=(e,t)=>{let r,i;let{body:n}=e[j];if(e.bodyUsed)throw Error("cannot clone body after it is used");return n instanceof a&&"function"!=typeof n.getBoundary&&(r=new a.PassThrough({highWaterMark:t}),i=new a.PassThrough({highWaterMark:t}),n.pipe(r),n.pipe(i),e[j].stream=r,n=i),n},$=u.deprecate(e=>e.getBoundary(),"form-data doesn't follow the spec and requires special treatment. Use alternative package","https://github.com/node-fetch/node-fetch/issues/1167"),q=(e,t)=>null===e?null:"string"==typeof e?"text/plain;charset=UTF-8":B(e)?"application/x-www-form-urlencoded;charset=UTF-8":R(e)?e.type||null:l.Buffer.isBuffer(e)||u.types.isAnyArrayBuffer(e)||ArrayBuffer.isView(e)?null:e instanceof C?`multipart/form-data; boundary=${t[j].boundary}`:e&&"function"==typeof e.getBoundary?`multipart/form-data;boundary=${$(e)}`:e instanceof a?null:"text/plain;charset=UTF-8",H=e=>{let{body:t}=e[j];return null===t?0:R(t)?t.size:l.Buffer.isBuffer(t)?t.length:t&&"function"==typeof t.getLengthSync&&t.hasKnownLength&&t.hasKnownLength()?t.getLengthSync():null},z=async(e,{body:t})=>{null===t?e.end():await L(t,e)},F="function"==typeof n.validateHeaderName?n.validateHeaderName:e=>{if(!/^[\^`\-\w!#$%&'*+.|~]+$/.test(e)){let t=TypeError(`Header name must be a valid HTTP token [${e}]`);throw Object.defineProperty(t,"code",{value:"ERR_INVALID_HTTP_TOKEN"}),t}},V="function"==typeof n.validateHeaderValue?n.validateHeaderValue:(e,t)=>{if(/[^\t\u0020-\u007E\u0080-\u00FF]/.test(t)){let t=TypeError(`Invalid character in header content ["${e}"]`);throw Object.defineProperty(t,"code",{value:"ERR_INVALID_CHAR"}),t}};class W extends URLSearchParams{constructor(e){let t=[];if(e instanceof W)for(let[r,i]of Object.entries(e.raw()))t.push(...i.map(e=>[r,e]));else if(null==e);else if("object"!=typeof e||u.types.isBoxedPrimitive(e))throw TypeError("Failed to construct 'Headers': The provided value is not of type '(sequence<sequence<ByteString>> or record<ByteString, ByteString>)");else{let r=e[Symbol.iterator];if(null==r)t.push(...Object.entries(e));else{if("function"!=typeof r)throw TypeError("Header pairs must be iterable");t=[...e].map(e=>{if("object"!=typeof e||u.types.isBoxedPrimitive(e))throw TypeError("Each header pair must be an iterable object");return[...e]}).map(e=>{if(2!==e.length)throw TypeError("Each header pair must be a name/value tuple");return[...e]})}}return super(t=t.length>0?t.map(([e,t])=>(F(e),V(e,String(t)),[String(e).toLowerCase(),String(t)])):void 0),new Proxy(this,{get(e,t,r){switch(t){case"append":case"set":return(r,i)=>(F(r),V(r,String(i)),URLSearchParams.prototype[t].call(e,String(r).toLowerCase(),String(i)));case"delete":case"has":case"getAll":return r=>(F(r),URLSearchParams.prototype[t].call(e,String(r).toLowerCase()));case"keys":return()=>(e.sort(),new Set(URLSearchParams.prototype.keys.call(e)).keys());default:return Reflect.get(e,t,r)}}})}get[Symbol.toStringTag](){return this.constructor.name}toString(){return Object.prototype.toString.call(this)}get(e){let t=this.getAll(e);if(0===t.length)return null;let r=t.join(", ");return/^content-encoding$/i.test(e)&&(r=r.toLowerCase()),r}forEach(e,t){for(let r of this.keys())Reflect.apply(e,t,[this.get(r),r,this])}*values(){for(let e of this.keys())yield this.get(e)}*entries(){for(let e of this.keys())yield[e,this.get(e)]}[Symbol.iterator](){return this.entries()}raw(){return[...this.keys()].reduce((e,t)=>(e[t]=this.getAll(t),e),{})}[Symbol.for("nodejs.util.inspect.custom")](){return[...this.keys()].reduce((e,t)=>{let r=this.getAll(t);return"host"===t?e[t]=r[0]:e[t]=r.length>1?r:r[0],e},{})}}Object.defineProperties(W.prototype,["get","entries","forEach","values"].reduce((e,t)=>(e[t]={enumerable:!0},e),{}));let J=new Set([301,302,303,307,308]),G=e=>J.has(e),Y=Symbol("Response internals");class X extends K{constructor(e=null,t={}){super(e,t);let r=null!=t.status?t.status:200,i=new W(t.headers);if(null!==e&&!i.has("Content-Type")){let t=q(e,this);t&&i.append("Content-Type",t)}this[Y]={type:"default",url:t.url,status:r,statusText:t.statusText||"",headers:i,counter:t.counter,highWaterMark:t.highWaterMark}}get type(){return this[Y].type}get url(){return this[Y].url||""}get status(){return this[Y].status}get ok(){return this[Y].status>=200&&this[Y].status<300}get redirected(){return this[Y].counter>0}get statusText(){return this[Y].statusText}get headers(){return this[Y].headers}get highWaterMark(){return this[Y].highWaterMark}clone(){return new X(M(this,this.highWaterMark),{type:this.type,url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected,size:this.size,highWaterMark:this.highWaterMark})}static redirect(e,t=302){if(!G(t))throw RangeError('Failed to execute "redirect" on "response": Invalid status code');return new X(null,{headers:{location:new URL(e).toString()},status:t})}static error(){let e=new X(null,{status:0,statusText:""});return e[Y].type="error",e}static json(e,t={}){let r=JSON.stringify(e);if(void 0===r)throw TypeError("data is not JSON serializable");let i=new W(t&&t.headers);return i.has("content-type")||i.set("content-type","application/json"),new X(r,{...t,headers:i})}get[Symbol.toStringTag](){return"Response"}}Object.defineProperties(X.prototype,{type:{enumerable:!0},url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}});let Q=e=>{if(e.search)return e.search;let t=e.href.length-1,r=e.hash||("#"===e.href[t]?"#":"");return"?"===e.href[t-r.length]?"?":""};function Z(e,t=!1){return null==e?"no-referrer":(e=new URL(e),/^(about|blob|data):$/.test(e.protocol))?"no-referrer":(e.username="",e.password="",e.hash="",t&&(e.pathname="",e.search=""),e)}let ee=new Set(["","no-referrer","no-referrer-when-downgrade","same-origin","origin","strict-origin","origin-when-cross-origin","strict-origin-when-cross-origin","unsafe-url"]);function et(e){return!!(/^about:(blank|srcdoc)$/.test(e)||"data:"===e.protocol||/^(blob|filesystem):$/.test(e.protocol))||function(e){if(/^(http|ws)s:$/.test(e.protocol))return!0;let t=e.host.replace(/(^\[)|(]$)/g,""),r=h.isIP(t);return!!(4===r&&/^127\./.test(t)||6===r&&/^(((0+:){7})|(::(0+:){0,6}))0*1$/.test(t))||!("localhost"===e.host||e.host.endsWith(".localhost"))&&"file:"===e.protocol}(e)}let er=Symbol("Request internals"),ei=e=>"object"==typeof e&&"object"==typeof e[er],en=u.deprecate(()=>{},".data is not a valid RequestInit property, use .body instead","https://github.com/node-fetch/node-fetch/issues/1000 (request)");class es extends K{constructor(e,t={}){let r;if(ei(e)?r=new URL(e.url):(r=new URL(e),e={}),""!==r.username||""!==r.password)throw TypeError(`${r} is an url with embedded credentials.`);let i=t.method||e.method||"GET";if(/^(delete|get|head|options|post|put)$/i.test(i)&&(i=i.toUpperCase()),!ei(t)&&"data"in t&&en(),(null!=t.body||ei(e)&&null!==e.body)&&("GET"===i||"HEAD"===i))throw TypeError("Request with GET/HEAD method cannot have body");let n=t.body?t.body:ei(e)&&null!==e.body?M(e):null;super(n,{size:t.size||e.size||0});let s=new W(t.headers||e.headers||{});if(null!==n&&!s.has("Content-Type")){let e=q(n,this);e&&s.set("Content-Type",e)}let o=ei(e)?e.signal:null;if("signal"in t&&(o=t.signal),null!=o&&!I(o))throw TypeError("Expected signal to be an instanceof AbortSignal or EventTarget");let a=null==t.referrer?e.referrer:t.referrer;if(""===a)a="no-referrer";else if(a){let e=new URL(a);a=/^about:(\/\/)?client$/.test(e)?"client":e}else a=void 0;this[er]={method:i,redirect:t.redirect||e.redirect||"follow",headers:s,parsedURL:r,signal:o,referrer:a},this.follow=void 0===t.follow?void 0===e.follow?20:e.follow:t.follow,this.compress=void 0===t.compress?void 0===e.compress||e.compress:t.compress,this.counter=t.counter||e.counter||0,this.agent=t.agent||e.agent,this.highWaterMark=t.highWaterMark||e.highWaterMark||16384,this.insecureHTTPParser=t.insecureHTTPParser||e.insecureHTTPParser||!1,this.referrerPolicy=t.referrerPolicy||e.referrerPolicy||""}get method(){return this[er].method}get url(){return c.format(this[er].parsedURL)}get headers(){return this[er].headers}get redirect(){return this[er].redirect}get signal(){return this[er].signal}get referrer(){return"no-referrer"===this[er].referrer?"":"client"===this[er].referrer?"about:client":this[er].referrer?this[er].referrer.toString():void 0}get referrerPolicy(){return this[er].referrerPolicy}set referrerPolicy(e){this[er].referrerPolicy=function(e){if(!ee.has(e))throw TypeError(`Invalid referrerPolicy: ${e}`);return e}(e)}clone(){return new es(this)}get[Symbol.toStringTag](){return"Request"}}Object.defineProperties(es.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0},referrer:{enumerable:!0},referrerPolicy:{enumerable:!0}});let eo=e=>{let{parsedURL:t}=e[er],r=new W(e[er].headers);r.has("Accept")||r.set("Accept","*/*");let i=null;if(null===e.body&&/^(post|put)$/i.test(e.method)&&(i="0"),null!==e.body){let t=H(e);"number"!=typeof t||Number.isNaN(t)||(i=String(t))}i&&r.set("Content-Length",i),""===e.referrerPolicy&&(e.referrerPolicy="strict-origin-when-cross-origin"),e.referrer&&"no-referrer"!==e.referrer?e[er].referrer=function(e,{referrerURLCallback:t,referrerOriginCallback:r}={}){if("no-referrer"===e.referrer||""===e.referrerPolicy)return null;let i=e.referrerPolicy;if("about:client"===e.referrer)return"no-referrer";let n=e.referrer,s=Z(n),o=Z(n,!0);s.toString().length>4096&&(s=o),t&&(s=t(s)),r&&(o=r(o));let a=new URL(e.url);switch(i){case"no-referrer":return"no-referrer";case"origin":return o;case"unsafe-url":return s;case"strict-origin":if(et(s)&&!et(a))return"no-referrer";return o.toString();case"strict-origin-when-cross-origin":if(s.origin===a.origin)return s;if(et(s)&&!et(a))return"no-referrer";return o;case"same-origin":if(s.origin===a.origin)return s;return"no-referrer";case"origin-when-cross-origin":if(s.origin===a.origin)return s;return o;case"no-referrer-when-downgrade":if(et(s)&&!et(a))return"no-referrer";return s;default:throw TypeError(`Invalid referrerPolicy: ${i}`)}}(e):e[er].referrer="no-referrer",e[er].referrer instanceof URL&&r.set("Referer",e.referrer),r.has("User-Agent")||r.set("User-Agent","node-fetch"),e.compress&&!r.has("Accept-Encoding")&&r.set("Accept-Encoding","gzip, deflate, br");let{agent:n}=e;"function"==typeof n&&(n=n(t)),r.has("Connection")||n||r.set("Connection","close");let s=Q(t),o={path:t.pathname+s,method:e.method,headers:r[Symbol.for("nodejs.util.inspect.custom")](),insecureHTTPParser:e.insecureHTTPParser,agent:n};return{parsedURL:t,options:o}};class ea extends P{constructor(e,t="aborted"){super(e,t)}}/*! node-domexception. MIT License. Jimmy Wrting <https://jimmy.warting.se/opensource> */if(!globalThis.DOMException)try{let{MessageChannel:e}=r(71267),t=new e().port1,i=new ArrayBuffer;t.postMessage(i,[i,i])}catch(e){"DOMException"===e.constructor.name&&(globalThis.DOMException=e.constructor)}var el=globalThis.DOMException;let eu=new Set(["data:","http:","https:"]);async function ec(e,t){return new Promise((r,i)=>{let u=new es(e,t),{parsedURL:c,options:h}=eo(u);if(!eu.has(c.protocol))throw TypeError(`node-fetch cannot load ${e}. URL scheme "${c.protocol.replace(/:$/,"")}" is not supported.`);if("data:"===c.protocol){let e=function(e){if(!/^data:/i.test(e))throw TypeError('`uri` does not appear to be a Data URI (must begin with "data:")');let t=(e=e.replace(/\r?\n/g,"")).indexOf(",");if(-1===t||t<=4)throw TypeError("malformed data: URI");let r=e.substring(5,t).split(";"),i="",n=!1,s=r[0]||"text/plain",o=s;for(let e=1;e<r.length;e++)"base64"===r[e]?n=!0:(o+=`;${r[e]}`,0===r[e].indexOf("charset=")&&(i=r[e].substring(8)));r[0]||i.length||(o+=";charset=US-ASCII",i="US-ASCII");let a=n?"base64":"ascii",l=unescape(e.substring(t+1)),u=Buffer.from(l,a);return u.type=s,u.typeFull=o,u.charset=i,u}(u.url);r(new X(e,{headers:{"Content-Type":e.typeFull}}));return}let d=("https:"===c.protocol?s:n).request,{signal:f}=u,p=null,m=()=>{let e=new ea("The operation was aborted.");i(e),u.body&&u.body instanceof a.Readable&&u.body.destroy(e),p&&p.body&&p.body.emit("error",e)};if(f&&f.aborted){m();return}let y=()=>{m(),b()},g=d(c.toString(),h);f&&f.addEventListener("abort",y);let b=()=>{g.abort(),f&&f.removeEventListener("abort",y)};g.on("error",e=>{i(new T(`request to ${u.url} failed, reason: ${e.message}`,"system",e)),b()}),function(e,t){let r;let i=l.Buffer.from("0\r\n\r\n"),n=!1,s=!1;e.on("response",e=>{let{headers:t}=e;n="chunked"===t["transfer-encoding"]&&!t["content-length"]}),e.on("socket",o=>{let a=()=>{if(n&&!s){let e=Error("Premature close");e.code="ERR_STREAM_PREMATURE_CLOSE",t(e)}},u=e=>{(s=0===l.Buffer.compare(e.slice(-5),i))||!r||(s=0===l.Buffer.compare(r.slice(-3),i.slice(0,3))&&0===l.Buffer.compare(e.slice(-2),i.slice(3))),r=e};o.prependListener("close",a),o.on("data",u),e.on("close",()=>{o.removeListener("close",a),o.removeListener("data",u)})})}(g,e=>{p&&p.body&&p.body.destroy(e)}),process.version<"v14"&&g.on("socket",e=>{let t;e.prependListener("end",()=>{t=e._eventsCount}),e.prependListener("close",r=>{if(p&&t<e._eventsCount&&!r){let e=Error("Premature close");e.code="ERR_STREAM_PREMATURE_CLOSE",p.body.emit("error",e)}})}),g.on("response",e=>{g.setTimeout(0);let n=function(e=[]){return new W(e.reduce((e,t,r,i)=>(r%2==0&&e.push(i.slice(r,r+2)),e),[]).filter(([e,t])=>{try{return F(e),V(e,String(t)),!0}catch{return!1}}))}(e.rawHeaders);if(G(e.statusCode)){let s=n.get("Location"),o=null;try{o=null===s?null:new URL(s,u.url)}catch{if("manual"!==u.redirect){i(new T(`uri requested responds with an invalid redirect URL: ${s}`,"invalid-redirect")),b();return}}switch(u.redirect){case"error":i(new T(`uri requested responds with a redirect, redirect mode is set to error: ${u.url}`,"no-redirect")),b();return;case"manual":break;case"follow":{if(null===o)break;if(u.counter>=u.follow){i(new T(`maximum redirect reached at: ${u.url}`,"max-redirect")),b();return}let s={headers:new W(u.headers),follow:u.follow,counter:u.counter+1,agent:u.agent,compress:u.compress,method:u.method,body:M(u),signal:u.signal,size:u.size,referrer:u.referrer,referrerPolicy:u.referrerPolicy};if(!N(u.url,o)||!U(u.url,o))for(let e of["authorization","www-authenticate","cookie","cookie2"])s.headers.delete(e);if(303!==e.statusCode&&u.body&&t.body instanceof a.Readable){i(new T("Cannot follow redirect with body being a readable stream","unsupported-redirect")),b();return}(303===e.statusCode||(301===e.statusCode||302===e.statusCode)&&"POST"===u.method)&&(s.method="GET",s.body=void 0,s.headers.delete("content-length"));let l=function(e){let t=(e.get("referrer-policy")||"").split(/[,\s]+/),r="";for(let e of t)e&&ee.has(e)&&(r=e);return r}(n);l&&(s.referrerPolicy=l),r(ec(new es(o,s))),b();return}default:return i(TypeError(`Redirect option '${u.redirect}' is not a valid value of RequestRedirect`))}}f&&e.once("end",()=>{f.removeEventListener("abort",y)});let s=a.pipeline(e,new a.PassThrough,e=>{e&&i(e)});process.version<"v12.10"&&e.on("aborted",y);let l={url:u.url,status:e.statusCode,statusText:e.statusMessage,headers:n,size:u.size,counter:u.counter,highWaterMark:u.highWaterMark},c=n.get("Content-Encoding");if(!u.compress||"HEAD"===u.method||null===c||204===e.statusCode||304===e.statusCode){r(p=new X(s,l));return}let h={flush:o.Z_SYNC_FLUSH,finishFlush:o.Z_SYNC_FLUSH};if("gzip"===c||"x-gzip"===c){r(p=new X(s=a.pipeline(s,o.createGunzip(h),e=>{e&&i(e)}),l));return}if("deflate"===c||"x-deflate"===c){let t=a.pipeline(e,new a.PassThrough,e=>{e&&i(e)});t.once("data",e=>{r(p=new X(s=(15&e[0])==8?a.pipeline(s,o.createInflate(),e=>{e&&i(e)}):a.pipeline(s,o.createInflateRaw(),e=>{e&&i(e)}),l))}),t.once("end",()=>{p||r(p=new X(s,l))});return}if("br"===c){r(p=new X(s=a.pipeline(s,o.createBrotliDecompress(),e=>{e&&i(e)}),l));return}r(p=new X(s,l))}),z(g,u).catch(i)})}/**
 * @author Toru Nagashima <https://github.com/mysticatea>
 * @copyright 2015 Toru Nagashima. All rights reserved.
 * See LICENSE file in root directory for full license.
 */let eh=new WeakMap,ed=new WeakMap;function ef(e){let t=eh.get(e);return console.assert(null!=t,"'this' is expected an Event object, but got",e),t}function ep(e){if(null!=e.passiveListener){"undefined"!=typeof console&&"function"==typeof console.error&&console.error("Unable to preventDefault inside passive event listener invocation.",e.passiveListener);return}e.event.cancelable&&(e.canceled=!0,"function"==typeof e.event.preventDefault&&e.event.preventDefault())}function em(e,t){eh.set(this,{eventTarget:e,event:t,eventPhase:2,currentTarget:e,canceled:!1,stopped:!1,immediateStopped:!1,passiveListener:null,timeStamp:t.timeStamp||Date.now()}),Object.defineProperty(this,"isTrusted",{value:!1,enumerable:!0});let r=Object.keys(t);for(let e=0;e<r.length;++e){let t=r[e];t in this||Object.defineProperty(this,t,ey(t))}}function ey(e){return{get(){return ef(this).event[e]},set(t){ef(this).event[e]=t},configurable:!0,enumerable:!0}}function eg(e,t){ef(e).passiveListener=t}em.prototype={get type(){return ef(this).event.type},get target(){return ef(this).eventTarget},get currentTarget(){return ef(this).currentTarget},composedPath(){let e=ef(this).currentTarget;return null==e?[]:[e]},get NONE(){return 0},get CAPTURING_PHASE(){return 1},get AT_TARGET(){return 2},get BUBBLING_PHASE(){return 3},get eventPhase(){return ef(this).eventPhase},stopPropagation(){let e=ef(this);e.stopped=!0,"function"==typeof e.event.stopPropagation&&e.event.stopPropagation()},stopImmediatePropagation(){let e=ef(this);e.stopped=!0,e.immediateStopped=!0,"function"==typeof e.event.stopImmediatePropagation&&e.event.stopImmediatePropagation()},get bubbles(){return!!ef(this).event.bubbles},get cancelable(){return!!ef(this).event.cancelable},preventDefault(){ep(ef(this))},get defaultPrevented(){return ef(this).canceled},get composed(){return!!ef(this).event.composed},get timeStamp(){return ef(this).timeStamp},get srcElement(){return ef(this).eventTarget},get cancelBubble(){return ef(this).stopped},set cancelBubble(value){if(!value)return;let e=ef(this);e.stopped=!0,"boolean"==typeof e.event.cancelBubble&&(e.event.cancelBubble=!0)},get returnValue(){return!ef(this).canceled},set returnValue(value){value||ep(ef(this))},initEvent(){}},Object.defineProperty(em.prototype,"constructor",{value:em,configurable:!0,writable:!0});let eb=new WeakMap;function e_(e){return null!==e&&"object"==typeof e}function ev(e){let t=eb.get(e);if(null==t)throw TypeError("'this' is expected an EventTarget object, but got another value.");return t}function ew(e,t){Object.defineProperty(e,`on${t}`,{get(){let e=ev(this).get(t);for(;null!=e;){if(3===e.listenerType)return e.listener;e=e.next}return null},set(e){"function"==typeof e||e_(e)||(e=null);let r=ev(this),i=null,n=r.get(t);for(;null!=n;)3===n.listenerType?null!==i?i.next=n.next:null!==n.next?r.set(t,n.next):r.delete(t):i=n,n=n.next;if(null!==e){let n={listener:e,listenerType:3,passive:!1,once:!1,next:null};null===i?r.set(t,n):i.next=n}},configurable:!0,enumerable:!0})}function eS(e){function t(){eA.call(this)}t.prototype=Object.create(eA.prototype,{constructor:{value:t,configurable:!0,writable:!0}});for(let r=0;r<e.length;++r)ew(t.prototype,e[r]);return t}function eA(){if(this instanceof eA){eb.set(this,new Map);return}if(1==arguments.length&&Array.isArray(arguments[0]))return eS(arguments[0]);if(arguments.length>0){let e=Array(arguments.length);for(let t=0;t<arguments.length;++t)e[t]=arguments[t];return eS(e)}throw TypeError("Cannot call a class as a function")}eA.prototype={addEventListener(e,t,r){if(null==t)return;if("function"!=typeof t&&!e_(t))throw TypeError("'listener' should be a function or an object.");let i=ev(this),n=e_(r),s=(n?r.capture:r)?1:2,o={listener:t,listenerType:s,passive:n&&!!r.passive,once:n&&!!r.once,next:null},a=i.get(e);if(void 0===a){i.set(e,o);return}let l=null;for(;null!=a;){if(a.listener===t&&a.listenerType===s)return;l=a,a=a.next}l.next=o},removeEventListener(e,t,r){if(null==t)return;let i=ev(this),n=(e_(r)?r.capture:r)?1:2,s=null,o=i.get(e);for(;null!=o;){if(o.listener===t&&o.listenerType===n){null!==s?s.next=o.next:null!==o.next?i.set(e,o.next):i.delete(e);return}s=o,o=o.next}},dispatchEvent(e){if(null==e||"string"!=typeof e.type)throw TypeError('"event.type" should be a string.');let t=ev(this),r=e.type,i=t.get(r);if(null==i)return!0;let n=new(function e(t){if(null==t||t===Object.prototype)return em;let r=ed.get(t);return null==r&&(r=function(e,t){let r=Object.keys(t);if(0===r.length)return e;function i(t,r){e.call(this,t,r)}i.prototype=Object.create(e.prototype,{constructor:{value:i,configurable:!0,writable:!0}});for(let n=0;n<r.length;++n){let s=r[n];if(!(s in e.prototype)){let e="function"==typeof Object.getOwnPropertyDescriptor(t,s).value;Object.defineProperty(i.prototype,s,e?function(e){return{value(){let t=ef(this).event;return t[e].apply(t,arguments)},configurable:!0,enumerable:!0}}(s):ey(s))}}return i}(e(Object.getPrototypeOf(t)),t),ed.set(t,r)),r}(Object.getPrototypeOf(e)))(this,e),s=null;for(;null!=i;){if(i.once?null!==s?s.next=i.next:null!==i.next?t.set(r,i.next):t.delete(r):s=i,eg(n,i.passive?i.listener:null),"function"==typeof i.listener)try{i.listener.call(this,n)}catch(e){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e)}else 3!==i.listenerType&&"function"==typeof i.listener.handleEvent&&i.listener.handleEvent(n);if(ef(n).immediateStopped)break;i=i.next}return eg(n,null),ef(n).eventPhase=0,ef(n).currentTarget=null,!n.defaultPrevented}},Object.defineProperty(eA.prototype,"constructor",{value:eA,configurable:!0,writable:!0});class ek extends eA{constructor(){throw super(),TypeError("AbortSignal cannot be constructed directly")}get aborted(){let e=eE.get(this);if("boolean"!=typeof e)throw TypeError(`Expected 'this' to be an 'AbortSignal' object, but got ${this===null?"null":typeof this}`);return e}}ew(ek.prototype,"abort");let eE=new WeakMap;Object.defineProperties(ek.prototype,{aborted:{enumerable:!0}}),"function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag&&Object.defineProperty(ek.prototype,Symbol.toStringTag,{configurable:!0,value:"AbortSignal"});class ex{constructor(){eC.set(this,function(){let e=Object.create(ek.prototype);return eA.call(e),eE.set(e,!1),e}())}get signal(){return eP(this)}abort(){var e;e=eP(this),!1===eE.get(e)&&(eE.set(e,!0),e.dispatchEvent({type:"abort"}))}}let eC=new WeakMap;function eP(e){let t=eC.get(e);if(null==t)throw TypeError(`Expected 'this' to be an 'AbortController' object, but got ${null===e?"null":typeof e}`);return t}Object.defineProperties(ex.prototype,{signal:{enumerable:!0},abort:{enumerable:!0}}),"function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag&&Object.defineProperty(ex.prototype,Symbol.toStringTag,{configurable:!0,value:"AbortController"}),t.AbortController=ex,t.AbortError=ea,t.FetchError=T,t.File=b,t.FormData=C,t.Headers=W,t.Request=es,t.Response=X,t._Blob=g,t.fetch=ec,t.isRedirect=G,t.nodeDomexception=el},41434:(e,t,r)=>{let i=r(2218);function n(e,t){return i.fetch(e,t)}for(let e in i)n[e]=i[e];e.exports=n},46783:(e,t,r)=>{function i(e){return e&&e.__esModule?e:{default:e}}r.r(t),r.d(t,{_:()=>i,_interop_require_default:()=>i})},57519:(e,t,r)=>{function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(i=function(e){return e?r:t})(e)}function n(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=i(t);if(r&&r.has(e))return r.get(e);var n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=s?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}r.r(t),r.d(t,{_:()=>n,_interop_require_wildcard:()=>n})},74533:(e,t,r)=>{r.d(t,{gn:()=>n,pi:()=>i});var i=function(){return(i=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function n(e,t,r,i){var n,s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,r,o):n(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[638],()=>r(43937));module.exports=i})();